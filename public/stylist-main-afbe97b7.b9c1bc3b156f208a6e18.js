"use strict";(self.webpackChunkStylistWidget=self.webpackChunkStylistWidget||[]).push([[2806],{4879:function(e,t,n){n.r(t),n.d(t,{USE_LAZY_LOADING:function(){return l},USE_PARALLEL_INIT:function(){return d}});var o=n(74848),r=n(96540),i=n(5338),s=n(58881),a=n(94371),c=n(20453),u=n(16924);const l=!0,d=!1,g=(e,t,n)=>{var o;try{if(e&&"function"===typeof e.getState){return null!==(o=t(e.getState()))&&void 0!==o?o:n}return n}catch(r){return n}},m=()=>{try{if(window.__STYLIST_STORES_INITIALIZING)return(0,c.MC)("global","init","Store initialization already in progress, skipping"),!1;const t=performance.now();(0,c.Ng)("storeInitialization:start",0,{phase:"start"}),window.__STYLIST_STORES_INITIALIZING=!0,(0,c.K0)("__STYLIST_STORES_INITIALIZING",!0,"Setting store initialization flag");try{const e=a.Lo.getState();(0,u.$L)("chatStore",a.Lo),(0,c.MC)("chatStore","init","Chat store successfully initialized",{isOpen:e.isOpen,hasMessages:e.messages.length>0,currentView:e.currentView})}catch(e){(0,c.MC)("chatStore","init","Failed to initialize chat store",{error:e instanceof Error?e.message:String(e)})}try{const e=a.kH.getState();(0,u.$L)("userStore",a.kH),(0,c.MC)("userStore","init","User store successfully initialized",{hasUser:!!e.user})}catch(e){(0,c.MC)("userStore","init","Failed to initialize user store",{error:e instanceof Error?e.message:String(e)})}try{const e=a.W0.getState();(0,u.$L)("recommendationStore",a.W0),(0,c.MC)("recommendationStore","init","Recommendation store successfully initialized",{itemCount:e.recommendedItems.length,outfitCount:e.recommendedOutfits.length})}catch(e){(0,c.MC)("recommendationStore","init","Failed to initialize recommendation store",{error:e instanceof Error?e.message:String(e)})}const n=performance.now()-t;return(0,c.Ng)("storeInitialization:complete",n,{phase:"complete",duration:`${n.toFixed(2)}ms`}),(0,c.MC)("global","init","All stores initialized successfully",{initDuration:`${n.toFixed(2)}ms`}),window.__STYLIST_STORES_INITIALIZED=!0,window.__STYLIST_STORES_INITIALIZING=!1,(0,c.K0)("__STYLIST_STORES_INITIALIZED",!0,"Stores successfully initialized"),(0,c.K0)("__STYLIST_STORES_INITIALIZING",!1,"Cleared store initialization flag"),!0}catch(t){return(0,c.MC)("global","init","Critical error during store initialization",{error:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0}),window.__STYLIST_STORES_INITIALIZING=!1,(0,c.K0)("__STYLIST_STORES_INITIALIZING",!1,"Cleared store initialization flag after error"),!1}};setTimeout((()=>{window.__STYLIST_STORES_INITIALIZED||((0,c.MC)("global","init","Store initialization timeout - forcing completion",{timeoutDuration:"5000ms"}),window.__STYLIST_STORES_INITIALIZED=!0,window.__STYLIST_STORES_INITIALIZING=!1,(0,c.K0)("__STYLIST_STORES_INITIALIZED",!0,"Forced store initialization to complete due to timeout"),(0,c.K0)("__STYLIST_STORES_INITIALIZING",!1,"Cleared store initialization flag after timeout"))}),5e3);function _(){const e=document.createElement("div");return e.id="stylist-widget-container",document.body.appendChild(e),e}(0,c.uy)("index","mount","Main entry point initialized"),m(),function(){const e=performance.now();if((0,c.Ng)("widgetMount:start",0,{phase:"start"}),!0===window.__STYLIST_WIDGET_DOM_MOUNTED)return void(0,c.uy)("index","render","Widget DOM already mounted, skipping render");let t=document.getElementById("stylist-widget-container");t?(0,c.uy)("index","render","Using existing widget container"):((0,c.uy)("index","render","Creating widget container"),t=_()),window.__STYLIST_WIDGET_DOM_MOUNTED=!0,(0,c.K0)("__STYLIST_WIDGET_DOM_MOUNTED",!0,"Setting widget DOM mounted flag");const a=setTimeout((()=>{window.__STYLIST_WIDGET_RENDER_COMPLETE||((0,c.K0)("__STYLIST_WIDGET_DOM_MOUNTED",!1,"Resetting DOM mounted flag after render timeout",{timeoutDuration:"10000ms",elapsedTime:`${((performance.now()-e)/1e3).toFixed(1)}s`}),window.__STYLIST_WIDGET_DOM_MOUNTED=!1)}),1e4);try{const u=(0,i.H)(t);(0,c.uy)("index","render","Created React root for rendering");const l=window.__StylistWidgetConfig||{apiKey:"demo_key",retailerId:"demo_retailer"};(0,c.uy)("index","render","Using widget configuration",{hasConfig:!!window.__StylistWidgetConfig,apiKey:"demo_key"===l.apiKey?"demo_key":"custom_key",retailerId:"demo_retailer"===l.retailerId?"demo_retailer":"custom_retailer"});const{SyncProvider:d}=n(18634);u.render((0,o.jsx)(r.StrictMode,{children:(0,o.jsx)(d,{children:(0,o.jsx)(s.A,Object.assign({},l))})})),window.__STYLIST_WIDGET_RENDER_COMPLETE=!0,clearTimeout(a);const g=performance.now()-e;(0,c.K0)("__STYLIST_WIDGET_RENDER_COMPLETE",!0,"Widget render completed successfully"),(0,c.Ng)("widgetMount:complete",g,{phase:"complete",duration:`${g.toFixed(2)}ms`})}catch(u){(0,c.uy)("index","error","Error mounting Stylist Widget",{error:u instanceof Error?u.message:String(u),stack:u instanceof Error?u.stack:void 0}),window.__STYLIST_WIDGET_RENDER_COMPLETE=!1,clearTimeout(a),(0,c.K0)("__STYLIST_WIDGET_RENDER_COMPLETE",!1,"Widget render failed",{error:u instanceof Error?u.message:String(u)})}}(),t.default=s.A;const S={init:e=>{(0,c.uy)("API","init","StylistWidget API initialization",{hasApiKey:!!(null===e||void 0===e?void 0:e.apiKey),hasRetailerId:!!(null===e||void 0===e?void 0:e.retailerId)}),window.__StylistWidgetConfig=Object.assign(Object.assign({},window.__StylistWidgetConfig),e),(0,c.K0)("__StylistWidgetConfig",!0,"Widget configuration set via API",{hasApiKey:!!(null===e||void 0===e?void 0:e.apiKey),hasRetailerId:!!(null===e||void 0===e?void 0:e.retailerId)}),document.getElementById("stylist-widget-container")||((0,c.uy)("API","init","Creating widget container via API"),_()),(0,c.uy)("API","init","Initializing stores via API");const t=m();return(0,c.uy)("API","init","Store initialization result",{success:t}),{success:!0,message:"Stylist Widget initialized successfully"}},open:()=>{(0,c.uy)("API","action","Open widget requested via API");if(g(a.Lo,(e=>e.isOpen),!1))return(0,c.uy)("API","action","Widget already open, no action needed"),!0;{const e=a.Lo.getState();return e&&"function"===typeof e.toggleOpen?((0,c.uy)("API","action","Opening widget via store action"),e.toggleOpen(),!0):((0,c.uy)("API","error","Failed to open widget - store not available",{error:"Chat store not available or toggleOpen not a function"}),!1)}},close:()=>{(0,c.uy)("API","action","Close widget requested via API");if(g(a.Lo,(e=>e.isOpen),!1)){const e=a.Lo.getState();return e&&"function"===typeof e.toggleOpen?((0,c.uy)("API","action","Closing widget via store action"),e.toggleOpen(),!0):((0,c.uy)("API","error","Failed to close widget - store not available",{error:"Chat store not available or toggleOpen not a function"}),!1)}return(0,c.uy)("API","action","Widget already closed, no action needed"),!0},minimize:()=>{(0,c.uy)("API","action","Minimize widget requested via API");const e=a.Lo.getState();return e&&"function"===typeof e.toggleMinimize?((0,c.uy)("API","action","Minimizing widget via store action"),e.toggleMinimize(),!0):((0,c.uy)("API","error","Failed to minimize widget - store not available",{error:"Chat store not available or toggleMinimize not a function"}),!1)},switchView:e=>{(0,c.uy)("API","action","Switch view requested via API",{view:e});const t=a.Lo.getState();return t&&"function"===typeof t.setCurrentView?((0,c.uy)("API","action",`Switching to ${e} view via store action`),t.setCurrentView(e),!0):((0,c.uy)("API","error","Failed to switch view - store not available",{error:"Chat store not available or setCurrentView not a function",requestedView:e}),!1)},openStyleQuiz:()=>{(0,c.uy)("API","action","Open style quiz requested via API"),window.__StylistShowStyleQuiz=!0,(0,c.K0)("__StylistShowStyleQuiz",!0,"Style quiz flag set via API");const e=a.Lo.getState();return e&&"function"===typeof e.setIsOpen?((0,c.uy)("API","action","Opening widget for style quiz"),e.setIsOpen(!0),!0):((0,c.uy)("API","warning","Style quiz flag set but widget could not be opened",{error:"Chat store not available or setIsOpen not a function"}),!1)},openVirtualTryOn:()=>{(0,c.uy)("API","action","Open virtual try-on requested via API"),window.__StylistShowVirtualTryOn=!0,(0,c.K0)("__StylistShowVirtualTryOn",!0,"Virtual try-on flag set via API");const e=a.Lo.getState();return e&&"function"===typeof e.setIsOpen?((0,c.uy)("API","action","Opening widget for virtual try-on"),e.setIsOpen(!0),!0):((0,c.uy)("API","warning","Virtual try-on flag set but widget could not be opened",{error:"Chat store not available or setIsOpen not a function"}),!1)},__debug:{addMockItems:()=>{(0,c.uy)("API","debug","Adding mock items via debug API");try{const e=a.W0.getState();if(!e||"function"!==typeof e.setRecommendedItems)return(0,c.uy)("API","error","Failed to add mock items - store not initialized"),{success:!1,message:"Recommendation store not initialized"};const t=[{id:"mock1",name:"Stylish Jeans",brand:"DenimCo",category:"Pants",price:79.99,retailerId:"demo",imageUrls:["https://via.placeholder.com/150"],colors:[],sizes:[],url:"#",matchScore:.95,matchReasons:["Based on your style profile"],inStock:!0},{id:"mock2",name:"Casual T-Shirt",brand:"Basics",category:"Tops",price:24.99,retailerId:"demo",imageUrls:["https://via.placeholder.com/150"],colors:[],sizes:[],url:"#",matchScore:.92,matchReasons:["Matches your preferences"],inStock:!0},{id:"mock3",name:"Leather Boots",brand:"Footwear",category:"Shoes",price:129.99,retailerId:"demo",imageUrls:["https://via.placeholder.com/150"],colors:[],sizes:[],url:"#",matchScore:.88,matchReasons:["Complements your style"],inStock:!0}],n={id:"outfit1",name:"Casual Weekend Look",occasion:"Casual",items:t,matchScore:.93,matchReasons:["Perfect for weekends"]};return(0,c.uy)("API","debug","Setting mock items in recommendation store"),e.setRecommendedItems(t),"function"===typeof e.setRecommendedOutfits&&((0,c.uy)("API","debug","Setting mock outfits in recommendation store"),e.setRecommendedOutfits([n])),{success:!0,message:"Mock items and outfit added successfully",data:{itemCount:t.length,outfitCount:1}}}catch(e){return(0,c.uy)("API","error","Error adding mock items",{error:e instanceof Error?e.message:String(e),stack:e instanceof Error?e.stack:void 0}),{success:!1,message:"Error adding mock items",error:e instanceof Error?e.message:String(e)}}},getDiagnostics:()=>"undefined"!==typeof window&&window.__STYLIST_DIAGNOSTICS?((0,c.uy)("API","debug","Getting diagnostics via debug API"),{logs:window.__STYLIST_DIAGNOSTICS.logs||[],flags:{initialized:!!window.__STYLIST_WIDGET_INITIALIZED,mounted:!!window.__STYLIST_WIDGET_DOM_MOUNTED,renderComplete:!!window.__STYLIST_WIDGET_RENDER_COMPLETE,storesInitialized:!!window.__STYLIST_STORES_INITIALIZED,backgroundInitComplete:!!window.__STYLIST_BACKGROUND_INIT_COMPLETE}}):{logs:[],flags:{initialized:!1,mounted:!1,renderComplete:!1,storesInitialized:!1,backgroundInitComplete:!1}},clearDiagnostics:()=>{if((0,c.uy)("API","debug","Clearing diagnostics via debug API"),"undefined"!==typeof window&&window.__STYLIST_DIAGNOSTICS){window.__STYLIST_DIAGNOSTICS.logs=[];try{localStorage.removeItem("__STYLIST_DIAGNOSTICS_LOGS")}catch(e){}return{success:!0,message:"Diagnostics cleared successfully"}}return{success:!1,message:"Diagnostics module not initialized"}}}};window.StylistWidget=S},13841:function(e,t,n){var o=n(96540),r=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};t.A=()=>{const[e,t]=(0,o.useState)({isOnline:navigator.onLine,isSlowConnection:!1,effectiveType:null,lastChecked:Date.now()}),n=(0,o.useCallback)((()=>{if("connection"in navigator){const e=navigator.connection;t((t=>Object.assign(Object.assign({},t),{isSlowConnection:"slow-2g"===e.effectiveType||"2g"===e.effectiveType||!0===e.saveData,effectiveType:e.effectiveType,lastChecked:Date.now()})))}}),[]),i=(0,o.useCallback)((()=>{t((e=>Object.assign(Object.assign({},e),{isOnline:!0,lastChecked:Date.now()}))),n()}),[n]),s=(0,o.useCallback)((()=>{t((e=>Object.assign(Object.assign({},e),{isOnline:!1,lastChecked:Date.now()})))}),[]),a=(0,o.useCallback)((()=>{n()}),[n]);(0,o.useEffect)((()=>{if(n(),window.addEventListener("online",i),window.addEventListener("offline",s),"connection"in navigator){navigator.connection.addEventListener("change",a)}return()=>{if(window.removeEventListener("online",i),window.removeEventListener("offline",s),"connection"in navigator){navigator.connection.removeEventListener("change",a)}}}),[i,s,a,n]);const c=(0,o.useCallback)((()=>r(void 0,void 0,void 0,(function*(){try{const e=new AbortController,n=setTimeout((()=>e.abort()),5e3),o=yield fetch("/api/ping",{method:"HEAD",signal:e.signal});clearTimeout(n);const r=o.ok;return t((e=>Object.assign(Object.assign({},e),{isOnline:r,lastChecked:Date.now()}))),r}catch(e){return t((e=>Object.assign(Object.assign({},e),{isOnline:!1,lastChecked:Date.now()}))),!1}}))),[]);return Object.assign(Object.assign({},e),{checkConnection:c})}},20453:function(e,t,n){n.d(t,{Dk:function(){return g},HJ:function(){return d},K0:function(){return p},MC:function(){return _},Ng:function(){return I},Pk:function(){return S},at:function(){return m},uy:function(){return l}});n(96540);const o="false"!=={NVM_RC_VERSION:"",TERM_PROGRAM:"vscode",CLAUDE_CODE_ENTRYPOINT:"CLI",NODE:"/opt/homebrew/Cellar/node/23.5.0/bin/node",INIT_CWD:"/Users/parkercase/stylist",NVM_CD_FLAGS:"",TERM:"xterm-256color",SHELL:"/bin/bash",HOMEBREW_REPOSITORY:"/opt/homebrew",TMPDIR:"/var/folders/kt/g403r1wd62lc2f9kz5ny50hm0000gn/T/",npm_config_global_prefix:"/opt/homebrew",CONDA_SHLVL:"1",TERM_PROGRAM_VERSION:"1.86.2",CONDA_PROMPT_MODIFIER:"(base) ",GSETTINGS_SCHEMA_DIR_CONDA_BACKUP:"",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"0",npm_config_noproxy:"",npm_config_local_prefix:"/Users/parkercase/stylist",GIT_EDITOR:"true",NVM_DIR:"/Users/parkercase/.nvm",USER:"parkercase",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/opt/homebrew/etc/npmrc",CONDA_EXE:"/opt/anaconda3/bin/conda",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.jngRNEP07e/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x0:0x0",npm_execpath:"/opt/homebrew/lib/node_modules/npm/bin/npm-cli.js",_CE_CONDA:"",PATH:"/Users/parkercase/stylist/node_modules/.bin:/Users/parkercase/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/usr/local/opt/postgresql@14/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/usr/local/opt/postgresql@14/bin:/opt/anaconda3/bin:/opt/anaconda3/condabin",GSETTINGS_SCHEMA_DIR:"/opt/anaconda3/share/glib-2.0/schemas",npm_package_json:"/Users/parkercase/stylist/package.json",_:"/Users/parkercase/stylist/node_modules/.bin/webpack",npm_config_userconfig:"/Users/parkercase/.npmrc",npm_config_init_module:"/Users/parkercase/.npm-init.js",CONDA_PREFIX:"/opt/anaconda3",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/parkercase/stylist",npm_lifecycle_event:"build",EDITOR:"vi",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"delta",npm_package_name:"stylist-widget",LANG:"en_US.UTF-8",npm_config_npm_version:"11.2.0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_config_node_gyp:"/opt/homebrew/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.0",_CE_M:"",XPC_SERVICE_NAME:"0",SHLVL:"4",HOME:"/Users/parkercase",VSCODE_GIT_ASKPASS_MAIN:"/private/var/folders/kt/g403r1wd62lc2f9kz5ny50hm0000gn/T/AppTranslocation/EBA426AD-72E7-4DA9-B360-C84DE39BF279/d/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",HOMEBREW_PREFIX:"/opt/homebrew",npm_config_cache:"/Users/parkercase/.npm",CONDA_PYTHON_EXE:"/opt/anaconda3/bin/python",LOGNAME:"parkercase",npm_lifecycle_script:"webpack --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/kt/g403r1wd62lc2f9kz5ny50hm0000gn/T/vscode-git-21a8511f03.sock",COREPACK_ENABLE_AUTO_PIN:"0",CONDA_DEFAULT_ENV:"base",npm_config_user_agent:"npm/11.2.0 node/v23.5.0 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/private/var/folders/kt/g403r1wd62lc2f9kz5ny50hm0000gn/T/AppTranslocation/EBA426AD-72E7-4DA9-B360-C84DE39BF279/d/Visual Studio Code.app/Contents/Frameworks/Code Helper (Plugin).app/Contents/MacOS/Code Helper (Plugin)",GIT_ASKPASS:"/private/var/folders/kt/g403r1wd62lc2f9kz5ny50hm0000gn/T/AppTranslocation/EBA426AD-72E7-4DA9-B360-C84DE39BF279/d/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",INFOPATH:"/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:",CLAUDECODE:"1",npm_node_execpath:"/opt/homebrew/Cellar/node/23.5.0/bin/node",npm_config_prefix:"/opt/homebrew",COLORTERM:"truecolor"}.LOG_DIAGNOSTICS,r=1e3;var i,s;!function(e){e.COMPONENT_MOUNT="COMPONENT_MOUNT",e.COMPONENT_UNMOUNT="COMPONENT_UNMOUNT",e.COMPONENT_RENDER="COMPONENT_RENDER",e.COMPONENT_ERROR="COMPONENT_ERROR",e.SUSPENSE_FALLBACK="SUSPENSE_FALLBACK",e.SUSPENSE_RESOLVED="SUSPENSE_RESOLVED",e.LAZY_LOAD_START="LAZY_LOAD_START",e.LAZY_LOAD_COMPLETE="LAZY_LOAD_COMPLETE",e.LAZY_LOAD_ERROR="LAZY_LOAD_ERROR",e.HOOK_INIT="HOOK_INIT",e.EFFECT_START="EFFECT_START",e.EFFECT_COMPLETE="EFFECT_COMPLETE",e.EFFECT_CLEANUP="EFFECT_CLEANUP",e.STORE_INIT="STORE_INIT",e.STORE_UPDATE="STORE_UPDATE",e.STORE_SUBSCRIPTION="STORE_SUBSCRIPTION",e.ERROR_BOUNDARY="ERROR_BOUNDARY",e.GLOBAL_FLAG="GLOBAL_FLAG",e.PERFORMANCE_MARK="PERFORMANCE_MARK",e.APPLICATION_ERROR="APPLICATION_ERROR",e.CUSTOM="CUSTOM"}(i||(i={})),function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR",e.CRITICAL="CRITICAL"}(s||(s={}));let a=[];const c="undefined"!==typeof window;if(c){const e={log:console.log,warn:console.warn,error:console.error,info:console.info,debug:console.debug};window.__STYLIST_DIAGNOSTICS={logs:a,enabled:o,originalConsole:e}}const u=(e,t,n={})=>{if(!o)return;const{level:i=s.INFO,component:u,data:l,stack:d}=n,g={timestamp:(new Date).toISOString(),type:e,level:i,message:t,component:u,data:l,stack:d};if(a.push(g),a.length>r&&(a=a.slice(-1e3)),c&&window.__STYLIST_DIAGNOSTICS_LOG_TO_TEMP)try{const e=localStorage.getItem("__STYLIST_DIAGNOSTICS_LOGS")||"[]",t=JSON.parse(e);t.push(g);const n=t.slice(-1e3);localStorage.setItem("__STYLIST_DIAGNOSTICS_LOGS",JSON.stringify(n))}catch(m){}},l=(e,t,n,o)=>{const r={mount:i.COMPONENT_MOUNT,render:i.COMPONENT_RENDER,update:i.COMPONENT_RENDER,unmount:i.COMPONENT_UNMOUNT,error:i.COMPONENT_ERROR,init:i.COMPONENT_MOUNT,action:i.CUSTOM,debug:i.CUSTOM,warning:i.CUSTOM},a={mount:s.INFO,render:s.DEBUG,update:s.DEBUG,unmount:s.INFO,error:s.ERROR,init:s.INFO,action:s.INFO,debug:s.DEBUG,warning:s.WARNING};u(r[t],n,{level:a[t],component:e,data:o})},d=(e,t,n,o)=>{const r="fallback"===t?i.SUSPENSE_FALLBACK:i.SUSPENSE_RESOLVED;u(r,n,{component:e,data:o})},g=(e,t,n,o)=>{const r={start:i.LAZY_LOAD_START,complete:i.LAZY_LOAD_COMPLETE,error:i.LAZY_LOAD_ERROR},a={start:s.INFO,complete:s.INFO,error:s.ERROR};u(r[t],n,{level:a[t],component:e,data:o})},m=(e,t,n,o,r)=>{let s=i.HOOK_INIT;"update"===n?s=i.EFFECT_START:"cleanup"===n&&(s=i.EFFECT_CLEANUP),u(s,o,{component:e,data:Object.assign({hook:t},r)})},_=(e,t,n,o)=>{const r={init:i.STORE_INIT,update:i.STORE_UPDATE,subscribe:i.STORE_SUBSCRIPTION,unsubscribe:i.STORE_SUBSCRIPTION};u(r[t],n,{component:e,data:Object.assign({operation:t},o)})},S=(e,t,n)=>{u(i.ERROR_BOUNDARY,`Error boundary triggered in ${e}`,{level:s.ERROR,component:e,data:{errorMessage:t.message,componentStack:null===n||void 0===n?void 0:n.componentStack},stack:t.stack})},p=(e,t,n,o)=>{u(i.GLOBAL_FLAG,n,{data:Object.assign({flag:e,value:t},o||{})})},I=(e,t,n)=>{u(i.PERFORMANCE_MARK,`Performance: ${e}`,{data:Object.assign({name:e,duration:t},n)})}},23497:function(e,t,n){var o=n(96540),r=n(80634);t.A=(e=!1)=>{const[t,n]=(0,o.useState)((0,r.X3)()),[i,s]=(0,o.useState)((0,r.Cg)()),[a,c]=(0,o.useState)(!1);(0,o.useEffect)((()=>{const e=(0,r.s$)((e=>{n(e),e&&c(!1)}));return()=>{e()}}),[]);const u=(0,o.useCallback)((e=>{(0,r.XR)(e),s(e)}),[]);(0,o.useCallback)((()=>{c(!0)}),[]);return{isOnline:t,isOfflineMode:i,setOfflineMode:u,hasOfflineData:e,isNetworkError:a}}},75498:function(e,t,n){var o=n(96540),r=n(66175),i=n(9055),s=n(31040);t.A=()=>{const e=(0,r.k)(),t=(0,i.A)(),n=(0,s.oy)(),a=(0,o.useCallback)((t=>{if(!e.user)return;const o=new Date,r=`item_${o.getTime()}_${Math.random().toString(36).substring(2,9)}`,i=Object.assign(Object.assign({},t),{id:r,dateAdded:o,favorite:t.favorite||!1,tags:t.tags||[]});e.addToCloset(i),n.addClosetItem(t,e.user.userId)}),[e,n]),c=(0,o.useCallback)((t=>{e.user&&(e.removeFromCloset(t),n.removeClosetItem(t,e.user.userId))}),[e,n]),u=(0,o.useCallback)(((t,o)=>{e.user&&(e.toggleItemFavorite(t,o),n.toggleFavorite(t,o,e.user.userId))}),[e,n]),l=(0,o.useCallback)((t=>{e.user&&(e.updateUser({preferences:Object.assign(Object.assign({},e.user.preferences),t)}),n.updatePreferences(t,e.user.userId))}),[e,n]),d=(0,o.useCallback)((t=>{e.user&&n.submitQuiz(t,e.user.userId)}),[e,n]),g=(0,o.useCallback)((t=>{e.user&&e.addLikedItem(t)}),[e]),m=(0,o.useCallback)((t=>{e.user&&e.addDislikedItem(t)}),[e]),_=(0,o.useCallback)((o=>{e.user&&(t.saveOutfit(o),n.saveOutfit(o,e.user.userId))}),[e,t,n]),S=(0,o.useCallback)((o=>{e.user&&(t.removeSavedOutfit(o),n.removeOutfit(o,e.user.userId))}),[e,t,n]);return(0,o.useEffect)((()=>{e.user&&n.syncNow()}),[e.user,n]),{syncState:n.state,syncNow:n.syncNow,addToCloset:a,removeFromCloset:c,toggleItemFavorite:u,updatePreferences:l,submitStyleQuiz:d,addLikedItem:g,addDislikedItem:m,saveOutfit:_,removeSavedOutfit:S}}},76639:function(e,t,n){n.d(t,{k:function(){return S}});var o=n(96540),r=n(1206),i=n(45639),s=n(41071),a=n(24196),c=n(86846),u=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};var l=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const d=e=>{const[t,n]=(0,o.useState)(!1),[d,g]=(0,o.useState)(0),[m,_]=(0,o.useState)(null),S=(0,r.j)((e=>e.settings)),p=(0,r.j)((e=>e.setUserImage)),I=(0,r.j)((e=>e.updateUserImage)),{removeImageBackground:f}=(e=>{const[t,n]=(0,o.useState)(!1),[s,a]=(0,o.useState)(0),[l,d]=(0,o.useState)(null),g=(0,r.j)((e=>e.settings)),m=(0,r.j)((e=>e.updateUserImage)),[_,S]=(0,o.useState)(null);(0,o.useEffect)((()=>{u(void 0,void 0,void 0,(function*(){try{const e=yield(0,c.CF)();S(e),e&&(0,c.kd)()}catch(l){S(!1)}}))}),[]);const p=(0,o.useCallback)((t=>u(void 0,void 0,void 0,(function*(){try{n(!0),a(10),d(null),m({processingStatus:i.GS.REMOVING_BACKGROUND});let o=g.preferredBackgroundRemovalMethod;o===i._n.TENSORFLOW&&!1===_&&(o=i._n.REMOVE_BG_API),a(25),Date.now();const r=1e4,s={width:800,height:800,quality:"medium"},u=(0,c.hS)(t.url,{method:o,apiKey:g.apiKey,fallbackToTensorflow:o===i._n.REMOVE_BG_API&&!0===_,optimizeOptions:s}),l=new Promise(((e,t)=>{setTimeout((()=>{t(new Error("Background removal timed out"))}),r)})),S=yield Promise.race([u,l]);if(a(90),!S||!S.success||!S.imageUrl){if(S&&S.imageUrl){const e=Object.assign(Object.assign({},t),{url:S.imageUrl,backgroundRemoved:!0,processingStatus:i.GS.COMPLETED,processingWarning:S.error||"Background removal partially succeeded"});return m(e),a(100),e}throw new Error((null===S||void 0===S?void 0:S.error)||"Failed to remove background")}const p=Object.assign(Object.assign({},t),{url:S.imageUrl,backgroundRemoved:!0,processingStatus:i.GS.COMPLETED,bodyMeasurements:S.bodyMeasurements});return m(p),a(100),(null===e||void 0===e?void 0:e.onSuccess)&&e.onSuccess(p),p}catch(l){const o=l instanceof Error?l.message:String(l);d(o);const r=o.toLowerCase().includes("webgl")||o.toLowerCase().includes("shader")||o.toLowerCase().includes("compilation"),s=r?"Your browser may not fully support 3D graphics required for background removal. Using original image instead.":o;if(r){const e=Object.assign(Object.assign({},t),{processingStatus:i.GS.COMPLETED,backgroundRemoved:!1,processingWarning:"WebGL not fully supported. Using original image."});return m(e),e}return m({processingStatus:i.GS.FAILED,processingError:s}),(null===e||void 0===e?void 0:e.onError)&&e.onError(s),Object.assign(Object.assign({},t),{processingStatus:i.GS.FAILED,processingError:s})}finally{n(!1)}}))),[g,_,m,e]);return{removeImageBackground:p,isProcessing:t,progress:s,error:l,tensorflowSupported:_,reset:()=>{d(null),a(0)}}})({onError:e=>_(e)}),E=(0,o.useCallback)((t=>l(void 0,void 0,void 0,(function*(){try{if(n(!0),g(0),_(null),!t.type.startsWith("image/"))throw new Error("File is not an image");const o={id:`img_${Date.now()}`,url:"",file:t,processingStatus:i.GS.UPLOADING};p(o),g(10);const r=yield(0,s.zM)(t);g(20);const c=yield(0,s.vX)(r),u=r;let l=c;const d=(null===e||void 0===e?void 0:e.maxWidth)||1200,m=(null===e||void 0===e?void 0:e.maxHeight)||1600;(c.width>d||c.height>m)&&(g(30),l=(0,a.JJ)(c.width,c.height,void 0,void 0,d,m));const E=Object.assign(Object.assign({},o),{url:u,dimensions:l,originalDimensions:c,processingStatus:i.GS.PROCESSING});p(E),g(40);const O=void 0!==(null===e||void 0===e?void 0:e.autoRemoveBackground)?e.autoRemoveBackground:S.removeBackgroundAutomatically;let T=E;return O?(I({processingStatus:i.GS.REMOVING_BACKGROUND}),T=yield f(E)):(T=Object.assign(Object.assign({},E),{processingStatus:i.GS.COMPLETED}),I(T)),g(100),(null===e||void 0===e?void 0:e.onProcessingComplete)&&e.onProcessingComplete(T),T}catch(m){const t=m instanceof Error?m.message:String(m);return _(t),I({processingStatus:i.GS.FAILED,processingError:t}),null}finally{n(!1)}}))),[e,S.removeBackgroundAutomatically,p,I,f]);return{processImage:E,isProcessing:t,progress:d,error:m,reset:()=>{_(null),g(0)}}};var g=n(57401),m=n(97524),_=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const S=()=>{const{currentOutfit:e,userImage:t,settings:n,isLoading:i,error:a,canvasWidth:c,canvasHeight:u,setCurrentOutfit:l,addGarmentToOutfit:S,removeGarmentFromOutfit:p,updateGarment:I,clearUserImage:f,setLoading:E,setError:O,saveResult:T,openTryOnModal:C,closeTryOnModal:y}=(0,r.j)(),{processImage:w}=d(),[A,R]=(0,o.useState)(null);(0,o.useEffect)((()=>{e||l({id:`outfit_${Date.now()}`,garments:[],createdAt:new Date})}),[e,l]);const v=(0,o.useCallback)((e=>_(void 0,void 0,void 0,(function*(){E(!0),O(null);try{yield w(e)}catch(a){O(a instanceof Error?a.message:String(a))}finally{E(!1)}}))),[w,E,O]),N=(0,o.useCallback)(((t,o)=>_(void 0,void 0,void 0,(function*(){E(!0);try{let r,i;if("string"===typeof t)r=t,i=yield(0,s.vX)(r);else{const e=new FileReader;r=yield new Promise(((n,o)=>{e.onload=()=>n(e.result),e.onerror=o,e.readAsDataURL(t)})),i=yield(0,s.vX)(r)}const a={id:`garment_${Date.now()}_${Math.floor(1e3*Math.random())}`,url:r,type:o,bodyPosition:(0,m.f8)(o),zIndex:(0,m.IM)(o),layerIndex:(null===e||void 0===e?void 0:e.garments.length)||0,dimensions:i,originalDimensions:i,scale:n.defaultGarmentScale[o],offset:n.defaultGarmentOffset[o]};S(a)}catch(a){O(a instanceof Error?a.message:String(a))}finally{E(!1)}}))),[null===e||void 0===e?void 0:e.garments.length,n.defaultGarmentScale,n.defaultGarmentOffset,S,E,O]),h=(0,o.useCallback)((e=>{p(e)}),[p]),b=(0,o.useCallback)(((e,t)=>{I(e,t)}),[I]),L=(0,o.useCallback)((()=>_(void 0,void 0,void 0,(function*(){if(A&&e&&t)try{E(!0);const n=yield(0,g.VK)(A),o={id:`result_${Date.now()}`,outfitId:e.id,userId:"current_user",userImageUrl:t.url,resultImageUrl:n,garmentIds:e.garments.map((e=>e.id)),createdAt:new Date};return T(o),o}catch(a){return O(a instanceof Error?a.message:String(a)),null}finally{E(!1)}}))),[A,e,t,E,O,T]),D=(0,o.useCallback)(((e,t)=>{const n={id:`outfit_${Date.now()}`,garments:[],createdAt:new Date};l(n),e&&t&&N(e,t),C()}),[l,N,C]),P=(0,o.useCallback)((e=>{l(e),C()}),[l,C]);return{currentOutfit:e,userImage:t,isLoading:i,error:a,canvasWidth:c,canvasHeight:u,showGuidelines:n.showGuidelines,canvasRef:A,setCanvasRef:R,uploadUserImage:v,addGarment:N,removeGarment:h,updateGarmentProperties:b,clearUserImage:f,saveTryOnResult:L,startNewTryOn:D,tryOnOutfit:P,closeTryOnModal:y}}},99264:function(e,t,n){n.d(t,{Dp:function(){return s},Im:function(){return a},K7:function(){return c},OT:function(){return u},ap:function(){return l}});var o=n(74848),r=n(96540),i=n(20453);const s=e=>{const t=(0,r.useRef)(!1),n=(0,r.useRef)(0),o=(0,r.useRef)(performance.now());t.current||(o.current=performance.now(),(0,i.uy)(e,"mount",`${e} initial render starting`)),n.current+=1;1===n.current||(0,i.uy)(e,"update",`${e} re-render #${n.current-1}`,{renderCount:n.current}),(0,r.useEffect)((()=>{if(!t.current){const r=performance.now()-o.current;t.current=!0,(0,i.uy)(e,"mount",`${e} mounted`,{renderCount:n.current,mountDuration:`${r.toFixed(2)}ms`})}return()=>{(0,i.uy)(e,"unmount",`${e} unmounted`,{totalRenderCount:n.current})}}),[e])},a=(e,t,n,o)=>{const s=(0,r.useRef)(0);(0,r.useEffect)((()=>{s.current+=1;const r=s.current;(0,i.at)(e,t,"update",`${t} effect triggered in ${e}`,{runCount:r,dependencies:n?`Dependencies array length: ${n.length}`:"No dependencies"});const a=performance.now(),c=o(),u=performance.now()-a;return(0,i.at)(e,t,"update",`${t} effect completed in ${e}`,{runCount:r,duration:`${u.toFixed(2)}ms`,hasCleanup:!!c}),()=>{c&&((0,i.at)(e,t,"cleanup",`${t} effect cleanup in ${e}`,{runCount:r}),c())}}),n)};function c(e,t){return r.lazy((()=>{(0,i.Dk)(t,"start",`${t} lazy loading started`);const n=performance.now();return e().then((e=>{const o=performance.now()-n;return(0,i.Dk)(t,"complete",`${t} lazy loading completed`,{loadTime:`${o.toFixed(2)}ms`}),e})).catch((e=>{throw(0,i.Dk)(t,"error",`${t} lazy loading error: ${e.message}`,{error:e.message,stack:e.stack}),e}))}))}const u=({children:e,fallback:t,componentName:n="unknown"})=>{const s=(0,r.useRef)(!1),a=(0,r.useRef)(!1),c=(0,r.useRef)(`Suspense[${n}]`);return(0,o.jsx)(r.Suspense,Object.assign({fallback:(0,o.jsx)((({children:e})=>((0,r.useEffect)((()=>(s.current||(s.current=!0,(0,i.HJ)(c.current,"fallback",`Suspense fallback shown for ${n}`)),()=>{a.current||(a.current=!0,(0,i.HJ)(c.current,"resolved",`Suspense resolved for ${n}`))})),[]),(0,o.jsx)(o.Fragment,{children:e}))),{children:t})},{children:e}))};class l extends r.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.resetError=()=>{this.setState({hasError:!1,error:null})}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){const{componentName:n="unknown",onError:o}=this.props;(0,i.Pk)(n,e,t),o&&o(e,t)}render(){const{hasError:e,error:t}=this.state,{children:n,fallback:o,componentName:r="unknown"}=this.props;return e&&t?"function"===typeof o?o(t,this.resetError):o:n}}}}]);
//# sourceMappingURL=stylist-main-afbe97b7.b9c1bc3b156f208a6e18.js.map