(self.webpackChunkStylistWidget=self.webpackChunkStylistWidget||[]).push([[7446],{4530:function(){},8108:function(){},18590:function(){},22592:function(e,t,i){"use strict";i.d(t,{zA:function(){return u}});var r=i(71636),n=i(15799),o=i(72491),s=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function a(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class a{constructor(e){this.apiClient=e}syncFeedback(e){return s(this,void 0,void 0,(function*(){try{return yield this.apiClient.post(`/api/v1/users/${e.userId}/feedback/sync`,{feedbackItems:e.feedbackItems})}catch(t){return{syncedItemIds:[],success:!1,message:t instanceof Error?t.message:"Unknown error"}}}))}}var l=i(33994);const c=l.H$,d=l.dL,u=e=>{const t=(0,r.t)({baseURL:e.apiUrl||c,apiKey:e.apiKey,timeout:e.timeout||d,headers:{"X-Retailer-ID":e.retailerId}});return{user:new n.i(t),recommendation:new o.Q(t),feedback:new a(t)}},I=(0,r.t)();new n.i(I),new o.Q(I),new a(I)},30769:function(e,t,i){"use strict";i.d(t,{O:function(){return s},y:function(){return a}});var r=i(72505),n=i.n(r),o=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function a(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class s{constructor(e){this.maxRetries=e.maxRetries||3,this.getAuthHeader=e.getAuthHeader;const t={baseURL:e.baseURL,timeout:e.timeout||15e3},i={"Content-Type":"application/json",Accept:"application/json"};e.apiKey&&(i["X-API-Key"]=e.apiKey),e.headers&&Object.assign(i,e.headers),this.client=n().create(Object.assign(Object.assign({},t),{headers:i})),this.client.interceptors.request.use((e=>{const t=Object.assign({},e);return t.headers&&"X-API-Key"in t.headers&&(t.headers=Object.assign(Object.assign({},t.headers),{"X-API-Key":"[REDACTED]"})),e}),(e=>Promise.reject(e))),this.client.interceptors.response.use((e=>e),(e=>Promise.reject(e)))}get(e,t){return o(this,void 0,void 0,(function*(){return this.requestWithRetry("get",e,void 0,t)}))}post(e,t,i){return o(this,void 0,void 0,(function*(){return this.requestWithRetry("post",e,t,i)}))}put(e,t,i){return o(this,void 0,void 0,(function*(){return this.requestWithRetry("put",e,t,i)}))}delete(e,t){return o(this,void 0,void 0,(function*(){return this.requestWithRetry("delete",e,void 0,t)}))}requestWithRetry(e,t,i,r){return o(this,void 0,void 0,(function*(){let n=0,o=null,s=Object.assign({},r);for(this.getAuthHeader&&(s.headers=Object.assign(Object.assign({},s.headers),this.getAuthHeader()));n<=this.maxRetries;)try{let r;switch(e){case"get":r=yield this.client.get(t,s);break;case"post":r=yield this.client.post(t,i,s);break;case"put":r=yield this.client.put(t,i,s);break;case"delete":r=yield this.client.delete(t,s)}return r.data}catch(a){if(o=a,!(this.isRetryableError(a)&&n<this.maxRetries))break;{n++;const e=1e3*Math.pow(2,n);yield new Promise((t=>setTimeout(t,e)))}}throw this.handleError(o),o}))}isRetryableError(e){return!e.response||e.response&&e.response.status>=500}handleError(e){if(e.response){const t=e.response.status;if(401===t)throw new Error("Unauthorized: Please check your API key or log in again");if(403===t)throw new Error("Forbidden: You do not have permission to access this resource");if(404===t)throw new Error("Resource not found");if(t>=500)throw new Error("Server error, please try again later");{const t=e.response.data||{};throw new Error(`API Error: ${t.message||e.message}`)}}throw e.request?new Error("No response received from server. Please check your connection"):new Error(`Request setup error: ${e.message}`)}}const a=e=>new s(e)},41234:function(){},58881:function(e,t,i){"use strict";var r=i(74848),n=i(96540),o=i(74740),s=i(85224),a=i(86864),l=i(63154),c=i(94371),d=i(18634),u=i(50849),I=i(80634),h=i(19034),p=i(4879),g=i(20453),S=i(99264),y=i(84183),T=i(60325);(0,g.uy)("StylistWidget","render","Module load started"),"undefined"!==typeof window&&(window.__STYLIST_WIDGET_INITIALIZED=window.__STYLIST_WIDGET_INITIALIZED||!1,window.__STYLIST_STORES_AVAILABLE=window.__STYLIST_STORES_AVAILABLE||!1);const f=(0,S.K7)((()=>Promise.resolve().then(i.bind(i,60325)).then((e=>e)).catch((e=>({default:T.default})))),"ChatWidget"),m=((0,S.K7)((()=>Promise.resolve().then(i.bind(i,54826))),"VirtualTryOn"),(0,S.K7)((()=>Promise.resolve().then(i.bind(i,68037))),"StyleQuiz"),(0,S.K7)((()=>i.e(3497).then(i.bind(i,57154))),"SocialProof"),(0,S.K7)((()=>Promise.resolve().then(i.bind(i,40209))),"Lookbook"),e=>{var t,i;(0,S.Dp)("StylistWidget");const[m,_]=(0,n.useState)(!1),[w,A]=(0,n.useState)(!1),L=(0,c.Lo)();(0,g.uy)("StylistWidget","render","StylistWidget rendering with store status: "+(L?"available":"unavailable"),{storesReady:m,initAttempted:w});const b=null!==(t=null===L||void 0===L?void 0:L.isOpen)&&void 0!==t&&t,E=null!==(i=null===L||void 0===L?void 0:L.toggleOpen)&&void 0!==i?i:()=>{},v=(0,n.useRef)(!1);(0,n.useEffect)((()=>{if(e.enableOfflineMode)return I.FB.initOfflineService(),()=>{I.FB.cleanupOfflineService()}}),[e.enableOfflineMode]),(0,S.Im)("StylistWidget","storeInitialization",[L,w],(()=>{w||(A(!0),(0,g.K0)("STYLIST_INIT_ATTEMPTED",!0,"First initialization attempt marked"),(0,g.K0)("STYLIST_STORES_READY",!0,"Stores marked as ready immediately"),_(!0),L?(0,g.K0)("STYLIST_STORES_AVAILABLE",!0,"Store is actually available"):(0,g.K0)("STYLIST_STORES_AVAILABLE",!1,"Store will be available soon"))})),(0,S.Im)("StylistWidget","secondaryStoreCheck",[L,m],(()=>{L&&!window.__STYLIST_STORES_AVAILABLE&&((0,g.K0)("STYLIST_STORES_AVAILABLE",!0,"Store became available"),window.__STYLIST_STORES_AVAILABLE=!0)})),(0,S.Im)("StylistWidget","mainInitialization",[],(()=>{if(!window.__STYLIST_WIDGET_INITIALIZED)return v.current=!0,window.__STYLIST_WIDGET_INITIALIZED=!0,(0,g.K0)("__STYLIST_WIDGET_INITIALIZED",!0,"Widget marked as initialized"),p.USE_PARALLEL_INIT?((0,g.K0)("USE_PARALLEL_INIT",!0,"Using parallel initialization strategy"),u.m.initialize({apiKey:e.apiKey,retailerId:e.retailerId,apiUrl:e.apiUrl})):((0,g.K0)("USE_PARALLEL_INIT",!1,"Using optimized initialization with delayed services"),window.__STYLIST_PENDING_INITIALIZATIONS=Object.assign(Object.assign({},window.__STYLIST_PENDING_INITIALIZATIONS||{}),{feedbackSync:{apiKey:e.apiKey,retailerId:e.retailerId,apiUrl:e.apiUrl}}),(0,g.K0)("__STYLIST_PENDING_INITIALIZATIONS",!0,"Pending initializations registered",{services:["feedbackSync"]})),()=>{u.m.cleanup()};(0,g.K0)("__STYLIST_WIDGET_INITIALIZED",!0,"Widget already initialized, skipping")})),(0,S.Im)("StylistWidget","themeColors",[e.primaryColor],(()=>{e.primaryColor&&(document.documentElement.style.setProperty("--stylist-primary-color",e.primaryColor),document.documentElement.style.setProperty("--stylist-primary-color-light",O(e.primaryColor,.2)),document.documentElement.style.setProperty("--stylist-primary-color-dark",N(e.primaryColor,.2)))}));const O=(e,i)=>{try{e=e.replace("#","");const t=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16),o=Math.min(255,Math.floor(t+(255-t)*i)),s=Math.min(255,Math.floor(r+(255-r)*i)),a=Math.min(255,Math.floor(n+(255-n)*i));return`#${o.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`}catch(t){return e}},N=(e,i)=>{try{e=e.replace("#","");const t=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16),o=Math.max(0,Math.floor(t*(1-i))),s=Math.max(0,Math.floor(r*(1-i))),a=Math.max(0,Math.floor(n*(1-i)));return`#${o.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`}catch(t){return e}},j=p.USE_LAZY_LOADING?f:T.default,k=(0,r.jsx)(S.ap,Object.assign({componentName:"StylistWidget",fallback:(0,r.jsxs)("div",Object.assign({className:"stylist-error-container",style:{padding:"1rem",textAlign:"center",color:"#721c24",backgroundColor:"#f8d7da",borderRadius:"4px",margin:"1rem"}},{children:[(0,r.jsx)("h3",{children:"Widget Error"}),(0,r.jsx)("p",{children:"The widget encountered an error during loading."}),(0,r.jsx)("button",Object.assign({onClick:()=>window.location.reload(),style:{marginTop:"1rem",padding:"0.5rem 1rem",backgroundColor:"var(--stylist-primary-color, #4361ee)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},{children:"Reload"}))]}))},{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.Suspense,Object.assign({fallback:(0,r.jsxs)("div",Object.assign({className:"stylist-loading-container",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem",height:"100%"}},{children:[(0,r.jsx)("div",{className:"stylist-loading-spinner"}),(0,r.jsx)("p",Object.assign({style:{marginTop:"1rem"}},{children:"Loading Stylist Widget..."}))]}))},{children:(0,n.createElement)(j,Object.assign({},e,{key:"stylist-chat-widget-singleton",onFirstPaint:()=>{var e;if(!p.USE_PARALLEL_INIT&&window.__STYLIST_PENDING_INITIALIZATIONS){if(null===(e=window.__STYLIST_PENDING_INITIALIZATIONS)||void 0===e?void 0:e.feedbackSync)try{u.m.initialize(window.__STYLIST_PENDING_INITIALIZATIONS.feedbackSync)}catch(t){}window.__STYLIST_BACKGROUND_INIT_COMPLETE=!0}},showDemoToggle:e.showDemoToggle}))})),m&&(0,r.jsx)(y.A,{onClick:()=>{L&&"function"===typeof L.toggleOpen&&E()},primaryColor:e.primaryColor,isOpen:b,logoUrl:e.apiKey?`/logos/${e.retailerId}-logo.png`:void 0}),(0,r.jsx)(o.A,{}),e.showDebugToggle&&(0,r.jsx)(h.A,{}),e.showMockDataToggle&&(0,r.jsx)(l.A,{}),e.showOfflineIndicator&&e.enableOfflineMode&&(0,r.jsx)(s.A,{position:"top",showControls:!0,hasOfflineData:!0}),e.demoMode&&(0,r.jsx)(a.A,{flowId:e.demoFlow,position:"right",showControls:!0})]})}));return p.USE_PARALLEL_INIT?(0,r.jsx)(d.SyncProvider,{children:k}):k});m.defaultProps={showDebugToggle:!1,showMockDataToggle:!0,showDemoToggle:!1,showOfflineIndicator:!1,enableOfflineMode:!1,demoMode:!1},t.A=m},80551:function(){},85817:function(){}}]);
//# sourceMappingURL=stylist-main-43dd7041.8d37d7be6444221f4deb.js.map