{"version":3,"file":"stylist-main-d91a9049.58e6920444b1a827c502.js","mappings":"qJACA,IAAIA,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,GAAS,CAAE,MAAOG,GAAKL,EAAOK,EAAI,CAAE,CAC1F,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAiB,MAAEK,GAAS,CAAE,MAAOG,GAAKL,EAAOK,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAeL,EAIaK,EAAOC,KAAOT,EAAQQ,EAAOL,QAJ1CA,EAIyDK,EAAOL,MAJhDA,aAAiBN,EAAIM,EAAQ,IAAIN,GAAE,SAAUG,GAAWA,EAAQG,EAAQ,KAIjBO,KAAKR,EAAWK,EAAW,CAC7GH,GAAMN,EAAYA,EAAUa,MAAMhB,EAASC,GAAc,KAAKS,OAClE,GACJ,EACO,MAAMO,EACT,WAAAC,CAAYC,GACRC,KAAKC,OAASF,CAClB,CAEA,cAAAG,CAAeC,GACX,OAAOxB,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOG,IAAI,iBAAiBD,IAC5C,GACJ,CAEA,UAAAE,CAAWC,GACP,OAAO3B,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOM,KAAK,gBAAiB,CAAED,SAC/C,GACJ,CAEA,iBAAAE,CAAkBL,EAAQM,GACtB,OAAO9B,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOS,IAAI,iBAAiBP,gBAAsBM,EAClE,GACJ,CAEA,YAAAE,GACI,OAAOhC,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOG,IAAI,qBAC3B,GACJ,CAEA,eAAAQ,CAAgBT,EAAQU,GACpB,OAAOlC,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOM,KAAK,iBAAiBJ,eAAqB,CAAEU,WACpE,GACJ,CAEA,aAAAC,CAAcX,EAAQY,GAClB,OAAOpC,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOM,KAAK,iBAAiBJ,WAAiBY,EAC9D,GACJ,CAEA,gBAAAC,CAAiBb,EAAQc,GACrB,OAAOtC,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOiB,OAAO,iBAAiBf,YAAiBc,IAChE,GACJ,CAEA,gBAAAE,CAAiBhB,EAAQc,EAAQG,GAC7B,OAAOzC,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOS,IAAI,iBAAiBP,YAAiBc,IAAUG,EACvE,GACJ,CAEA,kBAAAC,CAAmBlB,EAAQc,EAAQK,GAC/B,OAAO3C,EAAUqB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKC,OAAOS,IAAI,iBAAiBP,YAAiBc,aAAmB,CAAEK,YAClF,GACJ,E,6FC9DJ,MAAMC,EACS,CAAEC,IAAK,GAAKC,IAAK,EAAKC,MAAO,iBADtCH,EAEI,CAAEC,IAAK,GAAKC,IAAK,GAAKC,MAAO,iBAFjCH,EAGI,CAAEC,IAAK,GAAKC,IAAK,GAAKC,MAAO,cAHjCH,EAII,CAAEC,IAAK,EAAKC,IAAK,GAAKC,MAAO,eAoTvC,IC5TA,EDU0B,EAAGC,SAAQC,UAASC,eAAcC,qBAAoBC,cAAaC,iBAAgBC,mBACzG,MAAOC,EAAeC,IAAoB,IAAAC,UAAS,IAOnD,IALA,IAAAC,YAAU,KACFV,GACAQ,EAAiB,GACrB,GACD,CAACR,EAAQE,KACPF,EACD,OAAO,KAEX,MAAMW,GAA6B,IAAAC,UAAQ,IAChCT,EAAmBU,KAAIzB,IAC1B,MAAM0B,EA6Cd,SAAoCC,EAAUC,GAC1C,MAAMC,EAAU,GAEVC,EAoDV,SAA+BC,EAAOC,GAElC,IAAKD,EAAME,SAAWD,EAAMC,SACvBF,EAAME,OAAOC,SAAWF,EAAMC,OAAOC,OACtC,MAAO,GAGX,MAAMC,EAAUJ,EAAME,OAAOR,KAAIW,GAAKA,EAAEC,gBAClCC,EAAUN,EAAMC,OAAOR,KAAIW,GAAKA,EAAEC,gBAElCE,EAAgB,CAAC,QAAS,QAAS,OAAQ,OAAQ,QAAS,MAAO,QAAS,QAAS,UACrFC,EAAa,CAAC,MAAO,SAAU,SAAU,OAAQ,QAAS,QAAS,OAAQ,QAAS,SAAU,YAC9FC,EAAa,CAAC,OAAQ,QAAS,SAAU,SAAU,OAAQ,YAAa,OAAQ,OAAQ,YAExFC,EAAqB,CACvB,CAAC,OAAQ,UAAW,CAAC,SAAU,UAAW,CAAC,QAAS,OACpD,CAAC,OAAQ,SAAU,CAAC,OAAQ,SAIhC,GADqBP,EAAQQ,QAAOP,GAAKE,EAAQM,SAASR,KAAIF,OAC3C,EACf,MAAO,GAGX,MAAMW,EAAcV,EAAQW,MAAKV,GAAKG,EAAcK,SAASR,KACvDW,EAAcT,EAAQQ,MAAKV,GAAKG,EAAcK,SAASR,KAC7D,GAAIS,GAAeE,EACf,MAAO,GAGX,IAAK,MAAMC,KAAUb,EACjB,IAAK,MAAMc,KAAUX,EACjB,IAAK,MAAOY,EAAIC,KAAOT,EACnB,GAAKM,EAAOJ,SAASM,IAAOD,EAAOL,SAASO,IACvCH,EAAOJ,SAASO,IAAOF,EAAOL,SAASM,GACxC,MAAO,IAMvB,MAAME,EAAUjB,EAAQW,MAAKV,GAAKI,EAAWM,MAAKO,GAAMjB,EAAEQ,SAASS,OAC7DC,EAAUhB,EAAQQ,MAAKV,GAAKI,EAAWM,MAAKO,GAAMjB,EAAEQ,SAASS,OAC7DE,EAAUpB,EAAQW,MAAKV,GAAKK,EAAWK,MAAKU,GAAMpB,EAAEQ,SAASY,OAC7DC,EAAUnB,EAAQQ,MAAKV,GAAKK,EAAWK,MAAKU,GAAMpB,EAAEQ,SAASY,OACnE,GAAKJ,GAAWE,GAAaC,GAAWE,EACpC,MAAO,IAGX,GAAKL,GAAWK,GAAaF,GAAWD,EACpC,MAAO,GAGX,MAAO,EACX,CA1GyBI,CAAsB/B,EAAUC,GACjDE,EAAe,GACfD,EAAQ8B,KAAK,2BAER7B,EAAe,IACpBD,EAAQ8B,KAAK,2BAGjB,MAAMC,EAsGV,SAAgC7B,EAAOC,GACnC,IAAKD,EAAM8B,WAAa7B,EAAM6B,SAC1B,MAAO,GACX,MAAMC,EAAO/B,EAAM8B,SAASxB,cACtB0B,EAAO/B,EAAM6B,SAASxB,cAEtB2B,EAAa,CACf,CAAC,MAAO,UAAW,CAAC,QAAS,QAAS,CAAC,QAAS,SAChD,CAAC,SAAU,QAAS,CAAC,SAAU,SAAU,CAAC,MAAO,QACjD,CAAC,QAAS,UAAW,CAAC,QAAS,QAAS,CAAC,QAAS,aAClD,CAAC,SAAU,aAAc,CAAC,SAAU,QAAS,CAAC,MAAO,aACrD,CAAC,SAAU,aAAc,CAAC,OAAQ,QAGtC,IAAK,MAAOd,EAAIC,KAAOa,EACnB,GAAKF,EAAKlB,SAASM,IAAOa,EAAKnB,SAASO,IACnCW,EAAKlB,SAASO,IAAOY,EAAKnB,SAASM,GACpC,OAAO,EAIf,MAAMe,EAAW,CAAC,MAAO,QAAS,SAAU,MAAO,UAAW,WACxDC,EAAc,CAAC,SAAU,OAAQ,QAAS,OAAQ,UAAW,UAAW,SACxEC,EAAa,CAAC,QAAS,OAAQ,YAC/BC,EAAa,CAAC,SAAU,OAAQ,SAAU,YAC1CC,EAAiB,CAAC,YAAa,UAAW,QAAS,MAAO,QAC1DC,EAAgB,CAAC,OAAQ,OAAQ,UAAW,OAAQ,UACpDC,EAAW,CAAC,MAAO,UAAW,QAAS,WAAY,QAEnDC,EAAeC,GACbR,EAASnB,MAAKV,GAAKqC,EAAI7B,SAASR,KACzB,MACP8B,EAAYpB,MAAKV,GAAKqC,EAAI7B,SAASR,KAC5B,SACP+B,EAAWrB,MAAKV,GAAKqC,EAAI7B,SAASR,KAC3B,QACPgC,EAAWtB,MAAKV,GAAKqC,EAAI7B,SAASR,KAC3B,QACPiC,EAAevB,MAAKV,GAAKqC,EAAI7B,SAASR,KAC/B,YACPkC,EAAcxB,MAAKV,GAAKqC,EAAI7B,SAASR,KAC9B,WACPmC,EAASzB,MAAKV,GAAKqC,EAAI7B,SAASR,KACzB,MACJ,UAELsC,EAAYF,EAAYV,GACxBa,EAAYH,EAAYT,GAE9B,GAAIW,IAAcC,EACd,MAAkB,cAAdD,EACO,GACJ,GAGX,GAAmB,QAAdA,GAAqC,UAAdC,GACT,UAAdD,GAAuC,QAAdC,GACX,WAAdD,GAAwC,aAAdC,GACZ,aAAdD,GAA0C,WAAdC,EAC7B,MAAO,GAGX,MAAO,EACX,CArK0BC,CAAuBjD,EAAUC,GACnDgC,EAAgB,GAChB/B,EAAQ8B,KAAK,4BAERC,EAAgB,IACrB/B,EAAQ8B,KAAK,4BAGjB,MAAMkB,EAiKV,SAAmC9C,EAAOC,GACtC,IAAI8C,EAAIC,EAAIC,EAAIC,EAEhB,MAAMC,EAAe,CACjBC,OAAQ,CAAC,SAAU,QAAS,WAAY,QAAS,MAAO,UAAW,QAAS,QAAS,SAAU,SAAU,SAAU,SAAU,aAAc,WAC3IC,OAAQ,CAAC,SAAU,UAAW,WAAY,OAAQ,SAAU,SAAU,eAAgB,aAAc,SAAU,iBAC9GC,SAAU,CAAC,QAAS,SAAU,UAAW,aAAc,UAAW,WAAY,MAAO,cAAe,UAAW,aAC/GC,QAAS,CAAC,UAAW,QAAS,WAAY,OAAQ,SAAU,UAAW,YAAa,oBACpFC,SAAU,CAAC,OAAQ,WAAY,UAAW,SAAU,QAAS,UAAW,SAAU,UAAW,UAC7FC,WAAY,CAAC,UAAW,QAAS,SAAU,SAAU,QAAS,YAAa,QAAS,eACpFC,QAAS,CAAC,UAAW,QAAS,UAAW,YAAa,WAAY,aAGhEC,EAAgB1F,IAClB,MAAM2F,EAAW,GAAG3F,EAAK4F,MAAQ,MAAM5F,EAAK6F,aAAe,KAAKxD,cAChE,OAAOyD,OAAOC,QAAQb,GAAczD,KAAI,EAAEuE,EAAOC,MAE7C,MAAMC,EAAUD,EAAStD,QAAOwD,GAAWR,EAAS/C,SAASuD,KAAUjE,OAEvE,MAAO,CAAE8D,QAAOI,MADFF,EAAU,EAAIA,EAAUD,EAAS/D,OAAS,EACjC,IACxBS,QAAOjE,GAAUA,EAAO0H,MAAQ,IAC9BC,MAAK,CAACC,EAAGC,IAAMA,EAAEH,MAAQE,EAAEF,OAAM,EAEpCI,EAAUd,EAAa3D,GACvB0E,EAAUf,EAAa1D,GAE7B,GAAuB,IAAnBwE,EAAQtE,QAAmC,IAAnBuE,EAAQvE,OAChC,MAAO,GAGX,IAA2B,QAArB4C,EAAK0B,EAAQ,UAAuB,IAAP1B,OAAgB,EAASA,EAAGkB,UAAkC,QAArBjB,EAAK0B,EAAQ,UAAuB,IAAP1B,OAAgB,EAASA,EAAGiB,OACjI,MAAO,GAIX,GAD0BQ,EAAQ7D,QAAO+D,GAAMD,EAAQ3D,MAAK6D,GAAMA,EAAGX,QAAUU,EAAGV,UAC5D9D,OAAS,EAC3B,MAAO,GAGX,MAAM0E,EAAuB,CACzB,CAAC,SAAU,YACX,CAAC,SAAU,cACX,CAAC,SAAU,YACX,CAAC,SAAU,cACX,CAAC,aAAc,WACf,CAAC,UAAW,aAEVC,EAAsC,QAArB7B,EAAKwB,EAAQ,UAAuB,IAAPxB,OAAgB,EAASA,EAAGgB,MAC1Ec,EAAsC,QAArB7B,EAAKwB,EAAQ,UAAuB,IAAPxB,OAAgB,EAASA,EAAGe,MAChF,GAAIa,GAAiBC,EACjB,IAAK,MAAOJ,EAAIC,KAAOC,EACnB,GAAKC,IAAkBH,GAAMI,IAAkBH,GAC1CE,IAAkBF,GAAMG,IAAkBJ,EAC3C,MAAO,IAKnB,MAAO,EACX,CA5N6BK,CAA0BpF,EAAUC,GACzDiD,EAAmB,GACnBhD,EAAQ8B,KAAK,8BAERkB,EAAmB,IACxBhD,EAAQ8B,KAAK,sBAGjB,MAAMqD,EAA+B,GAAflF,EACF,IAAhB8B,EACmB,IAAnBiB,EAEAmC,GAAgBxG,EAAuBC,IACvCoB,EAAQoF,QAAQzG,EAAuBG,OAElCqG,GAAgBxG,EAAkBC,IACvCoB,EAAQoF,QAAQzG,EAAkBG,OAE7BqG,GAAgBxG,EAAkBC,IACvCoB,EAAQoF,QAAQzG,EAAkBG,OAGlCkB,EAAQoF,QAAQzG,EAAkBG,OAEtC,MAAO,CACHyF,MAAOY,EACPnF,UACAC,eACA8B,gBACAiB,mBAER,CA/F6BqC,CAA2BpG,EAAcd,GAC9D,OAAO8F,OAAOqB,OAAOrB,OAAOqB,OAAO,CAAC,EAAGnH,GAAO,CAAEoH,kBAAmB1F,GAAe,IACnF2E,MAAK,CAACC,EAAGC,KACR,IAAIzB,EAAIC,EAER,QAAwC,QAA9BD,EAAKyB,EAAEa,yBAAsC,IAAPtC,OAAgB,EAASA,EAAGsB,QAAU,KAAsC,QAA9BrB,EAAKuB,EAAEc,yBAAsC,IAAPrC,OAAgB,EAASA,EAAGqB,QAAU,EAAE,KAEjL,CAACrF,EAAoBD,IAsRxB,OAAQ,UAAM,MAAOgF,OAAOqB,OAAO,CAAEE,UAAW,+BAAiC,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAED,UAAW,wCAAyCE,QAAS1G,KAAY,UAAM,MAAOiF,OAAOqB,OAAO,CAAEE,UAAW,wCAA0C,CAAEC,SAAU,EAAC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEE,UAAW,qCAAsCE,QAAS1G,GAAW,CAAEyG,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,iHAAoH,UAAM,MAAO/B,OAAOqB,OAAO,CAAEE,UAAW,uCAAyC,CAAEC,SAAU,EAAC,SAAK,KAAMxB,OAAOqB,OAAO,CAAEE,UAAW,qCAAsCrB,MAAO,CAAE8B,MAAO5G,IAAkB,CAAEoG,SAzQn1B,MACvB,IAAKxG,EAAa+C,SACd,MAAO,qBACX,MAAMA,EAAW/C,EAAa+C,SAASxB,cACvC,MAAI,CAAC,MAAO,QAAS,SAAU,UAAUS,MAAK9C,GAAQ6D,EAASjB,SAAS5C,KAC7D,gDAEF,CAAC,SAAU,OAAQ,UAAW,OAAQ,SAAS8C,MAAK9C,GAAQ6D,EAASjB,SAAS5C,KAC5E,6CAEF,CAAC,SAAS8C,MAAK9C,GAAQ6D,EAASjB,SAAS5C,KACvC,8CAEF,CAAC,QAAQ8C,MAAK9C,GAAQ6D,EAASjB,SAAS5C,KACtC,iDAEF,CAAC,YAAa,MAAO,WAAW8C,MAAK9C,GAAQ6D,EAASjB,SAAS5C,KAC7D,2CAEJ,oBAAoB,EAsPy1B+H,OAA0B,UAAM,IAAKjC,OAAOqB,OAAO,CAAEE,UAAW,yCAA2C,CAAEC,SAAU,CAAC,oDAAqDxG,EAAa8E,cAAgB,SAAK,MAAOE,OAAOqB,OAAO,CAAEE,UAAW,8CAAgD,CAAEC,UAAU,SAAKU,EAAA,EAAU,CAAEhI,KAAMc,EAAcE,YAAaA,EAAaE,aAAcA,QAAqB,SAAK,MAAO4E,OAAOqB,OAAO,CAAEE,UAAW,oDAAsD,CAAEC,SAAU/F,EAA2BE,KAAIzB,IACv3C,MAAM0B,EAAe1B,EAAKoH,kBACpBa,GAAoC,OAAjBvG,QAA0C,IAAjBA,OAA0B,EAASA,EAAa0E,QAAU5F,EAAuBC,IAAM,WACnH,OAAjBiB,QAA0C,IAAjBA,OAA0B,EAASA,EAAa0E,QAAU5F,EAAkBC,IAAM,WACtF,OAAjBiB,QAA0C,IAAjBA,OAA0B,EAASA,EAAa0E,QAAU5F,EAAkBC,IAAM,UAAY,UAChI,OAAQ,UAAM,MAAOqF,OAAOqB,OAAO,CAAEE,UAAW,sCAAqClG,EAAcyB,SAAS5C,EAAKkI,IAAM,8CAAgD,IAAMX,QAAS,KAAMY,OA1RvLjI,EA0R2MF,EAAKkI,QAzRzO9G,GAAiBgH,GAAQA,EAAKxF,SAAS1C,GACjCkI,EAAKzF,QAAOuF,GAAMA,IAAOhI,IACzB,IAAIkI,EAAMlI,KAHQ,IAACA,CA0RoN,GAAG,CAAEoH,SAAU,CAAC5F,IAAiB,UAAM,MAAOoE,OAAOqB,OAAO,CAAEE,UAAW,2CAA4CrB,MAAO,CAAEqC,gBAAiBJ,IAAqB,CAAEX,SAAU,CAACgB,KAAKC,MAA2B,IAArB7G,EAAa0E,OAAc,eAAiB,SAAK4B,EAAA,EAAU,CAAEhI,KAAMA,EAAMgB,YAAaA,EAAaE,aAAcA,IAAiBQ,IAAiB,UAAM,MAAOoE,OAAOqB,OAAO,CAAEE,UAAW,8CAAgD,CAAEC,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,6CAA+C,CAAEC,SAAU5F,EAAaG,QAAQ,OAAQ,UAAM,MAAOiE,OAAOqB,OAAO,CAAEE,UAAW,8CAAgD,CAAEC,SAAU,EAAC,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,6CAA+C,CAAEC,SAAU,EAAC,SAAK,OAAQ,CAAEA,SAAU,aAAc,SAAK,OAAQxB,OAAOqB,OAAO,CAAEE,UAAW,2CAA6C,CAAEC,UAAU,SAAK,OAAQ,CAAED,UAAW,2CAA4CrB,MAAO,CAAE0B,MAAsC,IAA5BhG,EAAaI,aAAhB,IAAuCuG,gBAAiBJ,aAA+B,UAAM,MAAOnC,OAAOqB,OAAO,CAAEE,UAAW,6CAA+C,CAAEC,SAAU,EAAC,SAAK,OAAQ,CAAEA,SAAU,gBAAiB,SAAK,OAAQxB,OAAOqB,OAAO,CAAEE,UAAW,2CAA6C,CAAEC,UAAU,SAAK,OAAQ,CAAED,UAAW,2CAA4CrB,MAAO,CAAE0B,MAAuC,IAA7BhG,EAAakC,cAAhB,IAAwCyE,gBAAiBJ,qBAA0C,SAAK,MAAOnC,OAAOqB,OAAO,CAAEE,UAAW,4CAA8C,CAAEC,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,yCAA2C,CAAEC,SAAUnG,EAAcyB,SAAS5C,EAAKkI,MAAQ,SAAK,MAAOpC,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,kEAAyE7H,EAAKkI,GAAI,QAC3oE,SAAK,MAAOpC,OAAOqB,OAAO,CAAEE,UAAW,wCAA0C,CAAEC,UAAU,UAAM,SAAUxB,OAAOqB,OAAO,CAAEE,UAAW,uCAAwCE,QAtRjL,KACvB,MAAMiB,EAAarH,EAAce,OAAS,EACpCf,EACAI,EAA2BE,KAAIzB,GAAQA,EAAKkI,KAClDjH,EAAeuH,GACf3H,GAAS,EAiR4NmF,MAAO,CAAEqC,gBAAiBnH,IAAkB,CAAEoG,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,0XAA6X,OAAQ1G,EAAce,OAAS,EAAI,WAAa,MAAO,yBAA8B,C,uEEpTh6B,ICNA,EDCyB,EAAGuG,aAAYC,mBAAkBC,WAAUC,cAAa,EAAMjI,QAAQ,WAAYO,mBAEvG,MAAM2H,EAAa3H,EAAe,CAAE,wBAAyBA,QAAiB4H,EAC9E,OAAQ,UAAM,MAAOhD,OAAOqB,OAAO,CAAEE,UAAW,4BAA6BrB,MAAO6C,GAAc,CAAEvB,SAAU,CAAC3G,IAAU,SAAK,QAASmF,OAAOqB,OAAO,CAAEE,UAAW,oCAAsC,CAAEC,SAAU3G,MAAY,UAAM,SAAUmF,OAAOqB,OAAO,CAAEE,UAAW,oCAAqChJ,MAAOqK,EAAkBC,SAAWnK,GAAMmK,EAASnK,EAAEuK,OAAO1K,OAAQ,aAAcsC,GAAS,CAAE2G,SAAU,CAACsB,IAAe,SAAK,SAAU9C,OAAOqB,OAAO,CAAE9I,MAAO,OAAS,CAAEiJ,SAAU,oBAAuBmB,EAAWhH,KAAIoC,IAAa,SAAK,SAAUiC,OAAOqB,OAAO,CAAE9I,MAAOwF,EAASqE,IAAM,CAAEZ,SAAUzD,EAAS+B,OAAS/B,EAASqE,WAAY,SAAK,MAAOpC,OAAOqB,OAAO,CAAEE,UAAW,oCAAsC,CAAEC,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,4BAAiC,C,gIE+Cn6B,ICnDA,EDImB,EAAGmB,QAAQ,cAAeC,OAAM/H,eAAcgI,cAAc,OAAQC,eAAcC,kBAAiB,EAAOC,YAAY,WACrI,MAAM,eAAEC,EAAc,WAAEC,EAAU,YAAEC,IAAgB,UA+BpD,OAAQ,UAAM,MAAO1D,OAAOqB,OAAO,CAAEE,UAAW,sBAAuBrB,MAAO,CAAEqC,gBAAiBnH,IAAkB,CAAEoG,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,6BAA+B,CAAEC,SAAU2B,GAAQ,SAAK,MAAO,CAAEQ,IAAKR,EAAMS,IAAKV,EAAO3B,UAAW,mCAAuC,SAAK,MAAOvB,OAAOqB,OAAO,CAAEE,UAAW,yCAA2C,CAAEC,SA7B/W,CAACqC,IACnB,OAAQA,GACJ,IAAK,OACD,OAAQ,SAAK,MAAO7D,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,0hBACpL,IAAK,WACD,OAAQ,SAAK,MAAO/B,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,gLACpL,IAAK,WACD,OAAQ,SAAK,MAAO/B,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,8IACpL,IAAK,QACD,OAAQ,SAAK,MAAO/B,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,4aACpL,IAAK,SACD,OAAQ,SAAK,MAAO/B,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,yGACpL,IAAK,WACD,OAAQ,SAAK,MAAO/B,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,qQACpL,QACI,OAAQ,SAAK,MAAO/B,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,4HACxL,EAa2Y+B,CAAcP,UAAqB,SAAK,MAAOvD,OAAOqB,OAAO,CAAEE,UAAW,8BAAgC,CAAEC,SAAU0B,MAAW,UAAM,MAAOlD,OAAOqB,OAAO,CAAEE,UAAW,iCAAmC,CAAEC,SAAU,CAAC8B,IAAmB,SAAK,MAAOtD,OAAOqB,OAAO,CAAEE,UAAW,oCAAsC,CAAEC,UAAU,SAAK,KAAgB,CAAC,OAAUkC,IAAgB,SAAKK,EAAA,EAAsB,CAAEC,oBAAqB,KAC1xBX,GAEoB,aAAhBD,GACAC,EAAa,WAQrB,IACGA,IAAiBK,GAA6B,SAAdH,IAAyB,SAAK,SAAUvD,OAAOqB,OAAO,CAAEE,UAAW,kEAAmEE,QAAS,IAAM4B,EAAa,QAAS,aAAc,kBAAoB,CAAE7B,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,kIAAsI,SAAK,SAAU/B,OAAOqB,OAAO,CAAEE,UAAW,oEAAqEE,QAxB1pB,KACnB+B,GAAgB,EAuBsrB,aAAcE,EAAc,WAAa,YAAc,CAAElC,SAAUkC,GAAe,SAAK,MAAO1D,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,4CAAiD,SAAK,MAAO/B,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,6BAAiC,SAAK,SAAU/B,OAAOqB,OAAO,CAAEE,UAAW,iEAAkEE,QArBtxC,KAChBgC,GAAY,EAoBgzC,aAAc,SAAW,CAAEjC,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,+HAAqI,E,4CEUtpD,IC3DA,EDOiB,EAAGkC,WAAUC,iBAAgBC,mBAAkBC,oBAAmBC,eAAcC,aAAY,EAAOlJ,mBAChH,MAAMmJ,GAAiB,IAAAC,QAAO,MACxBC,GAAqB,IAAAD,QAAO,OAElC,IAAAhJ,YAAU,KACNkJ,GAAgB,GACjB,CAACT,IACJ,MAAMS,EAAiB,KACfH,EAAeI,SACfJ,EAAeI,QAAQC,eAAe,CAAEC,SAAU,UACtD,EAwCJ,OAAQ,SAAK,MAAO7E,OAAOqB,OAAO,CAAEE,UAAW,oBAAqBuD,IAAKL,GAAsB,CAAEjD,UAAU,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,+BAAiC,CAAEC,SAAU,CAACyC,EAAStI,KAAKoJ,GArCzL,CAACA,IACnB,OAAQA,EAAQC,MACZ,IAAK,OACD,OAAQ,SAAKC,EAAA,EAAe,CAAEF,QAASA,EAAS3J,aAAcA,EAAc8J,WAAYd,GAAqBW,EAAQ3C,IACzH,IAAK,iBACD,OAAQ,UAAM,MAAOpC,OAAOqB,OAAO,CAAEE,UAAW,qCAAuC,CAAEC,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,2CAA6C,CAAEC,SAAU,6CAA8C,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,2CAA6C,CAAEC,SAAUuD,EAAQI,MAAMxJ,KAAKzB,IAErV,MAAMkL,EAAqB,CACvBhD,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKyL,UACjBC,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,GAEb,OAAQ,SAAK7D,EAAA,QAAU,CAAEhI,KAAMkL,EAAoBF,WAAYhB,EAAgB9I,aAAcA,GAAgBlB,EAAKkI,GAAI,UAC9G2C,EAAQ3C,IACpC,IAAK,SACD,OAAQ,SAAK4D,EAAA,EAAe,CAAEC,OAAQlB,EAAQkB,OAAQf,WAAYf,EAAkB/I,aAAcA,GAAgB2J,EAAQ3C,IAC9H,IAAK,OACD,OAAQ,SAAK8D,EAAA,QAAW,CAAEC,OAAQpB,EAAQoB,OAAQjD,MAAO6B,EAAQ7B,MAAOnD,YAAagF,EAAQhF,YAAaqG,SAAU/B,GAAgB,MAAU,GAAGjJ,aAAcA,GAAgB2J,EAAQ3C,IAC3L,IAAK,UACD,OAAQ,SAAK,MAAOpC,OAAOqB,OAAO,CAAEE,UAAW,8BAAgC,CAAEC,UAAU,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,mCAAqC,CAAEC,SAAU,EAAC,SAAK,OAAQ,CAAC,IAAI,SAAK,OAAQ,CAAC,IAAI,SAAK,OAAQ,CAAC,SAAYuD,EAAQ3C,IAC/P,IAAK,QACD,OAAQ,UAAM,MAAOpC,OAAOqB,OAAO,CAAEE,UAAW,4BAA8B,CAAEC,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,iCAAmC,CAAEC,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,4GAA+G,SAAK,MAAO/B,OAAOqB,OAAO,CAAEE,UAAW,oCAAsC,CAAEC,SAAUuD,EAAQsB,YAAetB,EAAQ3C,IACpkB,QACI,OAAO,KACf,EAEuNkE,CAAcvB,KAAWT,IAAc,SAAK,MAAOtE,OAAOqB,OAAO,CAAEE,UAAW,8BAAgC,CAAEC,UAAU,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,mCAAqC,CAAEC,SAAU,EAAC,SAAK,OAAQ,CAAC,IAAI,SAAK,OAAQ,CAAC,IAAI,SAAK,OAAQ,CAAC,WAAc,SAAK,MAAO,CAAEsD,IAAKP,UAA2B,EE0BjiB,MAhF0B,EAAGgC,gBAAenL,eAAcoL,YAAW,MACjE,MAAOC,EAAYC,IAAiB,IAAAnL,WAAS,IACtCoL,EAASC,IAAc,IAAArL,UAAS,MACjCsL,GAAe,IAAArC,QAAO,MA6BtBsC,EAAeC,IACjB,GAAIA,EAAM3K,OAAS,EAAG,CAClB,MAAM4K,EAAOD,EAAM,GAEnB,IAAKC,EAAKhC,KAAKiC,MAAM,WAEjB,YADAC,MAAM,gDAIV,MAAMC,EAAS,IAAIC,WACnBD,EAAOE,OAAS,KACZT,EAAWO,EAAOvO,OAAO,EAE7BuO,EAAOG,cAAcN,GAErBT,EAAcS,EAClB,GAuBEO,EAAgB,CAClBC,YAAaf,EAAcrL,GAAgB,eAAa4H,EACxDT,gBAAiBkE,EAAa,GAAGrL,GAAgB,mBAAgB4H,GAE/DyE,EAAc,CAChBlF,gBAAiBnH,QAAgB4H,GAErC,OAAQ,UAAM,MAAOhD,OAAOqB,OAAO,CAAEE,UAAW,+BAA+BkF,EAAa,WAAa,MAAMD,EAAW,WAAa,KAAMkB,YAzEpHhP,IACrBA,EAAEiP,iBACFjP,EAAEkP,kBACGpB,GACDE,GAAc,EAAK,EAqEgJmB,YAnElJnP,IACrBA,EAAEiP,iBACFjP,EAAEkP,kBACFlB,GAAc,EAAM,EAgEiLoB,WA9DjLpP,IACpBA,EAAEiP,iBACFjP,EAAEkP,kBACGpB,GACDE,GAAc,EAAK,EA0D0MqB,OAxDjNrP,IAIhB,GAHAA,EAAEiP,iBACFjP,EAAEkP,kBACFlB,GAAc,GACVF,EACA,OACJ,MAAMO,EAAQrO,EAAEsP,aAAajB,MAC7BD,EAAYC,EAAM,EAiDmOtF,QA3B/N,MACjB+E,GAAYK,EAAalC,SAC1BkC,EAAalC,QAAQsD,OACzB,EAwBiR/H,MAAOqH,GAAiB,CAAE/F,SAAU,EAAC,SAAK,QAAS,CAAEwD,KAAM,OAAQF,IAAK+B,EAActF,UAAW,qCAAsC2G,OAAQ,UAAWrF,SArBrZnK,IACtB,MAAMqO,EAAQrO,EAAEuK,OAAO8D,MACnBA,GACAD,EAAYC,EAChB,EAiBucP,SAAUA,IAAaG,GAAW,UAAM,MAAO3G,OAAOqB,OAAO,CAAEE,UAAW,wCAA0C,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAEmC,IAAKgD,EAAS/C,IAAK,UAAWrC,UAAW,gDAAiD,SAAK,SAAUvB,OAAOqB,OAAO,CAAEE,UAAW,6CAA8CE,QAd/uB/I,IACzBA,EAAEkP,kBACFhB,EAAW,MACPC,EAAalC,UACbkC,EAAalC,QAAQpM,MAAQ,GACjC,EASsyB,aAAc,gBAAkB,CAAEiJ,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,qHAA4H,UAAM,MAAO/B,OAAOqB,OAAO,CAAEE,UAAW,wCAA0C,CAAEC,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,qCAAuC,CAAEC,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,qKAAwK,UAAM,MAAO/B,OAAOqB,OAAO,CAAEE,UAAW,qCAAuC,CAAEC,SAAU,EAAC,SAAK,IAAK,CAAEA,SAAU,6CAA8C,SAAK,QAAS,CAAEA,SAAU,gDAAqDmF,IAAY,SAAK,SAAU3G,OAAOqB,OAAO,CAAEE,UAAW,sCAAuCrB,MAAOuH,EAAajB,SAAUA,GAAY,CAAEhF,SAAU,qBAAyB,EC1BliE,MApDqB,EAAG2G,cAAa/M,eAAcoL,YAAW,MAC1D,MAAOZ,EAAKwC,IAAU,IAAA7M,UAAS,KACxB8M,EAASC,IAAc,IAAA/M,WAAS,IAChCgN,EAAcC,IAAmB,IAAAjN,UAAS,IA4C3CkN,EAAoB,CACtBlG,gBAAiBnH,QAAgB4H,GAErC,OAAQ,UAAM,MAAOhD,OAAOqB,OAAO,CAAEE,UAAW,2BAA0BiF,EAAW,WAAa,KAAQ,CAAEhF,SAAU,EAAC,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,kCAAoC,CAAEC,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,+NAAkO,SAAK,KAAM/B,OAAOqB,OAAO,CAAEE,UAAW,iCAAmC,CAAEC,SAAU,kCAAoC,UAAM,OAAQxB,OAAOqB,OAAO,CAAEE,UAAW,+BAAgC6E,SAvB31B1N,IAElB,GADAA,EAAEiP,iBACEnB,EACA,OACJ,MAAMkC,EAAa9C,EAAI+C,OACvB,IAAKD,EAGD,OAFAJ,GAAW,QACXE,EAAgB,sBAnBJ,CAAC5C,IACjB,IAGI,OADA,IAAIgD,IAAIhD,IACD,CACX,CACA,MAAOlN,GAEH,OADA8P,EAAgB,6BACT,CACX,GAaKK,CAAYH,IAKjBP,EAAYO,GAEZN,EAAO,KANHE,GAAW,EAML,GAM63B,CAAE9G,SAAU,EAAC,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,2CAA6C,CAAEC,SAAU,EAAC,SAAK,QAAS,CAAEwD,KAAM,OAAQzD,UAAW,kCAAkC8G,EAAoB,GAAV,SAAgB9P,MAAOqN,EAAK/C,SA7CrlCnK,IAClB,MAAMH,EAAQG,EAAEuK,OAAO1K,MACvB6P,EAAO7P,GAEF8P,IACDC,GAAW,GACXE,EAAgB,IACpB,EAsC+nCM,YAAa,qDAAsDtC,SAAUA,KAAc6B,IAAY,SAAK,MAAOrI,OAAOqB,OAAO,CAAEE,UAAW,iCAAmC,CAAEC,SAAU+G,UAAwB,UAAM,SAAUvI,OAAOqB,OAAO,CAAE2D,KAAM,SAAUzD,UAAW,iCAAkCiF,SAAUA,GAA2B,KAAfZ,EAAI+C,OAAezI,MAAOuI,EAAmB,aAAc,cAAgB,CAAEjH,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,yDAA4D,wBAA0B,SAAK,MAAO/B,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,UAAU,SAAK,IAAK,CAAEA,SAAU,yHAA6H,EC4F7gE,ICjJA,EDOkB,EAAGuH,gBAAexC,gBAAe4B,cAAaa,eAAcF,cAAc,oBAAqBtC,YAAW,EAAOpL,mBAC/H,MAAO2J,EAASkE,IAAc,IAAA1N,UAAS,KAChC2N,EAAmBC,IAAwB,IAAA5N,WAAS,IACpD6N,EAAcC,IAAmB,IAAA9N,WAAS,IAC1C+N,EAAaC,IAAkB,IAAAhO,WAAS,GACzCiO,GAAW,IAAAhF,QAAO,OAClB,UAAEF,IAAc,UAEhBmF,GAAoB,IAAAjF,QAAO,OAEjC,IAAAhJ,YAAU,KAEN,GAAI,sBAAuBkO,QAAU,4BAA6BA,OAAQ,CACtE,MAAMC,EAAuBD,OAAOE,mBAAqBF,OAAOG,wBAChEJ,EAAkB9E,QAAU,IAAIgF,EAC5BF,EAAkB9E,UAElB8E,EAAkB9E,QAAQmF,YAAa,EACvCL,EAAkB9E,QAAQoF,gBAAiB,EAC3CN,EAAkB9E,QAAQqF,KAAO,QAEjCP,EAAkB9E,QAAQsF,SAAYC,IAClC,MAAMC,EAAaC,MAAMC,KAAKD,MAAMC,KAAK,CAAEjO,OAAQ8N,EAAMI,QAAQlO,SAAU,CAACmO,EAAGC,IAAMN,EAAMI,QAAQE,MAC9F7O,KAAI/C,IAAY,IAAIoG,EAAI,OAA6B,QAApBA,EAAKpG,EAAO,UAAuB,IAAPoG,OAAgB,EAASA,EAAGmL,aAAe,EAAE,IAC1GM,KAAK,IACVxB,GAAW3G,IAASA,EAAO,IAAM6H,GAAYxB,QAAO,EAExDc,EAAkB9E,QAAQ+F,MAAQ,KAC9BnB,GAAe,EAAM,EAEzBE,EAAkB9E,QAAQgG,QAAWT,IAEjCX,GAAe,EAAM,EAGjC,CACA,MAAO,KAECE,EAAkB9E,SAClB8E,EAAkB9E,QAAQiG,OAC9B,CACH,GACF,KAuCH,IAAApP,YAAU,MACFgO,EAAS7E,SAAYuE,GAAsBE,GAC3CI,EAAS7E,QAAQkG,OACrB,GACD,CAAC3B,EAAmBE,KAEvB,IAAA5N,YAAU,KACFgO,EAAS7E,UACT6E,EAAS7E,QAAQzE,MAAM2B,OAAS,OAChC2H,EAAS7E,QAAQzE,MAAM2B,OAAS,GAAGW,KAAK7H,IAAI6O,EAAS7E,QAAQmG,aAAc,SAC/E,GACD,CAAC/F,IACJ,MAUMgG,EAAoB,KACtB,MAAMC,EAAiBjG,EAAQ4D,QAC3BqC,GAAmBxE,GAAalC,IAChCyE,EAAciC,GACd/B,EAAW,IAEPO,EAAS7E,UACT6E,EAAS7E,QAAQzE,MAAM2B,OAAS,QAExC,EAiBEoJ,EAAkB,CACpB1I,gBAAiBnH,QAAgB4H,GAE/BkI,EAAoB,CACtBlJ,MAAO5G,QAAgB4H,EACvBwE,YAAapM,QAAgB4H,GAEjC,OAAQ,UAAM,MAAOhD,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,SAAU,CAAC0H,IAAsB,SAAK,EAAmB,CAAE3C,cArBpHS,IACnBT,IACAA,EAAcS,GACdmC,GAAqB,GACzB,EAiB6K3C,SAAUA,GAAYlC,EAAWlJ,aAAcA,IAAkBgO,IAAiB,SAAK,EAAc,CAAEjB,YAd/PvC,IACjBuC,IACAA,EAAYvC,GACZyD,GAAgB,GACpB,EAUkT7C,SAAUA,GAAYlC,EAAWlJ,aAAcA,KAAkB,UAAM,MAAO4E,OAAOqB,OAAO,CAAEE,UAAW,8BAAgC,CAAEC,SAAU,EAAC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEE,UAAW,uCAAsC2H,EAAoB,SAAW,IAAMzH,QA5FriB,KACxB0H,GAAsBD,GAClBE,GACAC,GAAgB,EAAM,EAyFikB7C,SAAUA,GAAYlC,EAAWpE,MAAOgJ,EAAoBgC,OAAoBlI,EAAW,aAAc,eAAgBE,MAAO,yCAA2C,CAAE1B,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,qKAAwK,SAAK,SAAU/B,OAAOqB,OAAO,CAAEE,UAAW,uCAAsC6H,EAAe,SAAW,IAAM3H,QAvF/rC,KACnB4H,GAAiBD,GACbF,GACAC,GAAqB,EAAM,EAoF4sC3C,SAAUA,GAAYlC,EAAWpE,MAAOkJ,EAAe8B,OAAoBlI,EAAW,aAAc,YAAaE,MAAO,kCAAoC,CAAE1B,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,8NAAkO,sBAAuB2H,QAAU,4BAA6BA,QAAU,SAAK,SAAU1J,OAAOqB,OAAO,CAAEE,UAAW,uCAAsC+H,EAAc,YAAc,IAAM7H,QAjFl8D,KACrB,GAAKgI,EAAkB9E,QAAvB,CAIA,GAAI2E,EAEAG,EAAkB9E,QAAQwG,OAC1B5B,GAAe,QAIf,IACIE,EAAkB9E,QAAQyG,QAC1B7B,GAAe,EACnB,CACA,MAAOlD,GAEP,CAGA2C,GACAA,GAlBJ,MAFI9B,MAAM,uDAqBV,EA0Dk/DV,SAAUA,GAAYlC,EAAW,aAAcgF,EAAc,iBAAmB,cAAepG,MAAO,2BAA6B,CAAE1B,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,4TAAkU,MAAM,SAAK,MAAO/B,OAAOqB,OAAO,CAAEE,UAAW,4BAA8B,CAAEC,SAAU,uEAAyE,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,sBAAwB,CAAEC,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,iCAAmC,CAAEC,UAAU,SAAK,WAAY,CAAEsD,IAAK0E,EAAUjI,UAAW,+BAAgCuH,YAAaA,EAAavQ,MAAOwM,EAASlC,SA3CnhGnK,IAClBuQ,EAAWvQ,EAAEuK,OAAO1K,MAAM,EA0CmiG8S,UAxC1iG3S,IAEL,UAAVA,EAAE4S,KAAoB5S,EAAE6S,WACxB7S,EAAEiP,iBACFoD,IACJ,EAmCulGvE,SAAUA,GAAYlC,EAAWkH,KAAM,EAAG,aAAc,sBAAwB,SAAK,SAAUxL,OAAOqB,OAAO,CAAEE,UAAW,kCAAmCE,QAASsJ,EAAmBvE,UAAWzB,EAAQ4D,QAAUnC,GAAYlC,EAAWpE,MAAO+K,EAAiB,aAAc,gBAAkB,CAAEzJ,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,uDAA6D,E,+MEhJjnHjK,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,GAAS,CAAE,MAAOG,GAAKL,EAAOK,EAAI,CAAE,CAC1F,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAiB,MAAEK,GAAS,CAAE,MAAOG,GAAKL,EAAOK,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAeL,EAIaK,EAAOC,KAAOT,EAAQQ,EAAOL,QAJ1CA,EAIyDK,EAAOL,MAJhDA,aAAiBN,EAAIM,EAAQ,IAAIN,GAAE,SAAUG,GAAWA,EAAQG,EAAQ,KAIjBO,KAAKR,EAAWK,EAAW,CAC7GH,GAAMN,EAAYA,EAAUa,MAAMhB,EAASC,GAAc,KAAKS,OAClE,GACJ,EAgCA,MAAMgT,GAAiB,IAAAC,OAAK,IAEjB,wCACF5S,MAAK6S,GAECA,IAENC,OAAMvF,IAEA,CAAEwF,QAASC,EAAA,cAGpBC,GAAqB,IAAAL,OAAK,IAErB,wCACF5S,MAAK6S,GAECA,IAENC,OAAMvF,IAEA,CAAEwF,QAASG,EAAA,cAGpBC,GAAe,IAAAP,OAAK,IAEf,wCACF5S,MAAK6S,GAECA,IAENC,OAAMvF,IAEA,CAAEwF,QAASK,EAAA,cAGpBC,GAAe,IAAAT,OAAK,IAEf,wCACF5S,MAAK6S,GAECA,IAENC,OAAMvF,IAEA,CAAEwF,QAASO,EAAA,cAGpBC,GAAmB,IAAAX,OAAK,IAEnB,wCACF5S,MAAK6S,GAECA,IAENC,OAAMvF,IAEA,CAAEwF,QAASS,EAAA,cAGpBC,GAAoB,IAAAb,OAAK,IAEpB,wCACF5S,MAAK6S,GAECA,IAENC,OAAMvF,IAEA,CAAEwF,QAASW,EAAA,cAGpBC,GAAkB,IAAAf,OAAK,IAElB,wCACF5S,MAAK6S,GAECA,IAENC,OAAMvF,IAEA,CAAEwF,QAAS,gBA+/B1B,ICvnCA,ED2HmB,EAAGa,SAAQrH,aAAYsH,SAAQC,WAAW,eAAgBxR,eAAe,UAAWyR,WAAW,mEAAoEC,eAAcxJ,kBAAiB,MAEjN,MAAOyJ,EAAaC,IAAkB,IAAAzR,WAAS,GACzC0R,GAA6B,IAAAzI,SAAO,IACnC0I,EAAaC,IAAkB,IAAA5R,UAAS,OACxC6R,EAAeC,IAAoB,IAAA9R,WAAS,IAE7C,SAAE0I,EAAQ,OAAEnJ,EAAM,YAAE4I,EAAW,UAAEY,EAAS,YAAElB,EAAW,eAAEkK,GAAc,WAAEC,GAAU,WAAEC,GAAU,SAAEC,GAAQ,eAAEC,KAAmB,WAE7HnK,GAAWoK,KAAgB,IAAApS,UAAS,SACrC,KAAEqS,GAAI,QAAEC,GAAO,aAAEC,GAAY,gBAAEC,KAAoB,WACnD,iBAAEC,GAAgB,mBAAEC,GAAkB,aAAEC,GAAY,oBAAEC,GAAmB,sBAAEC,GAAqB,cAAEC,GAAa,UAAEC,GAAS,WAAEC,KAAe,WAE3I,mBAAEC,KAAuB,SAEzBC,IAAM,QAAiB,CACzB/B,SACArH,aACAsH,WAGE+B,IAAiB,IAAAC,cAAY,IAAM7W,OAAU,OAAQ,OAAQ,GAAQ,YAEvE,IAEI0V,IAAW,GAEX,MAAMlU,GAAS,UAGf,IAAIsV,EACJ,IAGIA,QAAoBH,GAAIb,KAAKvU,eAAeC,EAEhD,CACA,MAAOZ,GAGHkW,QAAoBH,GAAIb,KAAKpU,YAEjC,CAGAqU,GAAQe,GAEJ/B,IAEAS,GAAeT,EAAU,mBAGnB,IAAI1U,SAAQC,GAAWyW,WAAWzW,EAAS,QAEjDkV,GAAe,6NAA+M,eAIlO,OAAW,IAAmBwB,YAAaF,EAAYtV,QAEnD,EAAAyV,wBAGMC,GAA4BJ,EAAYtV,QAM9CoQ,OAAOuF,kCAAoCjP,OAAOqB,OAAOrB,OAAOqB,OAAO,CAAC,EAAIqI,OAAOuF,mCAAqC,CAAC,GAAK,CAAEC,gBAAiB,CACzI5V,OAAQsV,EAAYtV,SAIpC,CACA,MAAO+M,GAEHoH,GAAS,4DACTH,GAAe,2DAA4D,SAC/E,CACA,QACIE,IAAW,EAEf,CACJ,KAAI,CAACiB,GAAK5B,EAAUS,GAAgBO,GAASL,GAAYC,KAEnDuB,GAA+B1V,GAAWxB,OAAU,OAAQ,OAAQ,GAAQ,YAG9E,KAAIkW,GAAiB5R,OAAS,GAI9B,IAEI,MAAM8S,QAAwBT,GAAIU,eAAeC,mBAAmB,CAChE9V,SACA+V,MAAO,IAKLC,EAAiBJ,EAAgB/J,MAAMxJ,KAAIzB,IAAQ,CACrDkI,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKwL,UAAU,IAAM,IACjCE,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,MAKb,GAFAoI,GAAoBmB,GAEhBJ,EAAgBK,SAAWL,EAAgBK,QAAQnT,OAAS,EAAG,CAE/D,MAAMoT,EAAmBN,EAAgBK,QAAQ5T,KAAIsK,IAAU,CAC3D7D,GAAI6D,EAAO7D,GACXtC,KAAMmG,EAAOnG,MAAQ,GACrB2P,SAAUxJ,EAAOwJ,SACjB5J,WAAYI,EAAOJ,WACnBC,aAAcG,EAAOH,aACrBX,MAAOc,EAAOd,MAAMxJ,KAAIzB,IAAQ,CAC5BkI,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKwL,UAAU,IAAM,IACjCE,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,UAIjBqI,GAAsBoB,EAC1B,CAEJ,CACA,MAAOnJ,GAGP,CACJ,KAEOqJ,GAAyBC,KAA8B,IAAApU,WAAS,GACjEqU,IAAuB,IAAApL,QAAO,MAC9BqL,IAAwB,IAAArL,SAAO,IAErC,IAAAhJ,YAAU,KAON,MAAMsU,GAA8D,IAAtCpG,OAAOqG,2BAErC,GAAIhD,GAAe+C,GAAyB7C,EAA2BtI,QAEnE,OAGJsI,EAA2BtI,SAAU,EAGrC+E,OAAOqG,4BAA6B,EAGpC,MAAMC,EAAgBnB,YAAW,KACxB9B,GAEDC,GAAe,EACnB,GACD,KA4BH,OAzBA0B,KAAiB5V,MAAK,KAClBmX,aAAaD,GAEbhD,GAAe,GAIV,EAAA+B,mBAAsBc,GAAsBlL,UAE7CiL,GAAqBjL,QAAUkK,YAAW,KACjCgB,GAAsBlL,SAGvBuL,IACJ,GACD,KACP,IACDtE,OAAMvF,IACL4J,aAAaD,GAGbhD,GAAe,EACsE,IAGlF,KAEHiD,aAAaD,GACTJ,GAAqBjL,SACrBsL,aAAaL,GAAqBjL,QACtC,CACH,GACF,CAACoI,EAAa2B,KAEjB,MAAMwB,GAAoB,KACtB,IAAIlR,EAIJ,IAAI6Q,GAAsBlL,UAK1BkL,GAAsBlL,SAAU,EAChCgL,IAA2B,GAEC,oBAAjB7C,GAEPA,KAGC,EAAAiC,mBAAqBrF,OAAOuF,oCAG2B,QAAnDjQ,EAAK0K,OAAOuF,yCAAsD,IAAPjQ,OAAgB,EAASA,EAAGkQ,kBAAiB,CACzG,MAAM,OAAE5V,GAAWoQ,OAAOuF,kCAAkCC,gBAE5DL,YAAW,KAEPG,GAA4B1V,EAAO,GACpC,KACP,CAKJ,GAGJ,IAAAkC,YAAU,KAGN,MAAM2U,EAAsB,KAExB9C,GAAiB,EAAK,EAGpB+C,EAAyB,KAG3B,GAAIpC,GAAiB5R,OAAS,EAAG,CAG7B,MAAMlC,EAAO8T,GAAiB,GAC9B,IAGIV,GAAe,iBAAiBpT,EAAK4F,qBAAsB,YAC/D,CACA,MAAOuG,GAEP,CACJ,CAGA,EAIAqD,OAAO2G,wBACPF,IAIAzG,OAAO4G,2BACPF,IAMJ,KAFoB1G,OAAO6G,sBAOvB,OAHA7G,OAAO6G,sBAAsBC,GAAG,iBAAkBL,GAClDzG,OAAO6G,sBAAsBC,GAAG,oBAAqBJ,GAE9C,KAEH1G,OAAO6G,sBAAsBE,IAAI,iBAAkBN,GACnDzG,OAAO6G,sBAAsBE,IAAI,oBAAqBL,EAAuB,CAErF,GACD,CAACpC,GAAkBV,MAEtB,IAAA9R,YAAU,KAKFoS,IAAQa,IAGRtB,EAAe,IAAI,IAAYsB,GAAIU,eAAgBvB,GAAKtU,OAAQmV,GAAIb,MAExE,GACD,CAACA,GAAMa,MAEV,IAAAjT,YAAU,KACFJ,IACAsV,SAASC,gBAAgBzQ,MAAM0Q,YAAY,0BAA2BxV,GAEtEsV,SAASC,gBAAgBzQ,MAAM0Q,YAAY,gCAAiCC,GAAazV,EAAc,KACvGsV,SAASC,gBAAgBzQ,MAAM0Q,YAAY,+BAAgCE,GAAY1V,EAAc,KACzG,GACD,CAACA,IAEJ,MAAMyV,GAAe,CAAC7O,EAAO+O,KACzB,IAEI/O,EAAQA,EAAMgP,QAAQ,IAAK,IAE3B,MAAMC,EAAIC,SAASlP,EAAMmP,UAAU,EAAG,GAAI,IACpCC,EAAIF,SAASlP,EAAMmP,UAAU,EAAG,GAAI,IACpC1Q,EAAIyQ,SAASlP,EAAMmP,UAAU,EAAG,GAAI,IAEpCE,EAAO7O,KAAK7H,IAAI,IAAK6H,KAAK8O,MAAML,GAAK,IAAMA,GAAKF,IAChDQ,EAAO/O,KAAK7H,IAAI,IAAK6H,KAAK8O,MAAMF,GAAK,IAAMA,GAAKL,IAChDS,EAAOhP,KAAK7H,IAAI,IAAK6H,KAAK8O,MAAM7Q,GAAK,IAAMA,GAAKsQ,IAEtD,MAAO,IAAIM,EAAKI,SAAS,IAAIC,SAAS,EAAG,OAAOH,EAAKE,SAAS,IAAIC,SAAS,EAAG,OAAOF,EAAKC,SAAS,IAAIC,SAAS,EAAG,MACvH,CACA,MAAO1S,GACH,OAAOgD,CACX,GAGE8O,GAAc,CAAC9O,EAAO+O,KACxB,IAEI/O,EAAQA,EAAMgP,QAAQ,IAAK,IAE3B,MAAMC,EAAIC,SAASlP,EAAMmP,UAAU,EAAG,GAAI,IACpCC,EAAIF,SAASlP,EAAMmP,UAAU,EAAG,GAAI,IACpC1Q,EAAIyQ,SAASlP,EAAMmP,UAAU,EAAG,GAAI,IAEpCE,EAAO7O,KAAK5H,IAAI,EAAG4H,KAAK8O,MAAML,GAAK,EAAIF,KACvCQ,EAAO/O,KAAK5H,IAAI,EAAG4H,KAAK8O,MAAMF,GAAK,EAAIL,KACvCS,EAAOhP,KAAK5H,IAAI,EAAG4H,KAAK8O,MAAM7Q,GAAK,EAAIsQ,KAE7C,MAAO,IAAIM,EAAKI,SAAS,IAAIC,SAAS,EAAG,OAAOH,EAAKE,SAAS,IAAIC,SAAS,EAAG,OAAOF,EAAKC,SAAS,IAAIC,SAAS,EAAG,MACvH,CACA,MAAO1S,GACH,OAAOgD,CACX,GA8OE2P,GAAqB,CAACvX,EAAQwX,IAAU9Z,OAAU,OAAQ,OAAQ,GAAQ,YAC5E,GAAK8V,GAEL,IACQgE,GACA9D,GAAa1T,IACb,OAAW,IAAmByX,UAAWjE,GAAKtU,OAAQ,CAAEc,aAGxD2T,GAAgB3T,IAChB,OAAW,IAAmB0X,aAAclE,GAAKtU,OAAQ,CAAEc,kBAGzDqU,GAAIU,eAAe4C,gBAAgB,CACrCzY,OAAQsU,GAAKtU,OACbc,SACAwX,QACAI,UAAW,IAAIC,OAGC,SAAhB7O,GAA0BwO,GAC1BtE,GAAe,gGAAmG,KAAc4E,UAExI,CACA,MAAO7L,GAEHoH,GAAS,kDACb,CACJ,IAEM0E,GAAuB,CAACC,EAAUR,IAAU9Z,OAAU,OAAQ,OAAQ,GAAQ,YAChF,GAAK8V,GAEL,KACI,OAAWgE,EAAQ,IAAmBS,YAAc,IAAmBC,eAAgB1E,GAAKtU,OAAQ,CAAE8Y,mBAEhG3D,GAAIU,eAAeoD,kBAAkB,CACvCjZ,OAAQsU,GAAKtU,OACb8Y,WACAR,QACAI,UAAW,IAAIC,OAGC,SAAhB7O,GAA0BwO,GAC1BtE,GAAe,kGAAqG,YAE5H,CACA,MAAOjH,GAEHoH,GAAS,kDACb,CACJ,IAyBM+E,GAAuBtY,IACzB,GAAK0T,GAEL,IACIS,GAAc,CACVjU,OAAQF,EAAKkI,GACbiD,aACAoN,QAAS,IAAIR,OAEG,SAAhB7O,GACAkK,GAAe,cAAcpT,EAAK4F,yBAA0B,cAEhE,OAAW,IAAmB4S,gBAAiB9E,GAAKtU,OAAQ,CAAEc,OAAQF,EAAKkI,IAC/E,CACA,MAAOiE,GAEHoH,GAAS,oDACb,GAGEkF,GAAkB,CAACzY,EAAM0Y,EAAW,EAAGC,EAAM7Q,KAC/C,GAAK4L,GAEL,IAEIU,GAAU,CACNlU,OAAQF,EAAKkI,GACbiD,aACAuN,WACAC,OACA7Q,QACAyQ,QAAS,IAAIR,OAGjB,gCAA6CnZ,MAAK,EAAGga,8BACjDA,EAAwBC,cAAc,CAClCC,UAAW9Y,EAAKkI,GAChB6Q,OAAQ,aACRjB,UAAW,IAAIC,KACf3Y,OAAQsU,GAAKtU,OACb+L,cACF,IAEc,SAAhBjC,GACAkK,GAAe,cAAcpT,EAAK4F,8BAA+B,cAErE,OAAW,IAAmBoT,YAAatF,GAAKtU,OAAQ,CACpDc,OAAQF,EAAKkI,GACbwQ,WACAC,OACA7Q,SAER,CACA,MAAOqE,GAEHoH,GAAS,gDACb,GAGE0F,GAAoBlN,IACtB,GAAK2H,GAEL,IACIW,GAAW,CACP6D,SAAUnM,EAAO7D,GACjB9I,OAAQsU,GAAKtU,OACbwG,KAAMmG,EAAOnG,MAAQ,cAAcmG,EAAOwJ,WAC1CtK,MAAOc,EAAOd,MAAMxJ,KAAIzB,GAAQA,EAAKkI,KACrCgR,QAAS,IAAInB,OAEG,SAAhB7O,GACAkK,GAAe,2CAA4C,cAE/D,OAAW,IAAmB+F,YAAazF,GAAKtU,OAAQ,CAAE8Y,SAAUnM,EAAO7D,IAC/E,CACA,MAAOiE,GAEHoH,GAAS,2CACb,GAGE6F,GAAoBtZ,GAAYlC,OAAU,OAAQ,OAAQ,GAAQ,YACpE,GAAK8V,GAEL,IACIJ,IAAW,GAEX,MAAM+F,EAAkB,GACxB,GAAIvZ,EAAQoC,OAASmX,EAAiB,CAElC,MAAMC,EAAsBxZ,EAAQ2B,KAAI6E,GAAKA,EAAEiT,aACzCC,EAAsBtJ,MAAMC,KAAK,CAAEjO,OAAQmX,IAAmB,CAAChJ,EAAGC,IAAM,IAAIA,EAAI,MACjF3N,QAAO8W,IAAQH,EAAoB1W,SAAS6W,MAIjD,OAAW,IAAmBC,mBAAoBhG,GAAKtU,OAAQ,CAC3Dua,gBAAiBH,EAAoBtX,QAE7C,CAEA,IACI0X,aAAaC,WAAW,qCAC5B,CACA,MAAOrb,GAEP,CAEA,UACU+V,GAAIb,KAAK7T,gBAAgB6T,GAAKtU,OAAQU,EAChD,CACA,MAAOqM,GAGHoH,GAAS,8FACb,CAMA,IAAIyB,EAJJ7B,GAAiB,GAEjBC,GAAe,iKAAkK,aAGjL,IACI4B,QAAwBT,GAAIU,eAAeC,mBAAmB,CAC1D9V,OAAQsU,GAAKtU,OACb+V,MAAO,EACP2E,gBAAgB,GAExB,CACA,MAAO3N,GAIH,OAFAoH,GAAS,6EACTD,IAAW,EAEf,OAEM,IAAIrV,SAAQC,GAAWyW,WAAWzW,EAAS,OAEjDmV,GAAW,CACPvI,KAAM,KAAYiP,eAClBC,OAAQ,KAAchC,UACtB/M,MAAO+J,EAAgB/J,QAI3B,MAAMmK,EAAiBJ,EAAgB/J,MAAMxJ,KAAIzB,IAAQ,CACrDkI,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKyL,UAAY,IAC7BC,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,MAKb,GAFAoI,GAAoBmB,GAEhBJ,EAAgBK,SAAWL,EAAgBK,QAAQnT,OAAS,EAAG,OACzD,IAAIjE,SAAQC,GAAWyW,WAAWzW,EAAS,OACjDkV,GAAe,2DAA6D,mBACtE,IAAInV,SAAQC,GAAWyW,WAAWzW,EAAS,OAEjDmV,GAAW,CACPvI,KAAM,KAAYmP,OAClBD,OAAQ,KAAchC,UACtBjM,OAAQiJ,EAAgBK,QAAQ,KAIpC,MAAMC,EAAmBN,EAAgBK,QAAQ5T,KAAIsK,IAAU,CAC3D7D,GAAI6D,EAAO7D,GACXtC,KAAMmG,EAAOnG,KACb2P,SAAUxJ,EAAOwJ,SACjB5J,WAAYI,EAAOJ,WACnBC,aAAcG,EAAOH,aAGrBX,MAAOc,EAAOd,MAAMxJ,KAAIzB,IAAQ,CAC5BkI,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKyL,UAAY,IAC7BC,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,UAIjBqI,GAAsBoB,EAC1B,EAEA,OAAW,IAAmB4E,oBAAqBxG,GAAKtU,cAElD,IAAInB,SAAQC,GAAWyW,WAAWzW,EAAS,OACjDkV,GAAe,wFAAyF,YAC5G,CACA,MAAOjH,GAEHoH,GAAS,6DAETJ,GAAiB,EACrB,CACA,QACIG,IAAW,EACf,CACJ,IAEM6G,GAAmBC,IAChB1G,MAGL,OAAW,IAAmB2G,aAAc3G,GAAKtU,OAAQ,CAAEgb,cAE3DhH,GAAe,2DAA6D,aAAY,EAatFkH,GAAmBC,IACrB9G,GAAa8G,GAEC,SAAVA,GAA8B,aAAVA,GACpB/G,GAAe+G,GAGnB,MAAMC,EAAe,CACjB,SAAY,IAAmBC,cAC/B,SAAY,IAAmBC,eAC/B,MAAS,IAAmBC,oBAC5B,OAAU,IAAmBC,kBAC7B,SAAY,IAAmBC,qBAE/BL,EAAaD,IAAU7G,KACvB,OAAW8G,EAAaD,GAAQ7G,GAAKtU,OACzC,EAqBJ,IAAKwB,EACD,OAAO,KACX,MAAMka,GAAgB,uBApBE,CACpB,eAAgB,oCAChB,cAAe,mCACf,YAAa,iCACb,WAAY,iCAgB6CpI,MAAalJ,EAAc,iCAAmC,KAErHuR,GAAqC,MAEnC,EAAAlG,oBAIGW,IAA2BG,GAAsBlL,SAW5D,OAPA,IAAAnJ,YAAU,KAED,EAAAuT,mBAAsBc,GAAsBlL,SAE7CkK,WAAWqB,GAAmB,EAClC,GACD,KACK,UAAM,WAAW,CAAE1O,SAAU,EAAC,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAWyT,GAAe,cAAe,uBAAyB,CAAExT,SAAU,EAAC,SAAK,EAAY,CAAE0B,OAhC7IuR,GAgCmKlR,GA/BtK,CACb,KAAQ,cACR,SAAY,gBACZ,SAAY,cACZ,MAAS,iBACT,OAAU,mBACV,SAAY,kBAEAkR,KAAU,eAuByKrZ,aAAcA,EAAciI,aApEzM6R,IAEtBxH,GAAewH,GAEfvH,GAAauH,GACA,aAATA,IACA,OAAW,IAAmBP,eAAyB,OAAT/G,SAA0B,IAATA,QAAkB,EAASA,GAAKtU,SAAW,YAC9G,EA6D+P8J,YAAaA,EAAaE,eAAgBA,EAAgBC,UAAWA,MAAc,SAAK4R,EAAA,EAAe,CAAE5R,UAAWA,GAAW6R,YAAaZ,GAAiBpZ,aAAcA,EAAcia,gBAAiB,CACrbC,MAAM,EACNC,UAAU,EACVC,UAAU,EACVC,OAAO,EACPC,QAAQ,EACRC,UAAU,MACR,SAAKC,EAAA,EAAY,CAAEnU,QAAS,IAAM+S,GAAgB,QAASpZ,aAAcA,KAAiB,UAAM,MAAO4E,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,SAAU,EAAC,UAAMqU,EAAA,EAAoB7V,OAAOqB,OAAO,CAAEyU,KAAoB,SAAdvS,GAAsByB,KAAM,OAAQ+Q,SAAU,IAAKxU,UAAW,6BAA+B,CAAEC,SAAU,EAAC,SAAKwU,EAAA,EAAehW,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,2BAA6B,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,qBAAsB,SAAK,IAAK,CAAEA,SAAU,mCAAoC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEI,QAAS,IAAMiI,OAAOwM,SAASC,SAAU5U,UAAW,8BAAgC,CAAEC,SAAU,iBAAqB,CAAEA,UAAU,SAAK,EAAU,CAAEyC,SAAUA,EAAUC,eAAgByN,GAAoBxN,iBAAkBgO,GAAsB/N,kBAxU/zB,CAACgS,EAAWC,IAAYve,OAAU,OAAQ,OAAQ,GAAQ,YACpF,GAAK8V,IAASyI,EAEd,IAEI7H,GAAmB4H,IAEnB,OAAW,IAAmBE,kBAAmB1I,GAAKtU,OAAQ,CAAE8c,aASpE,CACA,MAAO/P,GAGP,CACJ,IAmTu4BkQ,gBAAiB/D,GAAqBtX,YAAayX,GAAiBrO,UAAWA,EAAWlJ,aAAcA,QAAqB,SAAK4a,EAAA,EAAehW,OAAOqB,OAAO,CAAE4U,UAAU,SAAK,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,4BAA8B,CAAEC,UAAU,SAAK,IAAK,CAAEA,SAAU,mCAAuC,CAAEA,UAAU,SAAK,EAAW,CAAEuH,cAxmBnsCyN,GAAS1e,OAAU,OAAQ,OAAQ,GAAQ,YAGlE,GADAwV,GAAekJ,EAAM,SAChB5I,KAASV,EACV,OAEJM,IAAW,GAEX,MAAMiJ,EAAYD,EAAKja,cAEvB,GAAIka,EAAU3Z,SAAS,aACnB2Z,EAAU3Z,SAAS,yBACnB2Z,EAAU3Z,SAAS,cAKnB,aAJM,IAAI3E,SAAQC,GAAWyW,WAAWzW,EAAS,OACjDkV,GAAe,+DAAiE,aAChFI,GAAe,iBACfF,IAAW,GAIf,GAAIiJ,EAAU3Z,SAAS,iBACnB2Z,EAAU3Z,SAAS,kBAKnB,aAJM,IAAI3E,SAAQC,GAAWyW,WAAWzW,EAAS,OACjDkV,GAAe,wDAAyD,aACxEI,GAAe,aACfF,IAAW,GAIf,GAAIiJ,EAAU3Z,SAAS,SACnB2Z,EAAU3Z,SAAS,kBACnB2Z,EAAU3Z,SAAS,eASnB,aARM,IAAI3E,SAAQC,GAAWyW,WAAWzW,EAAS,OACjDkV,GAAe,yFAA2F,aAEtGM,KACA,OAAW,IAAmB8I,iBAAkB9I,GAAKtU,QAEzD+T,GAAiB,QACjBG,IAAW,GAGf,IAEI,MAAMmJ,QAAkBzJ,EAAY0J,eAAeJ,GAEnD,IAAK,IAAIhM,EAAI,EAAGA,EAAImM,EAAUva,OAAQoO,IAAK,CAEnCA,EAAI,UACE,IAAIrS,SAAQC,GAAWyW,WAAWzW,EAAS,QAErD,MAAMye,EAAWF,EAAUnM,GAI3B,GAFA+C,GAAWsJ,GAEW,mBAAlBA,EAAS7R,KAA2B,CAEpC,MAAMsK,EAAiBuH,EAAS1R,MAAMxJ,KAAIzB,IAAQ,CAC9CkI,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKyL,UAAY,IAC7BC,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,MAEboI,GAAoBmB,EACxB,CAEA,GAAsB,WAAlBuH,EAAS7R,KAAmB,CAE5B,MAAM8R,EAAkB,CACpB1U,GAAIyU,EAAS5Q,OAAO7D,GACpBtC,KAAM+W,EAAS5Q,OAAOnG,KACtB2P,SAAUoH,EAAS5Q,OAAOwJ,SAC1B5J,WAAYgR,EAAS5Q,OAAOJ,WAC5BC,aAAc+Q,EAAS5Q,OAAOH,aAE9BX,MAAO0R,EAAS5Q,OAAOd,MAAMxJ,KAAIzB,IAAQ,CACrCkI,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKyL,UAAY,IAC7BC,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,OAIIkI,GAAmBjR,MAAKiJ,GAAUA,EAAO7D,KAAO0U,EAAgB1U,MAEjFgM,GAAsB,IAAIH,GAAoB6I,GAEtD,CACJ,CACJ,CACA,MAAOzQ,GAEHoH,GAASpH,aAAiB0Q,MAAQ1Q,EAAMtB,QAAUiS,OAAO3Q,IACzDiH,GAAe,iFAAkF,SACrG,CACA,QAEIE,IAAW,EACf,CACJ,IAifgwCjH,cA/eruCS,GAASlP,OAAU,OAAQ,OAAQ,GAAQ,YAClE,GAAK8V,IAASV,EAAd,CAGAM,IAAW,GACX,KAEI,OAAW,IAAmByJ,aAAcrJ,GAAKtU,QAEjD,MAAMqd,QAAkBzJ,EAAYgK,mBAAmBlQ,GAEvD,IAAK,IAAIwD,EAAI,EAAGA,EAAImM,EAAUva,OAAQoO,IAAK,CAEnCA,EAAI,UACE,IAAIrS,SAAQC,GAAWyW,WAAWzW,EAAS,QAErD,MAAMye,EAAWF,EAAUnM,GAI3B,GAFA+C,GAAWsJ,GAEW,mBAAlBA,EAAS7R,KAA2B,CAEpC,MAAMsK,EAAiBuH,EAAS1R,MAAMxJ,KAAIzB,IAAQ,CAC9CkI,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKyL,UAAY,IAC7BC,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,MAEboI,GAAoBmB,EACxB,CACJ,CACJ,CACA,MAAOjJ,GAEHoH,GAASpH,aAAiB0Q,MAAQ1Q,EAAMtB,QAAUiS,OAAO3Q,IACzDiH,GAAe,+EAAgF,SACnG,CACA,QAEIE,IAAW,EACf,CAhDU,CAiDd,IA4bkyCrF,YA1bzwCvC,GAAQ9N,OAAU,OAAQ,OAAQ,GAAQ,YAC/D,GAAK8V,IAASV,EAAd,CAGAM,IAAW,GACX,KAEI,OAAW,IAAmB2J,UAAWvJ,GAAKtU,OAAQ,CAAEsM,QAExD,MAAM+Q,QAAkBzJ,EAAYkK,gBAAgBxR,GAEpD,IAAK,IAAI4E,EAAI,EAAGA,EAAImM,EAAUva,OAAQoO,IAAK,CAEnCA,EAAI,UACE,IAAIrS,SAAQC,GAAWyW,WAAWzW,EAAS,QAErD,MAAMye,EAAWF,EAAUnM,GAI3B,GAFA+C,GAAWsJ,GAEW,mBAAlBA,EAAS7R,KAA2B,CAEpC,MAAMsK,EAAiBuH,EAAS1R,MAAMxJ,KAAIzB,IAAQ,CAC9CkI,GAAIlI,EAAKkI,GACTiD,WAAY,UACZvF,KAAM5F,EAAK4F,KACXwF,MAAOpL,EAAKoL,MACZvH,SAAU7D,EAAK6D,SACfwH,MAAOrL,EAAKqL,MACZC,UAAWtL,EAAKsL,UAChBrJ,OAAQ,GACRsJ,MAAO,GACPC,UAAW,CAACxL,EAAKyL,UAAY,IAC7BC,IAAK1L,EAAK0L,IACVC,WAAY3L,EAAK2L,WACjBC,aAAc5L,EAAK4L,aACnBC,SAAS,MAEboI,GAAoBmB,EACxB,CACJ,CACJ,CACA,MAAOjJ,GAEHoH,GAASpH,aAAiB0Q,MAAQ1Q,EAAMtB,QAAUiS,OAAO3Q,IACzDiH,GAAe,6EAA8E,SACjG,CACA,QAEIE,IAAW,EACf,CAhDU,CAiDd,IAuYg0CxE,aArYvyC,KACjB4E,KACA,OAAW,IAAmByJ,YAAazJ,GAAKtU,OAGpD,EAgY41CwP,YAAa,6BAA8BtC,SAAUlC,EAAWlJ,aAAcA,YAA0B,SAAKya,EAAA,EAAoB7V,OAAOqB,OAAO,CAAEyU,KAAoB,aAAdvS,GAA0ByB,KAAM,OAAQ+Q,SAAU,IAAKxU,UAAW,6BAA+B,CAAEC,SAAUyT,MAAwC,SAAK,WAAW,CAAEzT,UAAU,SAAK,WAAgBxB,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,6BAA+B,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAED,UAAW,6BAA8B,SAAK,IAAK,CAAEC,SAAU,6BAAiC,CAAEA,UAAU,SAAKwU,EAAA,EAAehW,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,2BAA6B,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,oBAAqB,SAAK,IAAK,CAAEA,SAAU,mCAAoC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEI,QAAS,IAAM+S,GAAgB,QAASjT,UAAW,8BAAgC,CAAEC,SAAU,yBAA6B,CAAEA,SAAU,EAAA8V,kBAAoB,SAAKrL,EAAc,CAAE9G,MAAO6I,GAAkBuB,QAAStB,GAAoBC,aAAcA,GAAchK,eAAgByN,GAAoBxN,iBAAkBgO,GAAsBoE,gBAAiB/D,GAAqBtX,YAAayX,GAAiB4E,aAAcpE,GAAkB/X,aAAcA,KAAoB,SAAK8Q,EAAA,QAAiB,CAAE/G,MAAO6I,GAAkBuB,QAAStB,GAAoBC,aAAcA,GAAchK,eAAgByN,GAAoBxN,iBAAkBgO,GAAsBoE,gBAAiB/D,GAAqBtX,YAAayX,GAAiB4E,aAAcpE,GAAkB/X,aAAcA,aAAgC,SAAK,MAAO4E,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,UAAU,SAAK,IAAK,CAAEA,SAAU,oCAAwC,SAAKqU,EAAA,EAAoB7V,OAAOqB,OAAO,CAAEyU,KAAoB,aAAdvS,GAA0ByB,KAAM,OAAQ+Q,SAAU,IAAKxU,UAAW,6BAA+B,CAAEC,SAAUyT,MAAwC,SAAK,WAAW,CAAEzT,UAAU,SAAK,WAAgBxB,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,6BAA+B,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAED,UAAW,6BAA8B,SAAK,IAAK,CAAEC,SAAU,8BAAkC,CAAEA,UAAU,SAAKwU,EAAA,EAAehW,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,2BAA6B,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,qBAAsB,SAAK,IAAK,CAAEA,SAAU,iCAAkC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEI,QAAS,IAAM+S,GAAgB,QAASjT,UAAW,8BAAgC,CAAEC,SAAU,yBAA6B,CAAEA,SAAU,EAAA8V,kBAAoB,SAAKnL,EAAc,CAAEqL,aAAetd,IAE58Hsa,GAAgB,QAChBlH,GAAe,oCAAoCpT,EAAK6D,yBAA0B,OAAO,KACpF,SAAKqO,EAAA,QAAiB,CAAEoL,aAAetd,IAE5Csa,GAAgB,QAChBlH,GAAe,oCAAoCpT,EAAK6D,yBAA0B,OAAO,aACxE,SAAK,MAAOiC,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,UAAU,SAAK,IAAK,CAAEA,SAAU,qCAAyC,SAAKqU,EAAA,EAAoB7V,OAAOqB,OAAO,CAAEyU,KAAoB,UAAdvS,GAAuByB,KAAM,OAAQ+Q,SAAU,IAAKxU,UAAW,6BAA+B,CAAEC,SAAUyT,MAAwC,SAAK,WAAW,CAAEzT,UAAU,SAAK,WAAgBxB,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,6BAA+B,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAED,UAAW,6BAA8B,SAAK,IAAK,CAAEC,SAAU,mCAAuC,CAAEA,UAAU,SAAKwU,EAAA,EAAehW,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,2BAA6B,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,0BAA2B,SAAK,IAAK,CAAEA,SAAU,oCAAqC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEI,QAAS,IAAM+S,GAAgB,QAASjT,UAAW,8BAAgC,CAAEC,SAAU,yBAA6B,CAAEA,SAAU,EAAA8V,kBAAoB,SAAKjL,EAAkB,CAAEtR,QAAS,IAAMyZ,GAAgB,QAASiD,OAAQpD,GAAiBjZ,aAAcA,KAAoB,SAAKkR,EAAA,QAAqB,CAAEvR,QAAS,IAAMyZ,GAAgB,QAASiD,OAAQpD,GAAiBjZ,aAAcA,aAAgC,SAAK,MAAO4E,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,UAAU,SAAK,IAAK,CAAEA,SAAU,0CAA8C,SAAKqU,EAAA,EAAoB7V,OAAOqB,OAAO,CAAEyU,KAAoB,WAAdvS,GAAwByB,KAAM,OAAQ+Q,SAAU,IAAKxU,UAAW,6BAA+B,CAAEC,SAAUyT,MAAwC,SAAK,WAAW,CAAEzT,UAAU,SAAK,WAAgBxB,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,6BAA+B,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAED,UAAW,6BAA8B,SAAK,IAAK,CAAEC,SAAU,qCAAyC,CAAEA,UAAU,SAAKwU,EAAA,EAAehW,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,2BAA6B,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,4BAA6B,SAAK,IAAK,CAAEA,SAAU,sCAAuC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEI,QAAS,IAAM+S,GAAgB,QAASjT,UAAW,8BAAgC,CAAEC,SAAU,yBAA6B,CAAEA,SAAU,EAAA8V,kBAAoB,SAAK7K,EAAiB,CAAEtH,MAAO,GAAIjB,eAAgByN,GAAoB4E,gBAAiB/D,GAAqBtX,YAAayX,GAAiBvX,aAAcA,EAAcsc,YAAY,KAAY,SAAK,UAAoB,CAAEvS,MAAO,GAAIjB,eAAgByN,GAAoB4E,gBAAiB/D,GAAqBtX,YAAayX,GAAiBvX,aAAcA,EAAcsc,YAAY,aAAwB,SAAK,MAAO1X,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,UAAU,SAAK,IAAK,CAAEA,SAAU,4CAAgD,SAAKqU,EAAA,EAAoB7V,OAAOqB,OAAO,CAAEyU,KAAoB,aAAdvS,GAA0ByB,KAAM,OAAQ+Q,SAAU,IAAKxU,UAAW,6BAA+B,CAAEC,SAAUyT,MAAwC,SAAK,WAAW,CAAEzT,UAAU,SAAK,WAAgBxB,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,6BAA+B,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAED,UAAW,6BAA8B,SAAK,IAAK,CAAEC,SAAU,mCAAuC,CAAEA,UAAU,SAAKwU,EAAA,EAAehW,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,2BAA6B,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,0BAA2B,SAAK,IAAK,CAAEA,SAAU,oCAAqC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEI,QAAS,IAAM+S,GAAgB,QAASjT,UAAW,8BAAgC,CAAEC,SAAU,yBAA6B,CAAEA,SAAU,EAAA8V,kBAAoB,SAAK/K,EAAmB,CAAEG,OAAQA,EAAQrH,WAAYA,EAAYsH,OAAQA,EAAQzI,eAAgByN,GAAoB4E,gBAAiB/D,GAAqBtX,YAAayX,GAAiBvX,aAAcA,KAAoB,SAAKoR,EAAA,QAAsB,CAAEE,OAAQA,EAAQrH,WAAYA,EAAYsH,OAAQA,EAAQzI,eAAgByN,GAAoB4E,gBAAiB/D,GAAqBtX,YAAayX,GAAiBvX,aAAcA,aAAgC,SAAK,MAAO4E,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,UAAU,SAAK,IAAK,CAAEA,SAAU,sDAAwDmW,EAAiI1C,OAAyC,UAAM,WAAW,CAAEzT,SAAU,MAACmW,GAAsF,SAAK,WAAgB3X,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,6BAA+B,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAED,UAAW,6BAA8B,SAAK,IAAK,CAAEC,SAAU,mCAAuC,CAAEA,UAAU,UAAMoW,EAAAC,EAAsB7X,OAAOqB,OAAO,CAAEyW,eAAgB,4BAA6BC,YAAa,KAAsE,EAAEC,eAAgB,KAAuE,EAAEC,YAAc5R,IAAmF,GAAG,CAAE7E,SAAU,CAE1xK,KACL,EAAA8V,kBAAoB,SAAK7L,EAAgB,CAAEgM,OAAQpD,MAAuB,SAAKvI,EAAA,QAAmB,CAAE2L,OAAQpD,KAEvG,YAGZ,KACLjH,IAAkB,UAAM,WAAW,CAAE5L,SAAU,CAElC,MACL,SAAK,WAAgBxB,OAAOqB,OAAO,CAAE4U,UAAU,UAAM,MAAOjW,OAAOqB,OAAO,CAAEE,UAAW,6BAA+B,CAAEC,SAAU,EAAC,SAAK,MAAO,CAAED,UAAW,6BAA8B,SAAK,IAAK,CAAEC,SAAU,+BAAmC,CAAEA,UAAU,UAAMoW,EAAAC,EAAsB7X,OAAOqB,OAAO,CAAEyW,eAAgB,wBAAyBC,YAAa,KAA0E,EAAEC,eAAgB,KAA2E,EAAEC,YAAc5R,IAAuF,GAAG,CAAE7E,SAAU,CAE7mB,KACL,EAAA8V,kBAAoB,SAAKvL,EAAoB,CAAE3F,SAAUkN,GAAkBvY,QAAS,IAAMsS,GAAiB,GAAQjS,aAAcA,KAAoB,SAAK4Q,EAAA,QAAuB,CAAE5F,SAAUkN,GAAkBvY,QAAS,IAAMsS,GAAiB,GAAQjS,aAAcA,IAEhQ,qBAhExB,IAACqZ,EAiEwC,C,kFEjmCpE,ICpBA,EDEuB,EAAGhT,UAASrG,eAAcN,UAAS,EAAOod,cAC7D,MAAOC,EAAcC,IAAmB,IAAA7c,UAAS,cAWjD,IATA,IAAAC,YAAU,KAEF4c,EADAtd,EACgB,cAGA,aACpB,GACD,CAACA,IAEAA,EACA,OAAO,KAEX,MAAM2M,EAAcrM,EAAe,CAAEmH,gBAAiBnH,QAAiB4H,EACvE,OAAQ,SAAK,MAAOhD,OAAOqB,OAAO,CAAEE,UAAW,2BAA2B4W,IAAgB1W,QAASA,EAASvB,MAAOuH,EAAa,cAAe,0BAA2B,aAAc,wBAA0B,CAAEjG,SAAU0W,GAAW,SAAK,MAAO,CAAEvU,IAAKuU,EAAStU,IAAK,UAAWrC,UAAW,mCAAuC,SAAK,MAAOvB,OAAOqB,OAAO,CAAEE,UAAW,yCAA2C,CAAEC,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEK,MAAO,6BAA8BC,QAAS,YAAaC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,gBAAkB,CAAEN,UAAU,SAAK,OAAQ,CAAEO,EAAG,sNAA4N,C,wGEwC7yB,IC1DA,EDYkB,EAAGsW,SAAS,UAAWtd,UAAS6R,WAAW,QAAS0L,gBAAe,MAEjF,MAAOC,EAAcC,IAAmB,IAAAjd,UAASkd,EAAA,GAAUJ,KACpDK,EAAkBC,IAAuB,IAAApd,UAAS,IAClDmI,EAAakV,IAAkB,IAAArd,WAAS,IACxCsd,EAAWC,IAAgB,IAAAvd,WAAS,GAErCwd,EAAcR,EAAaS,MAAMN,GA8BvC,QAAK,UAAmBJ,IAInBO,GAGG,UAAM,MAAO7Y,OAAOqB,OAAO,CAAEE,UAAW,0CAA0CqL,KAAYlJ,EAAc,gCAAkC,MAAQ,CAAElC,SAAU,EAAC,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,8BAAgC,CAAEC,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,oCAAsC,CAAEC,SAAUkC,EAAc,aAAe6U,EAAazY,SAAU,UAAM,MAAOE,OAAOqB,OAAO,CAAEE,UAAW,uCAAyC,CAAEC,SAAU,EAAC,SAAK,SAAUxB,OAAOqB,OAAO,CAAEE,UAAW,kCAAmCE,QAlBjiB,KACnBmX,GAAgBlV,EAAY,EAiBijBR,MAAOQ,EAAc,SAAW,YAAc,CAAElC,SAAUkC,GAAe,SAAK,MAAO1D,OAAOqB,OAAO,CAAEM,QAAS,YAAaC,MAAO,KAAMC,OAAQ,MAAQ,CAAEL,UAAU,SAAK,OAAQ,CAAEM,KAAM,eAAgBC,EAAG,4BAAiC,SAAK,MAAO/B,OAAOqB,OAAO,CAAEM,QAAS,YAAaC,MAAO,KAAMC,OAAQ,MAAQ,CAAEL,UAAU,SAAK,OAAQ,CAAEM,KAAM,eAAgBC,EAAG,4BAAiChH,IAAY,SAAK,SAAUiF,OAAOqB,OAAO,CAAEE,UAAW,kCAAmCE,QAdviC,KAChBqX,GAAa,GACT/d,GACAA,GACJ,EAU6kCmI,MAAO,SAAW,CAAE1B,UAAU,SAAK,MAAOxB,OAAOqB,OAAO,CAAEM,QAAS,YAAaC,MAAO,KAAMC,OAAQ,MAAQ,CAAEL,UAAU,SAAK,OAAQ,CAAEM,KAAM,eAAgBC,EAAG,iIAAwI2B,IAAgB,UAAM,WAAW,CAAElC,SAAU,CAAC8W,IAAiB,UAAM,MAAOtY,OAAOqB,OAAO,CAAEE,UAAW,qCAAuC,CAAEC,SAAU,EAAC,SAAK,QAASxB,OAAOqB,OAAO,CAAE4X,QAAS,oBAAsB,CAAEzX,SAAU,iBAAkB,SAAK,SAAUxB,OAAOqB,OAAO,CAAEe,GAAI,mBAAoB7J,MAAO8f,EAAQxV,SAxB5pDnK,IACtB,MAAMwgB,EAAYxgB,EAAEuK,OAAO1K,MAC3BigB,EAAgBC,EAAA,GAAUS,IAC1BP,EAAoB,EAAE,GAqB0rD,CAAEnX,SAAUxB,OAAOC,QAAQwY,EAAA,IAAW9c,KAAI,EAAEyG,EAAI+W,MAAW,SAAK,SAAUnZ,OAAOqB,OAAO,CAAE9I,MAAO6J,GAAM,CAAEZ,SAAU2X,EAAKrZ,OAASsC,aAAiB,UAAM,MAAOpC,OAAOqB,OAAO,CAAEE,UAAW,+BAAiC,CAAEC,SAAU,EAAC,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,SAAU,EAAC,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,qCAAuC,CAAEC,SAAU,CAAC,QAASkX,EAAmB,EAAG,OAAQH,EAAaS,MAAM5c,YAAa,SAAK,MAAO4D,OAAOqB,OAAO,CAAEE,UAAW,oCAAsC,CAAEC,UAAU,SAAK,MAAO,CAAED,UAAW,yCAA0CrB,MAAO,CAAE0B,OAAY8W,EAAmB,GAAKH,EAAaS,MAAM5c,OAAU,IAA1D,eAAgF,UAAM,MAAO4D,OAAOqB,OAAO,CAAEE,UAAW,4BAA8B,CAAEC,SAAU,EAAC,SAAK,KAAMxB,OAAOqB,OAAO,CAAEE,UAAW,kCAAoC,CAAEC,SAAUuX,EAAY7V,UAAW,SAAK,IAAKlD,OAAOqB,OAAO,CAAEE,UAAW,wCAA0C,CAAEC,SAAUuX,EAAYhZ,gBAAiB,UAAM,MAAOC,OAAOqB,OAAO,CAAEE,UAAW,mCAAqC,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,aAAc,SAAK,IAAK,CAAEA,SAAUuX,EAAYK,cAAgB,UAAM,MAAOpZ,OAAOqB,OAAO,CAAEE,UAAW,oCAAsC,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,uBAAwB,SAAK,IAAK,CAAEA,SAAUuX,EAAYM,sBAAyBN,EAAYO,OAAS,UAAM,MAAOtZ,OAAOqB,OAAO,CAAEE,UAAW,iCAAmC,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,WAAY,SAAK,IAAK,CAAEA,SAAUuX,EAAYO,WAAeP,EAAYQ,iBAAmB,UAAM,MAAOvZ,OAAOqB,OAAO,CAAEE,UAAW,qCAAuC,CAAEC,SAAU,EAAC,SAAK,KAAM,CAAEA,SAAU,2BAA4B,SAAK,IAAK,CAAEA,SAAUuX,EAAYQ,0BAA8B,UAAM,MAAOvZ,OAAOqB,OAAO,CAAEE,UAAW,kCAAoC,CAAEC,SAAU,EAAC,UAAM,SAAUxB,OAAOqB,OAAO,CAAEE,UAAW,8BAA+BE,QA9BzpH,KACjBiX,EAAmB,GACnBC,EAAoBD,EAAmB,EAC3C,EA2BysHlS,SAA+B,IAArBkS,GAA0B,CAAElX,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEM,QAAS,YAAaC,MAAO,KAAMC,OAAQ,MAAQ,CAAEL,UAAU,SAAK,OAAQ,CAAEM,KAAM,eAAgBC,EAAG,+DAAkE,gBAAiB,UAAM,SAAU/B,OAAOqB,OAAO,CAAEE,UAAW,8BAA+BE,QAnCzgI,KACbiX,EAAmBH,EAAaS,MAAM5c,OAAS,GAC/Cuc,EAAoBD,EAAmB,EAC3C,EAgCijIlS,SAAUkS,IAAqBH,EAAaS,MAAM5c,OAAS,GAAK,CAAEoF,SAAU,CAAC,QAAQ,SAAK,MAAOxB,OAAOqB,OAAO,CAAEM,QAAS,YAAaC,MAAO,KAAMC,OAAQ,MAAQ,CAAEL,UAAU,SAAK,OAAQ,CAAEM,KAAM,eAAgBC,EAAG,uEAA4E,SAAK,MAAO/B,OAAOqB,OAAO,CAAEE,UAAW,8BAAgC,CAAEC,UAAU,UAAM,MAAOxB,OAAOqB,OAAO,CAAEE,UAAW,gCAAkC,CAAEC,SAAU,EAAC,SAAK,MAAOxB,OAAOqB,OAAO,CAAEM,QAAS,YAAaC,MAAO,KAAMC,OAAQ,MAAQ,CAAEL,UAAU,SAAK,OAAQ,CAAEM,KAAM,eAAgBC,EAAG,iMAAmM,SAAK,OAAQ,CAAEP,SAAU+W,EAAaxC,yBANp2J,IAMm4J,C","sources":["webpack://StylistWidget/./src/api/userApi.ts","webpack://StylistWidget/./src/components/CompleteLookModal/CompleteLookModal.tsx","webpack://StylistWidget/./src/components/CompleteLookModal/index.ts","webpack://StylistWidget/./src/components/CategorySelector/CategorySelector.tsx","webpack://StylistWidget/./src/components/CategorySelector/index.ts","webpack://StylistWidget/./src/components/ChatHeader/ChatHeader.tsx","webpack://StylistWidget/./src/components/ChatHeader/index.ts","webpack://StylistWidget/./src/components/ChatBody/ChatBody.tsx","webpack://StylistWidget/./src/components/ChatBody/index.ts","webpack://StylistWidget/./src/components/ChatInput/ChatImageUploader.tsx","webpack://StylistWidget/./src/components/ChatInput/ChatURLInput.tsx","webpack://StylistWidget/./src/components/ChatInput/ChatInput.tsx","webpack://StylistWidget/./src/components/ChatInput/index.ts","webpack://StylistWidget/./src/components/ChatWidget/ChatWidget.tsx","webpack://StylistWidget/./src/components/ChatWidget/index.ts","webpack://StylistWidget/./src/components/CircularSymbol/CircularSymbol.tsx","webpack://StylistWidget/./src/components/CircularSymbol/index.ts","webpack://StylistWidget/./src/components/DemoGuide/DemoGuide.tsx","webpack://StylistWidget/./src/components/DemoGuide/index.ts"],"sourcesContent":["// API client for user-related endpoints\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport class UserApi {\n    constructor(apiClient) {\n        this.client = apiClient;\n    }\n    // Get user profile\n    getUserProfile(userId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.get(`/api/v1/users/${userId}`);\n        });\n    }\n    // Create user profile (anonymous or with email)\n    createUser(email) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.post('/api/v1/users', { email });\n        });\n    }\n    // Update user preferences\n    updatePreferences(userId, preferences) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.put(`/api/v1/users/${userId}/preferences`, preferences);\n        });\n    }\n    // Get style quiz questions\n    getStyleQuiz() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.get('/api/v1/style-quiz');\n        });\n    }\n    // Submit style quiz answers\n    submitStyleQuiz(userId, answers) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.post(`/api/v1/users/${userId}/style-quiz`, { answers });\n        });\n    }\n    // Add item to user's closet\n    addClosetItem(userId, item) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.post(`/api/v1/users/${userId}/closet`, item);\n        });\n    }\n    // Remove item from user's closet\n    removeClosetItem(userId, itemId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.delete(`/api/v1/users/${userId}/closet/${itemId}`);\n        });\n    }\n    // Update closet item\n    updateClosetItem(userId, itemId, updates) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.put(`/api/v1/users/${userId}/closet/${itemId}`, updates);\n        });\n    }\n    // Mark item as favorite\n    toggleFavoriteItem(userId, itemId, favorite) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.client.put(`/api/v1/users/${userId}/closet/${itemId}/favorite`, { favorite });\n        });\n    }\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState, useEffect, useMemo } from 'react';\nimport './CompleteLookModal.scss';\nimport ItemCard from '../ItemCard/ItemCard';\n// Style coordination score ranges\nconst SCORE_RANGES = {\n    EXCELLENT: { min: 0.8, max: 1.0, label: 'Perfect Match' },\n    GOOD: { min: 0.6, max: 0.8, label: 'Great Pairing' },\n    FAIR: { min: 0.4, max: 0.6, label: 'Good Match' },\n    POOR: { min: 0.0, max: 0.4, label: 'Basic Match' }\n};\nconst CompleteLookModal = ({ isOpen, onClose, selectedItem, complementaryItems, onAddToCart, onAddAllToCart, primaryColor }) => {\n    const [selectedItems, setSelectedItems] = useState([]);\n    // Reset selected items when modal opens with new items\n    useEffect(() => {\n        if (isOpen) {\n            setSelectedItems([]);\n        }\n    }, [isOpen, selectedItem]);\n    if (!isOpen)\n        return null;\n    // Enhanced complementary items with style coordination scores\n    const enhancedComplementaryItems = useMemo(() => {\n        return complementaryItems.map(item => {\n            const coordination = calculateStyleCoordination(selectedItem, item);\n            return Object.assign(Object.assign({}, item), { styleCoordination: coordination });\n        }).sort((a, b) => {\n            var _a, _b;\n            // Sort by style coordination score (highest first)\n            return (((_a = b.styleCoordination) === null || _a === void 0 ? void 0 : _a.score) || 0) - (((_b = a.styleCoordination) === null || _b === void 0 ? void 0 : _b.score) || 0);\n        });\n    }, [complementaryItems, selectedItem]);\n    const toggleItemSelection = (itemId) => {\n        setSelectedItems(prev => prev.includes(itemId)\n            ? prev.filter(id => id !== itemId)\n            : [...prev, itemId]);\n    };\n    const handleAddAllToCart = () => {\n        const itemsToAdd = selectedItems.length > 0\n            ? selectedItems\n            : enhancedComplementaryItems.map(item => item.id);\n        onAddAllToCart(itemsToAdd);\n        onClose();\n    };\n    const getCategoryHeading = () => {\n        if (!selectedItem.category)\n            return 'Complete Your Look';\n        const category = selectedItem.category.toLowerCase();\n        if (['top', 'shirt', 'blouse', 'tshirt'].some(item => category.includes(item))) {\n            return 'Complete Your Look with Bottoms & Accessories';\n        }\n        else if (['bottom', 'pant', 'trouser', 'jean', 'skirt'].some(item => category.includes(item))) {\n            return 'Complete Your Look with Tops & Accessories';\n        }\n        else if (['dress'].some(item => category.includes(item))) {\n            return 'Complete Your Look with Shoes & Accessories';\n        }\n        else if (['shoe'].some(item => category.includes(item))) {\n            return 'Complete Your Look with Clothing & Accessories';\n        }\n        else if (['accessory', 'bag', 'jewelry'].some(item => category.includes(item))) {\n            return 'Complete Your Look with Clothing & Shoes';\n        }\n        return 'Complete Your Look';\n    };\n    /**\n     * Calculate style coordination between two items\n     * Returns a score and reasons for the match\n     */\n    function calculateStyleCoordination(baseItem, matchItem) {\n        const reasons = [];\n        // 1. Calculate color harmony (0-1)\n        const colorHarmony = calculateColorHarmony(baseItem, matchItem);\n        if (colorHarmony > 0.8) {\n            reasons.push('Excellent color harmony');\n        }\n        else if (colorHarmony > 0.6) {\n            reasons.push('Good color coordination');\n        }\n        // 2. Calculate category match (0-1)\n        const categoryMatch = calculateCategoryMatch(baseItem, matchItem);\n        if (categoryMatch > 0.9) {\n            reasons.push('Perfect category pairing');\n        }\n        else if (categoryMatch > 0.7) {\n            reasons.push('Complementary categories');\n        }\n        // 3. Calculate style consistency (0-1)\n        const styleConsistency = calculateStyleConsistency(baseItem, matchItem);\n        if (styleConsistency > 0.8) {\n            reasons.push('Consistent style aesthetic');\n        }\n        else if (styleConsistency > 0.6) {\n            reasons.push('Compatible styling');\n        }\n        // 4. Calculate overall score (weighted)\n        const overallScore = (colorHarmony * 0.4 +\n            categoryMatch * 0.35 +\n            styleConsistency * 0.25);\n        // 5. Add overall assessment\n        if (overallScore >= SCORE_RANGES.EXCELLENT.min) {\n            reasons.unshift(SCORE_RANGES.EXCELLENT.label);\n        }\n        else if (overallScore >= SCORE_RANGES.GOOD.min) {\n            reasons.unshift(SCORE_RANGES.GOOD.label);\n        }\n        else if (overallScore >= SCORE_RANGES.FAIR.min) {\n            reasons.unshift(SCORE_RANGES.FAIR.label);\n        }\n        else {\n            reasons.unshift(SCORE_RANGES.POOR.label);\n        }\n        return {\n            score: overallScore,\n            reasons,\n            colorHarmony,\n            categoryMatch,\n            styleConsistency\n        };\n    }\n    /**\n     * Calculate color harmony between two items\n     * Considers color theory principles like complementary, analogous, etc.\n     */\n    function calculateColorHarmony(item1, item2) {\n        // Default score if we can't determine colors\n        if (!item1.colors || !item2.colors ||\n            !item1.colors.length || !item2.colors.length) {\n            return 0.5;\n        }\n        // Normalize colors to lowercase\n        const colors1 = item1.colors.map(c => c.toLowerCase());\n        const colors2 = item2.colors.map(c => c.toLowerCase());\n        // Color families for harmony checks\n        const neutralColors = ['black', 'white', 'gray', 'grey', 'beige', 'tan', 'cream', 'ivory', 'silver'];\n        const warmColors = ['red', 'orange', 'yellow', 'pink', 'coral', 'peach', 'gold', 'brown', 'maroon', 'burgundy'];\n        const coolColors = ['blue', 'green', 'purple', 'violet', 'teal', 'turquoise', 'navy', 'mint', 'lavender'];\n        // Complementary color pairs that work well together\n        const complementaryPairs = [\n            ['blue', 'orange'], ['purple', 'yellow'], ['green', 'red'],\n            ['teal', 'coral'], ['navy', 'gold']\n        ];\n        // Check for exact color matches (monochromatic - highest harmony)\n        const exactMatches = colors1.filter(c => colors2.includes(c)).length;\n        if (exactMatches > 0) {\n            return 0.9; // High harmony for monochromatic scheme\n        }\n        // Check for neutrals (which go with everything)\n        const hasNeutral1 = colors1.some(c => neutralColors.includes(c));\n        const hasNeutral2 = colors2.some(c => neutralColors.includes(c));\n        if (hasNeutral1 || hasNeutral2) {\n            return 0.8; // Neutral + any color is safe\n        }\n        // Check for complementary colors (good contrast)\n        for (const color1 of colors1) {\n            for (const color2 of colors2) {\n                for (const [c1, c2] of complementaryPairs) {\n                    if ((color1.includes(c1) && color2.includes(c2)) ||\n                        (color1.includes(c2) && color2.includes(c1))) {\n                        return 0.85; // Complementary colors work well\n                    }\n                }\n            }\n        }\n        // Check if both are warm colors or both cool colors (analogous harmony)\n        const isWarm1 = colors1.some(c => warmColors.some(wc => c.includes(wc)));\n        const isWarm2 = colors2.some(c => warmColors.some(wc => c.includes(wc)));\n        const isCool1 = colors1.some(c => coolColors.some(cc => c.includes(cc)));\n        const isCool2 = colors2.some(c => coolColors.some(cc => c.includes(cc)));\n        if ((isWarm1 && isWarm2) || (isCool1 && isCool2)) {\n            return 0.75; // Analogous harmony (within same temperature)\n        }\n        // Warm with cool can still work but less harmonious\n        if ((isWarm1 && isCool2) || (isCool1 && isWarm2)) {\n            return 0.6; // Temperature contrast\n        }\n        // Default middling harmony if we can't determine specific relationship\n        return 0.5;\n    }\n    /**\n     * Calculate if categories work well together in an outfit\n     */\n    function calculateCategoryMatch(item1, item2) {\n        if (!item1.category || !item2.category)\n            return 0.5;\n        const cat1 = item1.category.toLowerCase();\n        const cat2 = item2.category.toLowerCase();\n        // Perfect pairs that complete outfits\n        const idealPairs = [\n            ['top', 'bottom'], ['shirt', 'pant'], ['shirt', 'skirt'],\n            ['blouse', 'pant'], ['blouse', 'skirt'], ['top', 'jean'],\n            ['dress', 'jacket'], ['dress', 'shoe'], ['dress', 'accessory'],\n            ['outfit', 'accessory'], ['outfit', 'shoe'], ['top', 'accessory'],\n            ['bottom', 'accessory'], ['shoe', 'bag']\n        ];\n        // Check for perfect category pairings\n        for (const [c1, c2] of idealPairs) {\n            if ((cat1.includes(c1) && cat2.includes(c2)) ||\n                (cat1.includes(c2) && cat2.includes(c1))) {\n                return 1.0;\n            }\n        }\n        // Define category groups\n        const topGroup = ['top', 'shirt', 'blouse', 'tee', 't-shirt', 'sweater'];\n        const bottomGroup = ['bottom', 'pant', 'skirt', 'jean', 'trouser', 'legging', 'short'];\n        const dressGroup = ['dress', 'gown', 'jumpsuit'];\n        const outerGroup = ['jacket', 'coat', 'blazer', 'cardigan'];\n        const accessoryGroup = ['accessory', 'jewelry', 'scarf', 'hat', 'belt'];\n        const footwearGroup = ['shoe', 'boot', 'sneaker', 'heel', 'sandal'];\n        const bagGroup = ['bag', 'handbag', 'purse', 'backpack', 'tote'];\n        // Check if items are in the same category (less desirable for completing a look)\n        const getCategory = (cat) => {\n            if (topGroup.some(c => cat.includes(c)))\n                return 'top';\n            if (bottomGroup.some(c => cat.includes(c)))\n                return 'bottom';\n            if (dressGroup.some(c => cat.includes(c)))\n                return 'dress';\n            if (outerGroup.some(c => cat.includes(c)))\n                return 'outer';\n            if (accessoryGroup.some(c => cat.includes(c)))\n                return 'accessory';\n            if (footwearGroup.some(c => cat.includes(c)))\n                return 'footwear';\n            if (bagGroup.some(c => cat.includes(c)))\n                return 'bag';\n            return 'unknown';\n        };\n        const category1 = getCategory(cat1);\n        const category2 = getCategory(cat2);\n        // Same category is not ideal for completing a look except for accessories\n        if (category1 === category2) {\n            if (category1 === 'accessory')\n                return 0.7; // Multiple accessories can work\n            return 0.3; // Same category not ideal (e.g. two tops)\n        }\n        // Good pairings that aren't represented in idealPairs\n        if ((category1 === 'top' && category2 === 'outer') ||\n            (category1 === 'outer' && category2 === 'top') ||\n            (category1 === 'bottom' && category2 === 'footwear') ||\n            (category1 === 'footwear' && category2 === 'bottom')) {\n            return 0.9;\n        }\n        // Other combinations work reasonably well\n        return 0.7;\n    }\n    /**\n     * Calculate style consistency between items (casual, formal, etc.)\n     */\n    function calculateStyleConsistency(item1, item2) {\n        var _a, _b, _c, _d;\n        // Style signals we can extract from product data\n        const styleSignals = {\n            casual: ['casual', 'relax', 'everyday', 'basic', 'tee', 't-shirt', 'jeans', 'denim', 'cotton', 'jersey', 'lounge', 'hoodie', 'sweatshirt', 'sneaker'],\n            formal: ['formal', 'elegant', 'business', 'suit', 'blazer', 'office', 'professional', 'dress shoe', 'oxford', 'sophisticated'],\n            athletic: ['sport', 'active', 'workout', 'athleisure', 'running', 'training', 'gym', 'performance', 'stretch', 'technical'],\n            evening: ['evening', 'party', 'cocktail', 'gown', 'sequin', 'glitter', 'statement', 'special occasion'],\n            bohemian: ['boho', 'bohemian', 'relaxed', 'earthy', 'flowy', 'natural', 'ethnic', 'artisan', 'fringe'],\n            minimalist: ['minimal', 'clean', 'simple', 'modern', 'sleek', 'essential', 'basic', 'streamlined'],\n            vintage: ['vintage', 'retro', 'classic', 'nostalgic', 'timeless', 'heritage']\n        };\n        // Function to detect style signals in item text\n        const detectStyles = (item) => {\n            const itemText = `${item.name || ''} ${item.description || ''}`.toLowerCase();\n            return Object.entries(styleSignals).map(([style, keywords]) => {\n                // Count how many style keywords are found\n                const matches = keywords.filter(keyword => itemText.includes(keyword)).length;\n                const score = matches > 0 ? matches / keywords.length : 0;\n                return { style, score };\n            }).filter(result => result.score > 0)\n                .sort((a, b) => b.score - a.score);\n        };\n        const styles1 = detectStyles(item1);\n        const styles2 = detectStyles(item2);\n        // If no style signals detected, default to medium consistency\n        if (styles1.length === 0 || styles2.length === 0) {\n            return 0.5;\n        }\n        // Check if primary style matches\n        if (((_a = styles1[0]) === null || _a === void 0 ? void 0 : _a.style) === ((_b = styles2[0]) === null || _b === void 0 ? void 0 : _b.style)) {\n            return 0.9; // High consistency when primary styles match\n        }\n        // Check for any overlapping styles\n        const overlappingStyles = styles1.filter(s1 => styles2.some(s2 => s2.style === s1.style));\n        if (overlappingStyles.length > 0) {\n            return 0.7; // Some style consistency\n        }\n        // Certain style combinations can still work well together\n        const compatibleStylePairs = [\n            ['casual', 'athletic'],\n            ['casual', 'minimalist'],\n            ['casual', 'bohemian'],\n            ['formal', 'minimalist'],\n            ['minimalist', 'evening'],\n            ['vintage', 'bohemian']\n        ];\n        const primaryStyle1 = (_c = styles1[0]) === null || _c === void 0 ? void 0 : _c.style;\n        const primaryStyle2 = (_d = styles2[0]) === null || _d === void 0 ? void 0 : _d.style;\n        if (primaryStyle1 && primaryStyle2) {\n            for (const [s1, s2] of compatibleStylePairs) {\n                if ((primaryStyle1 === s1 && primaryStyle2 === s2) ||\n                    (primaryStyle1 === s2 && primaryStyle2 === s1)) {\n                    return 0.65; // Compatible styles\n                }\n            }\n        }\n        // Default - some inconsistency, but could still work\n        return 0.4;\n    }\n    return (_jsxs(\"div\", Object.assign({ className: \"stylist-complete-look-modal\" }, { children: [_jsx(\"div\", { className: \"stylist-complete-look-modal__backdrop\", onClick: onClose }), _jsxs(\"div\", Object.assign({ className: \"stylist-complete-look-modal__content\" }, { children: [_jsx(\"button\", Object.assign({ className: \"stylist-complete-look-modal__close\", onClick: onClose }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" }) })) })), _jsxs(\"div\", Object.assign({ className: \"stylist-complete-look-modal__header\" }, { children: [_jsx(\"h3\", Object.assign({ className: \"stylist-complete-look-modal__title\", style: { color: primaryColor } }, { children: getCategoryHeading() })), _jsxs(\"p\", Object.assign({ className: \"stylist-complete-look-modal__subtitle\" }, { children: [\"We found these items that go perfectly with your \", selectedItem.name] }))] })), _jsx(\"div\", Object.assign({ className: \"stylist-complete-look-modal__selected-item\" }, { children: _jsx(ItemCard, { item: selectedItem, onAddToCart: onAddToCart, primaryColor: primaryColor }) })), _jsx(\"div\", Object.assign({ className: \"stylist-complete-look-modal__complementary-items\" }, { children: enhancedComplementaryItems.map(item => {\n                            const coordination = item.styleCoordination;\n                            const matchBadgeColor = (coordination === null || coordination === void 0 ? void 0 : coordination.score) >= SCORE_RANGES.EXCELLENT.min ? '#2C9E3F' :\n                                (coordination === null || coordination === void 0 ? void 0 : coordination.score) >= SCORE_RANGES.GOOD.min ? '#4C8BF5' :\n                                    (coordination === null || coordination === void 0 ? void 0 : coordination.score) >= SCORE_RANGES.FAIR.min ? '#F5A623' : '#9B9B9B';\n                            return (_jsxs(\"div\", Object.assign({ className: `stylist-complete-look-modal__item ${selectedItems.includes(item.id) ? 'stylist-complete-look-modal__item--selected' : ''}`, onClick: () => toggleItemSelection(item.id) }, { children: [coordination && (_jsxs(\"div\", Object.assign({ className: \"stylist-complete-look-modal__match-badge\", style: { backgroundColor: matchBadgeColor } }, { children: [Math.round(coordination.score * 100), \"% Match\"] }))), _jsx(ItemCard, { item: item, onAddToCart: onAddToCart, primaryColor: primaryColor }), coordination && (_jsxs(\"div\", Object.assign({ className: \"stylist-complete-look-modal__style-details\" }, { children: [_jsx(\"div\", Object.assign({ className: \"stylist-complete-look-modal__style-reason\" }, { children: coordination.reasons[0] })), _jsxs(\"div\", Object.assign({ className: \"stylist-complete-look-modal__style-metrics\" }, { children: [_jsxs(\"div\", Object.assign({ className: \"stylist-complete-look-modal__style-metric\" }, { children: [_jsx(\"span\", { children: \"Color: \" }), _jsx(\"span\", Object.assign({ className: \"stylist-complete-look-modal__metric-bar\" }, { children: _jsx(\"span\", { className: \"stylist-complete-look-modal__metric-fill\", style: { width: `${coordination.colorHarmony * 100}%`, backgroundColor: matchBadgeColor } }) }))] })), _jsxs(\"div\", Object.assign({ className: \"stylist-complete-look-modal__style-metric\" }, { children: [_jsx(\"span\", { children: \"Category: \" }), _jsx(\"span\", Object.assign({ className: \"stylist-complete-look-modal__metric-bar\" }, { children: _jsx(\"span\", { className: \"stylist-complete-look-modal__metric-fill\", style: { width: `${coordination.categoryMatch * 100}%`, backgroundColor: matchBadgeColor } }) }))] }))] }))] }))), _jsx(\"div\", Object.assign({ className: \"stylist-complete-look-modal__item-select\" }, { children: _jsx(\"div\", Object.assign({ className: \"stylist-complete-look-modal__checkbox\" }, { children: selectedItems.includes(item.id) && (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"16\", height: \"16\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\" }) }))) })) }))] }), item.id));\n                        }) })), _jsx(\"div\", Object.assign({ className: \"stylist-complete-look-modal__actions\" }, { children: _jsxs(\"button\", Object.assign({ className: \"stylist-complete-look-modal__add-all\", onClick: handleAddAllToCart, style: { backgroundColor: primaryColor } }, { children: [_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"20\", height: \"20\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M11 9h2V6h3V4h-3V1h-2v3H8v2h3v3zm-4 9c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2zm-9.83-3.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.86-7.01L19.42 4h-.01l-1.1 2-2.76 5H8.53l-.13-.27L6.16 6l-.95-2-.94-2H1v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.13 0-.25-.11-.25-.25z\" }) })), \"Add \", selectedItems.length > 0 ? 'Selected' : 'All', \" To Cart\"] })) }))] }))] })));\n};\nexport default CompleteLookModal;\n","import CompleteLookModal from './CompleteLookModal';\nexport default CompleteLookModal;\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport './CategorySelector.scss';\nconst CategorySelector = ({ categories, selectedCategory, onChange, includeAll = true, label = 'Category', primaryColor }) => {\n    // Custom style for dropdown focus state\n    const focusStyle = primaryColor ? { '--stylist-focus-color': primaryColor } : undefined;\n    return (_jsxs(\"div\", Object.assign({ className: \"stylist-category-selector\", style: focusStyle }, { children: [label && (_jsx(\"label\", Object.assign({ className: \"stylist-category-selector__label\" }, { children: label }))), _jsxs(\"select\", Object.assign({ className: \"stylist-category-selector__select\", value: selectedCategory, onChange: (e) => onChange(e.target.value), \"aria-label\": label }, { children: [includeAll && (_jsx(\"option\", Object.assign({ value: \"all\" }, { children: \"All Categories\" }))), categories.map(category => (_jsx(\"option\", Object.assign({ value: category.id }, { children: category.name }), category.id)))] })), _jsx(\"div\", Object.assign({ className: \"stylist-category-selector__arrow\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"18\", height: \"18\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M7 10l5 5 5-5z\" }) })) }))] })));\n};\nexport default CategorySelector;\n","import CategorySelector from './CategorySelector';\nexport default CategorySelector;\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport './ChatHeader.scss';\nimport { useChatStore } from '@store/index';\nimport WishlistNotification from '@/components/WishlistNotification';\nimport { DemoModeToggle } from '@/utils/demoModeToggle';\nconst ChatHeader = ({ title = 'The Stylist', logo, primaryColor, currentView = 'chat', onSwitchView, showDemoToggle = false, activeTab = 'chat' }) => {\n    const { toggleMinimize, toggleOpen, isMinimized } = useChatStore();\n    // Function to get appropriate icon for the current tab\n    const getIconForTab = (tab) => {\n        switch (tab) {\n            case 'chat':\n                return (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M12 1a9 9 0 019 9c0 4.56-3.37 8.33-7.76 8.95l-.19-.47a7.99 7.99 0 002.93-10.57A8.02 8.02 0 004.06 13.1A9 9 0 0112 1zm7.12 13.93l.37.37-.36.36.01-.73zm1.36-1.55a2.83 2.83 0 00-.5-.31l.36-.74c.28.12.54.29.78.48l-.64.57zm-14.81.19l.36.73c-.29.16-.57.35-.8.57l-.57-.64c.31-.3.65-.54 1.01-.66zM6.66 22l1.93-3.1c-.47-.55-.85-1.16-1.14-1.8L2.8 19.13V22h3.86zm10.46-2.91L19 21.99v-2.86l-1.14-.93c.12-.39.19-.8.19-1.22l.08-.04A8.96 8.96 0 0022 10 10 10 0 002 10a9 9 0 003.34 7.03L1.94 20.5A1 1 0 002.86 22h16.28a1 1 0 00.92-1.5l-2.94-3.41z\" }) })));\n            case 'lookbook':\n                return (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-3 2v5l-1-.75L15 9V4h2zm3 12H8V4h5v9l3-2.25L19 13V4h1v12z\" }) })));\n            case 'myCloset':\n                return (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M21 4H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H3V6h9v12h9zM8 1.5v3h8v-3h-8zM9 17h2V7H9zm4 0h2V7h-2z\" }) })));\n            case 'tryOn':\n                return (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M12 6c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm8 12v-9.5C20 4.58 16.42 1 12 1S4 4.58 4 8.5V18c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-6-10.5c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5S11.17 6 12 6s1.5.67 1.5 1.5zM6 18v-6h.5c.28 0 .5.22.5.5v5c0 .28-.22.5-.5.5H6zm3.5 0v-6.5c0-.28.22-.5.5-.5s.5.22.5.5V18h-1zm3.5 0v-6h.5c.28 0 .5.22.5.5v5c0 .28-.22.5-.5.5H13zm4 0v-5.5c0-.28.22-.5.5-.5s.5.22.5.5V18h-1z\" }) })));\n            case 'social':\n                return (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z\" }) })));\n            case 'trending':\n                return (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M16.85 6.85l1.44 1.44-4.88 4.88-3.29-3.29c-.39-.39-1.02-.39-1.41 0l-6 6.01c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L9.41 12l3.29 3.29c.39.39 1.02.39 1.41 0l5.59-5.58 1.44 1.44c.31.31.85.09.85-.35V6.5c.01-.28-.21-.5-.49-.5h-4.29c-.45 0-.67.54-.36.85z\" }) })));\n            default:\n                return (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M12 1a9 9 0 019 9c0 4.56-3.37 8.33-7.76 8.95l-.19-.47a7.99 7.99 0 002.93-10.57A8.02 8.02 0 004.06 13.1A9 9 0 0112 1z\" }) })));\n        }\n    };\n    const handleMinimize = () => {\n        toggleMinimize();\n    };\n    const handleClose = () => {\n        toggleOpen();\n    };\n    const handleSwitchView = () => {\n        if (onSwitchView) {\n            onSwitchView(currentView === 'chat' ? 'lookbook' : 'chat');\n        }\n    };\n    return (_jsxs(\"div\", Object.assign({ className: \"stylist-chat-header\", style: { backgroundColor: primaryColor } }, { children: [_jsx(\"div\", Object.assign({ className: \"stylist-chat-header__logo\" }, { children: logo ? (_jsx(\"img\", { src: logo, alt: title, className: \"stylist-chat-header__logo-img\" })) : (_jsx(\"div\", Object.assign({ className: \"stylist-chat-header__logo-placeholder\" }, { children: getIconForTab(activeTab) }))) })), _jsx(\"div\", Object.assign({ className: \"stylist-chat-header__title\" }, { children: title })), _jsxs(\"div\", Object.assign({ className: \"stylist-chat-header__controls\" }, { children: [showDemoToggle && (_jsx(\"div\", Object.assign({ className: \"stylist-chat-header__demo-toggle\" }, { children: _jsx(DemoModeToggle, {}) }))), !isMinimized && (_jsx(WishlistNotification, { onClickNotification: () => {\n                            if (onSwitchView) {\n                                // Switch to lookbook first, then to wishlist tab\n                                if (currentView !== 'lookbook') {\n                                    onSwitchView('lookbook');\n                                }\n                                // Set wishlist tab as active\n                                // This would require connecting to the Lookbook component,\n                                // which is beyond the scope of this inline edit\n                                // We could use a global event or store for this\n                                // For demonstration, we'll just log this action\n                                console.log('Switch to wishlist tab');\n                            }\n                        } })), onSwitchView && !isMinimized && activeTab !== 'chat' && (_jsx(\"button\", Object.assign({ className: \"stylist-chat-header__button stylist-chat-header__button--switch\", onClick: () => onSwitchView('chat'), \"aria-label\": \"Return to Chat\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"18\", height: \"18\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z\" }) })) }))), _jsx(\"button\", Object.assign({ className: \"stylist-chat-header__button stylist-chat-header__button--minimize\", onClick: handleMinimize, \"aria-label\": isMinimized ? \"Maximize\" : \"Minimize\" }, { children: isMinimized ? (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"18\", height: \"18\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\" }) }))) : (_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"18\", height: \"18\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M19 13H5v-2h14v2z\" }) }))) })), _jsx(\"button\", Object.assign({ className: \"stylist-chat-header__button stylist-chat-header__button--close\", onClick: handleClose, \"aria-label\": \"Close\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"18\", height: \"18\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z\" }) })) }))] }))] })));\n};\nexport default ChatHeader;\n","import ChatHeader from './ChatHeader';\nexport default ChatHeader;\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\n// Chat body component - displays messages\nimport { useRef, useEffect } from 'react';\nimport './ChatBody.scss';\nimport MessageBubble from '@/components/MessageBubble';\nimport ItemCard from '@/components/ItemCard';\nimport OutfitDisplay from '@/components/OutfitDisplay';\nimport StyleQuiz from '@/components/StyleQuiz';\nconst ChatBody = ({ messages, onItemFeedback, onOutfitFeedback, onMessageFeedback, onQuizSubmit, isLoading = false, primaryColor }) => {\n    const messagesEndRef = useRef(null);\n    const scrollContainerRef = useRef(null);\n    // Auto-scroll to bottom on new messages\n    useEffect(() => {\n        scrollToBottom();\n    }, [messages]);\n    const scrollToBottom = () => {\n        if (messagesEndRef.current) {\n            messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n        }\n    };\n    // Render a message based on its type\n    const renderMessage = (message) => {\n        switch (message.type) {\n            case 'text':\n                return (_jsx(MessageBubble, { message: message, primaryColor: primaryColor, onFeedback: onMessageFeedback }, message.id));\n            case 'recommendation':\n                return (_jsxs(\"div\", Object.assign({ className: \"stylist-chat-body__recommendation\" }, { children: [_jsx(\"div\", Object.assign({ className: \"stylist-chat-body__recommendation-title\" }, { children: \"Here are some recommendations for you:\" })), _jsx(\"div\", Object.assign({ className: \"stylist-chat-body__recommendation-items\" }, { children: message.items.map((item) => {\n                                // Convert Chat.RecommendationItem to Recommendation.RecommendationItem\n                                const recommendationItem = {\n                                    id: item.id,\n                                    retailerId: 'default',\n                                    name: item.name,\n                                    brand: item.brand,\n                                    category: item.category,\n                                    price: item.price,\n                                    salePrice: item.salePrice,\n                                    colors: [],\n                                    sizes: [],\n                                    imageUrls: [item.imageUrl],\n                                    url: item.url,\n                                    matchScore: item.matchScore,\n                                    matchReasons: item.matchReasons,\n                                    inStock: true\n                                };\n                                return (_jsx(ItemCard, { item: recommendationItem, onFeedback: onItemFeedback, primaryColor: primaryColor }, item.id));\n                            }) }))] }), message.id));\n            case 'outfit':\n                return (_jsx(OutfitDisplay, { outfit: message.outfit, onFeedback: onOutfitFeedback, primaryColor: primaryColor }, message.id));\n            case 'quiz':\n                return (_jsx(StyleQuiz, { quizId: message.quizId, title: message.title, description: message.description, onSubmit: onQuizSubmit || (() => { }), primaryColor: primaryColor }, message.id));\n            case 'loading':\n                return (_jsx(\"div\", Object.assign({ className: \"stylist-chat-body__loading\" }, { children: _jsxs(\"div\", Object.assign({ className: \"stylist-chat-body__loading-dots\" }, { children: [_jsx(\"span\", {}), _jsx(\"span\", {}), _jsx(\"span\", {})] })) }), message.id));\n            case 'error':\n                return (_jsxs(\"div\", Object.assign({ className: \"stylist-chat-body__error\" }, { children: [_jsx(\"div\", Object.assign({ className: \"stylist-chat-body__error-icon\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\" }) })) })), _jsx(\"div\", Object.assign({ className: \"stylist-chat-body__error-message\" }, { children: message.error }))] }), message.id));\n            default:\n                return null;\n        }\n    };\n    return (_jsx(\"div\", Object.assign({ className: \"stylist-chat-body\", ref: scrollContainerRef }, { children: _jsxs(\"div\", Object.assign({ className: \"stylist-chat-body__messages\" }, { children: [messages.map((message) => renderMessage(message)), isLoading && (_jsx(\"div\", Object.assign({ className: \"stylist-chat-body__loading\" }, { children: _jsxs(\"div\", Object.assign({ className: \"stylist-chat-body__loading-dots\" }, { children: [_jsx(\"span\", {}), _jsx(\"span\", {}), _jsx(\"span\", {})] })) }))), _jsx(\"div\", { ref: messagesEndRef })] })) })));\n};\nexport default ChatBody;\n","import ChatBody from './ChatBody';\nexport default ChatBody;\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\n// ChatImageUploader.tsx - Component for uploading images to find similar items\nimport { useState, useRef } from 'react';\nimport './ChatImageUploader.scss';\nconst ChatImageUploader = ({ onImageUpload, primaryColor, disabled = false }) => {\n    const [isDragging, setIsDragging] = useState(false);\n    const [preview, setPreview] = useState(null);\n    const fileInputRef = useRef(null);\n    // Handle drag events\n    const handleDragEnter = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (!disabled)\n            setIsDragging(true);\n    };\n    const handleDragLeave = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsDragging(false);\n    };\n    const handleDragOver = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (!disabled)\n            setIsDragging(true);\n    };\n    const handleDrop = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsDragging(false);\n        if (disabled)\n            return;\n        const files = e.dataTransfer.files;\n        handleFiles(files);\n    };\n    // Handle selected files\n    const handleFiles = (files) => {\n        if (files.length > 0) {\n            const file = files[0];\n            // Check if file is an image\n            if (!file.type.match('image.*')) {\n                alert('Please select an image file (png, jpg, jpeg)');\n                return;\n            }\n            // Create preview\n            const reader = new FileReader();\n            reader.onload = () => {\n                setPreview(reader.result);\n            };\n            reader.readAsDataURL(file);\n            // Call the callback\n            onImageUpload(file);\n        }\n    };\n    // Handle button click to open file browser\n    const handleButtonClick = () => {\n        if (!disabled && fileInputRef.current) {\n            fileInputRef.current.click();\n        }\n    };\n    // Handle file selection from input\n    const handleFileChange = (e) => {\n        const files = e.target.files;\n        if (files) {\n            handleFiles(files);\n        }\n    };\n    // Handle removing the preview/canceling\n    const handleRemovePreview = (e) => {\n        e.stopPropagation();\n        setPreview(null);\n        if (fileInputRef.current) {\n            fileInputRef.current.value = '';\n        }\n    };\n    const uploaderStyle = {\n        borderColor: isDragging ? (primaryColor || '#4361ee') : undefined,\n        backgroundColor: isDragging ? `${primaryColor || '#4361ee'}11` : undefined,\n    };\n    const buttonStyle = {\n        backgroundColor: primaryColor || undefined\n    };\n    return (_jsxs(\"div\", Object.assign({ className: `stylist-chat-image-uploader ${isDragging ? 'dragging' : ''} ${disabled ? 'disabled' : ''}`, onDragEnter: handleDragEnter, onDragLeave: handleDragLeave, onDragOver: handleDragOver, onDrop: handleDrop, onClick: handleButtonClick, style: uploaderStyle }, { children: [_jsx(\"input\", { type: \"file\", ref: fileInputRef, className: \"stylist-chat-image-uploader__input\", accept: \"image/*\", onChange: handleFileChange, disabled: disabled }), preview ? (_jsxs(\"div\", Object.assign({ className: \"stylist-chat-image-uploader__preview\" }, { children: [_jsx(\"img\", { src: preview, alt: \"Preview\", className: \"stylist-chat-image-uploader__preview-image\" }), _jsx(\"button\", Object.assign({ className: \"stylist-chat-image-uploader__remove-button\", onClick: handleRemovePreview, \"aria-label\": \"Remove image\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"16\", height: \"16\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" }) })) }))] }))) : (_jsxs(\"div\", Object.assign({ className: \"stylist-chat-image-uploader__content\" }, { children: [_jsx(\"div\", Object.assign({ className: \"stylist-chat-image-uploader__icon\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2h-3zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-8h-5zM5 19l3-4 2 3 3-4 4 5H5z\" }) })) })), _jsxs(\"div\", Object.assign({ className: \"stylist-chat-image-uploader__text\" }, { children: [_jsx(\"p\", { children: \"Drag & drop an image or click to browse\" }), _jsx(\"small\", { children: \"Find clothing similar to the image\" })] }))] }))), !preview && (_jsx(\"button\", Object.assign({ className: \"stylist-chat-image-uploader__button\", style: buttonStyle, disabled: disabled }, { children: \"Upload Image\" })))] })));\n};\nexport default ChatImageUploader;\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\n// ChatURLInput.tsx - Component for entering product URLs for specific product lookup\nimport { useState } from 'react';\nimport './ChatURLInput.scss';\nconst ChatURLInput = ({ onURLSubmit, primaryColor, disabled = false }) => {\n    const [url, setUrl] = useState('');\n    const [isValid, setIsValid] = useState(true);\n    const [errorMessage, setErrorMessage] = useState('');\n    // Handle input change\n    const handleChange = (e) => {\n        const value = e.target.value;\n        setUrl(value);\n        // Basic validation - clear error when typing\n        if (!isValid) {\n            setIsValid(true);\n            setErrorMessage('');\n        }\n    };\n    // Validate URL\n    const validateURL = (url) => {\n        try {\n            // Check if it's a valid URL\n            new URL(url);\n            return true;\n        }\n        catch (e) {\n            setErrorMessage('Please enter a valid URL');\n            return false;\n        }\n    };\n    // Handle URL submission\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        if (disabled)\n            return;\n        const trimmedUrl = url.trim();\n        if (!trimmedUrl) {\n            setIsValid(false);\n            setErrorMessage('Please enter a URL');\n            return;\n        }\n        if (!validateURL(trimmedUrl)) {\n            setIsValid(false);\n            return;\n        }\n        // Call the callback with the validated URL\n        onURLSubmit(trimmedUrl);\n        // Clear the input\n        setUrl('');\n    };\n    // Style objects for theming\n    const submitButtonStyle = {\n        backgroundColor: primaryColor || undefined\n    };\n    return (_jsxs(\"div\", Object.assign({ className: `stylist-chat-url-input ${disabled ? 'disabled' : ''}` }, { children: [_jsxs(\"div\", Object.assign({ className: \"stylist-chat-url-input__header\" }, { children: [_jsx(\"div\", Object.assign({ className: \"stylist-chat-url-input__icon\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"20\", height: \"20\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\" }) })) })), _jsx(\"h3\", Object.assign({ className: \"stylist-chat-url-input__title\" }, { children: \"Find a specific product\" }))] })), _jsxs(\"form\", Object.assign({ className: \"stylist-chat-url-input__form\", onSubmit: handleSubmit }, { children: [_jsxs(\"div\", Object.assign({ className: \"stylist-chat-url-input__input-container\" }, { children: [_jsx(\"input\", { type: \"text\", className: `stylist-chat-url-input__input ${!isValid ? 'error' : ''}`, value: url, onChange: handleChange, placeholder: \"Enter product URL (e.g. https://store.com/product)\", disabled: disabled }), !isValid && (_jsx(\"div\", Object.assign({ className: \"stylist-chat-url-input__error\" }, { children: errorMessage })))] })), _jsxs(\"button\", Object.assign({ type: \"submit\", className: \"stylist-chat-url-input__submit\", disabled: disabled || url.trim() === '', style: submitButtonStyle, \"aria-label\": \"Submit URL\" }, { children: [_jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"20\", height: \"20\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\" }) })), \"Find Product\"] }))] })), _jsx(\"div\", Object.assign({ className: \"stylist-chat-url-input__info\" }, { children: _jsx(\"p\", { children: \"Paste a link to a specific clothing item to get detailed information and styling suggestions for that product.\" }) }))] })));\n};\nexport default ChatURLInput;\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\n// Enhanced Chat input component with additional input methods\nimport { useState, useRef, useEffect } from 'react';\nimport './ChatInput.scss';\nimport { useChatStore } from '@/store/index';\n// Import new components\nimport ChatImageUploader from './ChatImageUploader';\nimport ChatURLInput from './ChatURLInput';\nconst ChatInput = ({ onSendMessage, onImageUpload, onURLSubmit, onVoiceInput, placeholder = 'Type a message...', disabled = false, primaryColor }) => {\n    const [message, setMessage] = useState('');\n    const [showImageUploader, setShowImageUploader] = useState(false);\n    const [showURLInput, setShowURLInput] = useState(false);\n    const [isListening, setIsListening] = useState(false);\n    const inputRef = useRef(null);\n    const { isLoading } = useChatStore();\n    // SpeechRecognition setup\n    const speechRecognition = useRef(null);\n    // Initialize speech recognition when component mounts\n    useEffect(() => {\n        // Check if browser supports SpeechRecognition\n        if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {\n            const SpeechRecognitionAPI = window.SpeechRecognition || window.webkitSpeechRecognition;\n            speechRecognition.current = new SpeechRecognitionAPI();\n            if (speechRecognition.current) {\n                // Configure speech recognition\n                speechRecognition.current.continuous = false;\n                speechRecognition.current.interimResults = true;\n                speechRecognition.current.lang = 'en-US';\n                // Set up event handlers\n                speechRecognition.current.onresult = (event) => {\n                    const transcript = Array.from(Array.from({ length: event.results.length }, (_, i) => event.results[i]))\n                        .map(result => { var _a; return ((_a = result[0]) === null || _a === void 0 ? void 0 : _a.transcript) || ''; })\n                        .join('');\n                    setMessage(prev => (prev + ' ' + transcript).trim());\n                };\n                speechRecognition.current.onend = () => {\n                    setIsListening(false);\n                };\n                speechRecognition.current.onerror = (event) => {\n                    console.error('Speech recognition error', event.error);\n                    setIsListening(false);\n                };\n            }\n        }\n        return () => {\n            // Clean up speech recognition\n            if (speechRecognition.current) {\n                speechRecognition.current.abort();\n            }\n        };\n    }, []);\n    // Toggle input helpers\n    const toggleImageUploader = () => {\n        setShowImageUploader(!showImageUploader);\n        if (showURLInput)\n            setShowURLInput(false);\n    };\n    const toggleURLInput = () => {\n        setShowURLInput(!showURLInput);\n        if (showImageUploader)\n            setShowImageUploader(false);\n    };\n    // Handle voice input\n    const handleVoiceInput = () => {\n        if (!speechRecognition.current) {\n            alert('Speech recognition is not supported in your browser.');\n            return;\n        }\n        if (isListening) {\n            // Stop listening\n            speechRecognition.current.stop();\n            setIsListening(false);\n        }\n        else {\n            // Start listening\n            try {\n                speechRecognition.current.start();\n                setIsListening(true);\n            }\n            catch (error) {\n                console.error('Speech recognition error:', error);\n            }\n        }\n        // Also call the provided callback if available\n        if (onVoiceInput) {\n            onVoiceInput();\n        }\n    };\n    // Auto-focus the input when component mounts\n    useEffect(() => {\n        if (inputRef.current && !showImageUploader && !showURLInput) {\n            inputRef.current.focus();\n        }\n    }, [showImageUploader, showURLInput]);\n    // Auto-resize textarea based on content\n    useEffect(() => {\n        if (inputRef.current) {\n            inputRef.current.style.height = 'auto';\n            inputRef.current.style.height = `${Math.min(inputRef.current.scrollHeight, 120)}px`;\n        }\n    }, [message]);\n    const handleChange = (e) => {\n        setMessage(e.target.value);\n    };\n    const handleKeyDown = (e) => {\n        // Send message on Enter key (without Shift)\n        if (e.key === 'Enter' && !e.shiftKey) {\n            e.preventDefault();\n            handleSendMessage();\n        }\n    };\n    const handleSendMessage = () => {\n        const trimmedMessage = message.trim();\n        if (trimmedMessage && !disabled && !isLoading) {\n            onSendMessage(trimmedMessage);\n            setMessage('');\n            // Reset textarea height\n            if (inputRef.current) {\n                inputRef.current.style.height = 'auto';\n            }\n        }\n    };\n    // Handle image upload\n    const handleImageUpload = (file) => {\n        if (onImageUpload) {\n            onImageUpload(file);\n            setShowImageUploader(false);\n        }\n    };\n    // Handle URL submission\n    const handleURLSubmit = (url) => {\n        if (onURLSubmit) {\n            onURLSubmit(url);\n            setShowURLInput(false);\n        }\n    };\n    // Style objects for theming\n    const sendButtonStyle = {\n        backgroundColor: primaryColor || undefined\n    };\n    const activeButtonStyle = {\n        color: primaryColor || undefined,\n        borderColor: primaryColor || undefined\n    };\n    return (_jsxs(\"div\", Object.assign({ className: \"stylist-chat-input-container\" }, { children: [showImageUploader && (_jsx(ChatImageUploader, { onImageUpload: handleImageUpload, disabled: disabled || isLoading, primaryColor: primaryColor })), showURLInput && (_jsx(ChatURLInput, { onURLSubmit: handleURLSubmit, disabled: disabled || isLoading, primaryColor: primaryColor })), _jsxs(\"div\", Object.assign({ className: \"stylist-chat-input-toolbar\" }, { children: [_jsx(\"button\", Object.assign({ className: `stylist-chat-input-toolbar__button ${showImageUploader ? 'active' : ''}`, onClick: toggleImageUploader, disabled: disabled || isLoading, style: showImageUploader ? activeButtonStyle : undefined, \"aria-label\": \"Upload image\", title: \"Upload an image to find similar items\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"20\", height: \"20\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2h-3zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-8h-5zM5 19l3-4 2 3 3-4 4 5H5z\" }) })) })), _jsx(\"button\", Object.assign({ className: `stylist-chat-input-toolbar__button ${showURLInput ? 'active' : ''}`, onClick: toggleURLInput, disabled: disabled || isLoading, style: showURLInput ? activeButtonStyle : undefined, \"aria-label\": \"Enter URL\", title: \"Enter a product URL to analyze\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"20\", height: \"20\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\" }) })) })), 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window ? (_jsx(\"button\", Object.assign({ className: `stylist-chat-input-toolbar__button ${isListening ? 'recording' : ''}`, onClick: handleVoiceInput, disabled: disabled || isLoading, \"aria-label\": isListening ? 'Stop recording' : 'Voice input', title: \"Use voice to input text\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"20\", height: \"20\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V20c0 .55.45 1 1 1s1-.45 1-1v-2.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z\" }) })) }))) : null, _jsx(\"div\", Object.assign({ className: \"stylist-chat-input__help\" }, { children: \"Type a message or use the tools above for more input options\" }))] })), _jsxs(\"div\", Object.assign({ className: \"stylist-chat-input\" }, { children: [_jsx(\"div\", Object.assign({ className: \"stylist-chat-input__container\" }, { children: _jsx(\"textarea\", { ref: inputRef, className: \"stylist-chat-input__textarea\", placeholder: placeholder, value: message, onChange: handleChange, onKeyDown: handleKeyDown, disabled: disabled || isLoading, rows: 1, \"aria-label\": \"Message input\" }) })), _jsx(\"button\", Object.assign({ className: \"stylist-chat-input__send-button\", onClick: handleSendMessage, disabled: !message.trim() || disabled || isLoading, style: sendButtonStyle, \"aria-label\": \"Send message\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"20\", height: \"20\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\" }) })) }))] }))] })));\n};\nexport default ChatInput;\n","import ChatInput from './ChatInput';\nexport default ChatInput;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\n// src/components/ChatWidget/ChatWidget.tsx (enhanced implementation)\nimport React, { useEffect, useState, useCallback, lazy, useRef } from 'react';\nimport './ChatWidget.scss';\nimport ChatHeader from '@/components/ChatHeader';\nimport ChatBody from '@/components/ChatBody';\nimport ChatInput from '@/components/ChatInput';\nimport HomeButton from '@/components/HomeButton';\nimport TabNavigation from '@/components/TabNavigation';\nimport { useChatStore, useUserStore, useRecommendationStore } from '@/store/index';\nimport { useFeedbackStore } from '@/store/feedbackStore';\nimport { MessageSender, MessageType } from '@/types/index';\nimport { createStylistApi } from '@/api/index';\nimport { ChatService } from '@/services/chatService';\nimport { AnalyticsEventType, trackEvent } from '@/utils/analytics';\nimport { getUserId } from '@/utils/localStorage';\nimport AsyncComponentLoader from '@/components/common/AsyncComponentLoader';\nimport ErrorBoundary from '@/components/common/ErrorBoundary';\nimport TransitionSmoother from '@/components/common/TransitionSmoother';\nimport { USE_LAZY_LOADING, USE_PARALLEL_INIT } from '@/index';\n// Initialize widget lifecycle log\nconsole.log('[LIFECYCLE:ChatWidget] Module load started');\n// Import non-lazy versions for fallback\nimport TryOnModalRegular from '@/components/TryOnModal';\nimport StyleQuizModalRegular from '@/components/StyleQuiz/StyleQuizModal';\nimport LookbookRegular from '@/components/Lookbook';\nimport MyClosetRegular from '@/components/MyCloset';\nimport VirtualTryOnRegular from '@/components/VirtualTryOn';\nimport TrendingItemsRegular from '@/components/TrendingItems';\nimport SocialProofRegular from '@/components/SocialProof/SocialProofRenderer';\n// Create lazy-loaded versions with fallbacks to non-lazy versions\nconst TryOnModalLazy = lazy(() => {\n    console.log('[LIFECYCLE:ChatWidget] TryOnModalLazy import starting');\n    return import('@/components/TryOnModal')\n        .then(module => {\n        console.log('[LIFECYCLE:ChatWidget] TryOnModalLazy successfully loaded');\n        return module;\n    })\n        .catch(error => {\n        console.error('[LIFECYCLE:ChatWidget] Failed to load TryOnModal component:', error);\n        return { default: TryOnModalRegular };\n    });\n});\nconst StyleQuizModalLazy = lazy(() => {\n    console.log('[LIFECYCLE:ChatWidget] StyleQuizModalLazy import starting');\n    return import('@/components/StyleQuiz/StyleQuizModal')\n        .then(module => {\n        console.log('[LIFECYCLE:ChatWidget] StyleQuizModalLazy successfully loaded');\n        return module;\n    })\n        .catch(error => {\n        console.error('[LIFECYCLE:ChatWidget] Failed to load StyleQuizModal component:', error);\n        return { default: StyleQuizModalRegular };\n    });\n});\nconst LookbookLazy = lazy(() => {\n    console.log('[LIFECYCLE:ChatWidget] LookbookLazy import starting');\n    return import('@/components/Lookbook')\n        .then(module => {\n        console.log('[LIFECYCLE:ChatWidget] LookbookLazy successfully loaded');\n        return module;\n    })\n        .catch(error => {\n        console.error('[LIFECYCLE:ChatWidget] Failed to load Lookbook component:', error);\n        return { default: LookbookRegular };\n    });\n});\nconst MyClosetLazy = lazy(() => {\n    console.log('[LIFECYCLE:ChatWidget] MyClosetLazy import starting');\n    return import('@/components/MyCloset')\n        .then(module => {\n        console.log('[LIFECYCLE:ChatWidget] MyClosetLazy successfully loaded');\n        return module;\n    })\n        .catch(error => {\n        console.error('[LIFECYCLE:ChatWidget] Failed to load MyCloset component:', error);\n        return { default: MyClosetRegular };\n    });\n});\nconst VirtualTryOnLazy = lazy(() => {\n    console.log('[LIFECYCLE:ChatWidget] VirtualTryOnLazy import starting');\n    return import('@/components/VirtualTryOn')\n        .then(module => {\n        console.log('[LIFECYCLE:ChatWidget] VirtualTryOnLazy successfully loaded');\n        return module;\n    })\n        .catch(error => {\n        console.error('[LIFECYCLE:ChatWidget] Failed to load VirtualTryOn component:', error);\n        return { default: VirtualTryOnRegular };\n    });\n});\nconst TrendingItemsLazy = lazy(() => {\n    console.log('[LIFECYCLE:ChatWidget] TrendingItemsLazy import starting');\n    return import('@/components/TrendingItems')\n        .then(module => {\n        console.log('[LIFECYCLE:ChatWidget] TrendingItemsLazy successfully loaded');\n        return module;\n    })\n        .catch(error => {\n        console.error('[LIFECYCLE:ChatWidget] Failed to load TrendingItems component:', error);\n        return { default: TrendingItemsRegular };\n    });\n});\nconst SocialProofLazy = lazy(() => {\n    console.log('[LIFECYCLE:ChatWidget] SocialProofLazy import starting');\n    return import('@/components/SocialProof/SocialProofRenderer')\n        .then(module => {\n        console.log('[LIFECYCLE:ChatWidget] SocialProofLazy successfully loaded');\n        return module;\n    })\n        .catch(error => {\n        console.error('[LIFECYCLE:ChatWidget] Failed to load SocialProof component:', error);\n        return { default: SocialProofRegular };\n    });\n});\nconst ChatWidget = ({ apiKey, retailerId, apiUrl, position = 'bottom-right', primaryColor = '#4361ee', greeting = \"Hi there! I'm your AI style assistant. How can I help you today?\", onFirstPaint, showDemoToggle = false }) => {\n    // Track initialization status with multiple safeguards\n    const [initialized, setInitialized] = useState(false);\n    const initializationAttemptedRef = useRef(false);\n    const [chatService, setChatService] = useState(null);\n    const [showStyleQuiz, setShowStyleQuiz] = useState(false);\n    // Get state and actions from stores\n    const { messages, isOpen, isMinimized, isLoading, currentView, addTextMessage, addMessage, setLoading, setError, setCurrentView } = useChatStore();\n    // Extended state for tab-based navigation\n    const [activeTab, setActiveTab] = useState('chat');\n    const { user, setUser, addLikedItem, addDislikedItem } = useUserStore();\n    const { recommendedItems, recommendedOutfits, savedOutfits, setRecommendedItems, setRecommendedOutfits, addToWishlist, addToCart, saveOutfit } = useRecommendationStore();\n    // Use our feedback store for user feedback\n    const { addMessageThumbsUp } = useFeedbackStore();\n    // Create API client\n    const api = createStylistApi({\n        apiKey,\n        retailerId,\n        apiUrl\n    });\n    // Initialize user profile with useCallback to avoid dependency issues\n    const initializeUser = useCallback(() => __awaiter(void 0, void 0, void 0, function* () {\n        console.log('[LIFECYCLE:ChatWidget] initializeUser starting');\n        try {\n            // Show loading indicator\n            setLoading(true);\n            // Get user ID from localStorage or create a new one\n            const userId = getUserId();\n            console.log('[LIFECYCLE:ChatWidget] Got user ID:', userId);\n            // Get or create user profile\n            let userProfile;\n            try {\n                console.log('[LIFECYCLE:ChatWidget] Attempting to get existing user profile');\n                // Try to get existing user profile\n                userProfile = yield api.user.getUserProfile(userId);\n                console.log('[LIFECYCLE:ChatWidget] Found existing user profile');\n            }\n            catch (e) {\n                console.log('[LIFECYCLE:ChatWidget] No existing profile found, creating new user');\n                // Create a new user profile if not found\n                userProfile = yield api.user.createUser();\n                console.log('[LIFECYCLE:ChatWidget] New user profile created');\n            }\n            // Store user profile in state\n            console.log('[LIFECYCLE:ChatWidget] Setting user profile in store');\n            setUser(userProfile);\n            // Send greeting message\n            if (greeting) {\n                console.log('[LIFECYCLE:ChatWidget] Sending greeting message');\n                addTextMessage(greeting, 'assistant');\n                // Add follow-up message with options\n                console.log('[LIFECYCLE:ChatWidget] Setting timeout for follow-up message (1200ms)');\n                yield new Promise(resolve => setTimeout(resolve, 1200));\n                console.log('[LIFECYCLE:ChatWidget] Sending follow-up message');\n                addTextMessage(\"I can help you with:\\n Finding clothes that match your style\\n Creating complete outfits\\n Virtual try-ons\\n\\nTo get started, would you like to take our quick style quiz or see some recommended items?\", 'assistant');\n            }\n            // Track widget open event\n            console.log('[LIFECYCLE:ChatWidget] Tracking widget open event');\n            trackEvent(AnalyticsEventType.WIDGET_OPEN, userProfile.userId);\n            // For optimized initialization, we'll defer recommendation fetching until after first paint\n            if (USE_PARALLEL_INIT) {\n                console.log('[LIFECYCLE:ChatWidget] Using parallel init, fetching recommendations immediately');\n                // Original behavior: fetch immediately\n                yield fetchInitialRecommendations(userProfile.userId);\n            }\n            else {\n                console.log('[LIFECYCLE:ChatWidget] Using optimized init, deferring recommendation fetch');\n                // Optimized behavior: record initialization data for later\n                // Use type assertion to ensure TypeScript is happy\n                window.__STYLIST_PENDING_INITIALIZATIONS = Object.assign(Object.assign({}, (window.__STYLIST_PENDING_INITIALIZATIONS || {})), { recommendations: {\n                        userId: userProfile.userId\n                    } });\n            }\n            console.log('[LIFECYCLE:ChatWidget] initializeUser completed successfully');\n        }\n        catch (error) {\n            console.error('[LIFECYCLE:ChatWidget] Error initializing user:', error);\n            setError('Sorry, I had trouble connecting. Please try again later.');\n            addTextMessage('Sorry, I had trouble connecting. Please try again later.', 'system');\n        }\n        finally {\n            setLoading(false);\n            console.log('[LIFECYCLE:ChatWidget] initializeUser finished (loading set to false)');\n        }\n    }), [api, greeting, addTextMessage, setUser, setLoading, setError]);\n    // Separated recommendation fetching into its own function for deferred execution\n    const fetchInitialRecommendations = (userId) => __awaiter(void 0, void 0, void 0, function* () {\n        var _a, _b;\n        console.log('[LIFECYCLE:ChatWidget] fetchInitialRecommendations starting for user:', userId);\n        if (recommendedItems.length > 0) {\n            console.log('[LIFECYCLE:ChatWidget] Skipping recommendation fetch - items already loaded');\n            return; // Skip if we already have items\n        }\n        try {\n            console.log('[LIFECYCLE:ChatWidget] Fetching recommendations from API');\n            const recommendations = yield api.recommendation.getRecommendations({\n                userId,\n                limit: 6\n            });\n            console.log('[LIFECYCLE:ChatWidget] Recommendations received:', ((_a = recommendations.items) === null || _a === void 0 ? void 0 : _a.length) || 0, 'items', ((_b = recommendations.outfits) === null || _b === void 0 ? void 0 : _b.length) || 0, 'outfits');\n            // Convert items to proper format\n            console.log('[LIFECYCLE:ChatWidget] Converting recommendation items to proper format');\n            const convertedItems = recommendations.items.map(item => ({\n                id: item.id,\n                retailerId: 'default',\n                name: item.name,\n                brand: item.brand,\n                category: item.category,\n                price: item.price,\n                salePrice: item.salePrice,\n                colors: [],\n                sizes: [],\n                imageUrls: [item.imageUrls[0] || ''],\n                url: item.url,\n                matchScore: item.matchScore,\n                matchReasons: item.matchReasons,\n                inStock: true\n            }));\n            console.log('[LIFECYCLE:ChatWidget] Setting recommendedItems in store');\n            setRecommendedItems(convertedItems);\n            // Convert outfits if available\n            if (recommendations.outfits && recommendations.outfits.length > 0) {\n                console.log('[LIFECYCLE:ChatWidget] Converting recommendation outfits to proper format');\n                const convertedOutfits = recommendations.outfits.map(outfit => ({\n                    id: outfit.id,\n                    name: outfit.name || '',\n                    occasion: outfit.occasion,\n                    matchScore: outfit.matchScore,\n                    matchReasons: outfit.matchReasons,\n                    items: outfit.items.map(item => ({\n                        id: item.id,\n                        retailerId: 'default',\n                        name: item.name,\n                        brand: item.brand,\n                        category: item.category,\n                        price: item.price,\n                        salePrice: item.salePrice,\n                        colors: [],\n                        sizes: [],\n                        imageUrls: [item.imageUrls[0] || ''],\n                        url: item.url,\n                        matchScore: item.matchScore,\n                        matchReasons: item.matchReasons,\n                        inStock: true\n                    }))\n                }));\n                console.log('[LIFECYCLE:ChatWidget] Setting recommendedOutfits in store');\n                setRecommendedOutfits(convertedOutfits);\n            }\n            console.log('[LIFECYCLE:ChatWidget] fetchInitialRecommendations completed successfully');\n        }\n        catch (error) {\n            console.error('[LIFECYCLE:ChatWidget] Error fetching initial recommendations:', error);\n            // Silently fail - we'll show recommendations when the user asks for them\n        }\n    });\n    // Flag to track if first paint was registered\n    const [hasRegisteredFirstPaint, setHasRegisteredFirstPaint] = useState(false);\n    const firstPaintTimeoutRef = useRef(null);\n    const hasFiredFirstPaintRef = useRef(false);\n    // Initialize user and send greeting, with additional safeguards\n    useEffect(() => {\n        console.log('[LIFECYCLE:ChatWidget] Initialization effect running', {\n            initialized,\n            globallyInitialized: window.__STYLIST_CHAT_INITIALIZED === true,\n            attemptedRef: initializationAttemptedRef.current\n        });\n        // Global/window initialization check\n        const isGloballyInitialized = window.__STYLIST_CHAT_INITIALIZED === true;\n        // Skip if either local or global init has happened\n        if (initialized || isGloballyInitialized || initializationAttemptedRef.current) {\n            console.log('[LIFECYCLE:ChatWidget] Initialization skipped - already initialized');\n            return;\n        }\n        // Mark initialization attempted BEFORE async operation\n        initializationAttemptedRef.current = true;\n        console.log('[LIFECYCLE:ChatWidget] Starting user initialization');\n        // Mark as globally initialized to prevent duplicate initialization\n        window.__STYLIST_CHAT_INITIALIZED = true;\n        // Set a safety timeout to ensure widget doesn't get stuck if initialization hangs\n        console.log('[LIFECYCLE:ChatWidget] Setting initialization safety timeout (10s)');\n        const safetyTimeout = setTimeout(() => {\n            if (!initialized) {\n                console.warn('[LIFECYCLE:ChatWidget] Initialization timed out after 10s, forcing completion');\n                setInitialized(true);\n            }\n        }, 10000); // 10 second safety timeout\n        // Run initialization and update state\n        console.log('[LIFECYCLE:ChatWidget] Calling initializeUser()');\n        initializeUser().then(() => {\n            clearTimeout(safetyTimeout);\n            console.log('[LIFECYCLE:ChatWidget] initializeUser resolved successfully');\n            setInitialized(true);\n            console.log('[LIFECYCLE:ChatWidget] Initialization marked as complete');\n            // After initialization is complete, set up the first paint timer\n            // This ensures first paint event happens after base UI renders\n            if (!USE_PARALLEL_INIT && !hasFiredFirstPaintRef.current) {\n                console.log('[LIFECYCLE:ChatWidget] Setting up first paint timer (100ms)');\n                firstPaintTimeoutRef.current = setTimeout(() => {\n                    if (!hasFiredFirstPaintRef.current) {\n                        console.log('[LIFECYCLE:ChatWidget] First paint timer fired, triggering callback');\n                        // Trigger first paint event\n                        triggerFirstPaint();\n                    }\n                }, 100); // Short timeout to allow render to complete\n            }\n        }).catch(error => {\n            clearTimeout(safetyTimeout);\n            console.error('[LIFECYCLE:ChatWidget] Initialization error:', error);\n            // Still mark as initialized to prevent retry loops\n            setInitialized(true);\n            console.log('[LIFECYCLE:ChatWidget] Initialization marked as complete despite error');\n        });\n        // Clean up timeout if component unmounts\n        return () => {\n            console.log('[LIFECYCLE:ChatWidget] Cleaning up initialization timeouts');\n            clearTimeout(safetyTimeout);\n            if (firstPaintTimeoutRef.current) {\n                clearTimeout(firstPaintTimeoutRef.current);\n            }\n        };\n    }, [initialized, initializeUser]);\n    // Function to trigger first paint event and load background items\n    const triggerFirstPaint = () => {\n        var _a;\n        console.log('[LIFECYCLE:ChatWidget] triggerFirstPaint called', {\n            alreadyFired: hasFiredFirstPaintRef.current\n        });\n        if (hasFiredFirstPaintRef.current) {\n            console.log('[LIFECYCLE:ChatWidget] First paint already triggered, skipping');\n            return;\n        }\n        console.log('[LIFECYCLE:ChatWidget] Marking first paint as fired');\n        hasFiredFirstPaintRef.current = true;\n        setHasRegisteredFirstPaint(true);\n        // Call the callback if available\n        if (typeof onFirstPaint === 'function') {\n            console.log('[LIFECYCLE:ChatWidget] Calling onFirstPaint callback');\n            onFirstPaint();\n        }\n        // If we're in optimized initialization mode, start background tasks\n        if (!USE_PARALLEL_INIT && window.__STYLIST_PENDING_INITIALIZATIONS) {\n            console.log('[LIFECYCLE:ChatWidget] Using optimized init, checking for pending initializations');\n            // Load recommendations in background after short delay\n            if ((_a = window.__STYLIST_PENDING_INITIALIZATIONS) === null || _a === void 0 ? void 0 : _a.recommendations) {\n                const { userId } = window.__STYLIST_PENDING_INITIALIZATIONS.recommendations;\n                console.log('[LIFECYCLE:ChatWidget] Setting timeout for background recommendation fetch (1.5s)');\n                setTimeout(() => {\n                    console.log('[LIFECYCLE:ChatWidget] Background recommendation timeout fired');\n                    fetchInitialRecommendations(userId);\n                }, 1500); // 1.5s delay to ensure UI is responsive\n            }\n            // Add any other background tasks here\n        }\n        else {\n            console.log('[LIFECYCLE:ChatWidget] No pending initializations to process');\n        }\n    };\n    // Check for global flags and handle events for the widget\n    useEffect(() => {\n        console.log('[LIFECYCLE:ChatWidget] Global flags and events effect running');\n        // Function to handle style quiz opening\n        const handleStyleQuizOpen = () => {\n            console.log('[LIFECYCLE:ChatWidget] Opening style quiz via global flag or event');\n            setShowStyleQuiz(true);\n        };\n        // Function to handle virtual try-on opening\n        const handleVirtualTryOnOpen = () => {\n            console.log('[LIFECYCLE:ChatWidget] Virtual try-on opening requested');\n            // Open the try-on modal\n            if (recommendedItems.length > 0) {\n                console.log('[LIFECYCLE:ChatWidget] Recommended items available for try-on:', recommendedItems.length);\n                // Auto-select the first item for try-on\n                const item = recommendedItems[0];\n                try {\n                    // Open try-on modal with the first item\n                    console.log('[LIFECYCLE:ChatWidget] Opening try-on with item:', item.id);\n                    addTextMessage(`Let's see how ${item.name} looks on you!`, 'assistant');\n                }\n                catch (error) {\n                    console.error('[LIFECYCLE:ChatWidget] Error opening virtual try-on:', error);\n                }\n            }\n            else {\n                console.log('[LIFECYCLE:ChatWidget] Cannot open virtual try-on - no recommended items available');\n            }\n        };\n        // Initial check for global flags on component mount\n        console.log('[LIFECYCLE:ChatWidget] Checking for global style quiz flag:', !!window.__StylistShowStyleQuiz);\n        if (window.__StylistShowStyleQuiz) {\n            handleStyleQuizOpen();\n            // Don't reset the flag, it could be needed by other components\n        }\n        console.log('[LIFECYCLE:ChatWidget] Checking for global try-on flag:', !!window.__StylistShowVirtualTryOn);\n        if (window.__StylistShowVirtualTryOn) {\n            handleVirtualTryOnOpen();\n            // Don't reset the flag, it could be needed by other components\n        }\n        // Set up event listeners if the event system is available\n        const hasEvents = !!window.__StylistWidgetEvents;\n        console.log('[LIFECYCLE:ChatWidget] Checking for widget events:', hasEvents);\n        if (hasEvents) {\n            console.log('[LIFECYCLE:ChatWidget] Setting up event listeners');\n            window.__StylistWidgetEvents.on('styleQuiz:open', handleStyleQuizOpen);\n            window.__StylistWidgetEvents.on('virtualTryOn:open', handleVirtualTryOnOpen);\n            // Clean up on unmount\n            return () => {\n                console.log('[LIFECYCLE:ChatWidget] Removing event listeners');\n                window.__StylistWidgetEvents.off('styleQuiz:open', handleStyleQuizOpen);\n                window.__StylistWidgetEvents.off('virtualTryOn:open', handleVirtualTryOnOpen);\n            };\n        }\n    }, [recommendedItems, addTextMessage]);\n    // Initialize chat service when user is loaded\n    useEffect(() => {\n        console.log('[LIFECYCLE:ChatWidget] Chat service initialization effect running', {\n            userExists: !!user,\n            apiExists: !!api\n        });\n        if (user && api) {\n            console.log('[LIFECYCLE:ChatWidget] Creating chat service for user:', user.userId);\n            // Pass userApi as the third parameter for enhanced context awareness\n            setChatService(new ChatService(api.recommendation, user.userId, api.user));\n            console.log('[LIFECYCLE:ChatWidget] Chat service created with enhanced context awareness');\n        }\n    }, [user, api]);\n    // Inject CSS variables for theme colors\n    useEffect(() => {\n        if (primaryColor) {\n            document.documentElement.style.setProperty('--stylist-primary-color', primaryColor);\n            // Generate lighter and darker variants\n            document.documentElement.style.setProperty('--stylist-primary-color-light', lightenColor(primaryColor, 0.2));\n            document.documentElement.style.setProperty('--stylist-primary-color-dark', darkenColor(primaryColor, 0.2));\n        }\n    }, [primaryColor]);\n    // Helper function to lighten a color\n    const lightenColor = (color, amount) => {\n        try {\n            // Remove the # if present\n            color = color.replace('#', '');\n            // Parse the color\n            const r = parseInt(color.substring(0, 2), 16);\n            const g = parseInt(color.substring(2, 4), 16);\n            const b = parseInt(color.substring(4, 6), 16);\n            // Lighten each component\n            const newR = Math.min(255, Math.floor(r + (255 - r) * amount));\n            const newG = Math.min(255, Math.floor(g + (255 - g) * amount));\n            const newB = Math.min(255, Math.floor(b + (255 - b) * amount));\n            // Convert back to hex\n            return `#${newR.toString(16).padStart(2, '0')}${newG.toString(16).padStart(2, '0')}${newB.toString(16).padStart(2, '0')}`;\n        }\n        catch (_a) {\n            return color;\n        }\n    };\n    // Helper function to darken a color\n    const darkenColor = (color, amount) => {\n        try {\n            // Remove the # if present\n            color = color.replace('#', '');\n            // Parse the color\n            const r = parseInt(color.substring(0, 2), 16);\n            const g = parseInt(color.substring(2, 4), 16);\n            const b = parseInt(color.substring(4, 6), 16);\n            // Darken each component\n            const newR = Math.max(0, Math.floor(r * (1 - amount)));\n            const newG = Math.max(0, Math.floor(g * (1 - amount)));\n            const newB = Math.max(0, Math.floor(b * (1 - amount)));\n            // Convert back to hex\n            return `#${newR.toString(16).padStart(2, '0')}${newG.toString(16).padStart(2, '0')}${newB.toString(16).padStart(2, '0')}`;\n        }\n        catch (_a) {\n            return color;\n        }\n    };\n    // Handle sending a message\n    const handleSendMessage = (text) => __awaiter(void 0, void 0, void 0, function* () {\n        // Add user message to chat\n        addTextMessage(text, 'user');\n        if (!user || !chatService)\n            return;\n        // Start loading state\n        setLoading(true);\n        // Handle specific commands\n        const lowerText = text.toLowerCase();\n        // Handle \"show lookbook\" command\n        if (lowerText.includes('lookbook') ||\n            lowerText.includes('show recommendations') ||\n            lowerText.includes('show items')) {\n            yield new Promise(resolve => setTimeout(resolve, 500));\n            addTextMessage('Here\\'s your lookbook with all recommended items and outfits!', 'assistant');\n            setCurrentView('lookbook');\n            setLoading(false);\n            return;\n        }\n        // Handle \"back to chat\" command\n        if (lowerText.includes('back to chat') ||\n            lowerText.includes('return to chat')) {\n            yield new Promise(resolve => setTimeout(resolve, 500));\n            addTextMessage('Switching back to chat view. How else can I help you?', 'assistant');\n            setCurrentView('chat');\n            setLoading(false);\n            return;\n        }\n        // Handle style quiz command\n        if (lowerText.includes('quiz') ||\n            lowerText.includes('style profile') ||\n            lowerText.includes('preferences')) {\n            yield new Promise(resolve => setTimeout(resolve, 500));\n            addTextMessage('Let\\'s find out more about your style preferences! Please answer a few quick questions.', 'assistant');\n            // Track quiz start event\n            if (user) {\n                trackEvent(AnalyticsEventType.STYLE_QUIZ_START, user.userId);\n            }\n            setShowStyleQuiz(true);\n            setLoading(false);\n            return;\n        }\n        try {\n            // Process the message with chat service\n            const responses = yield chatService.processMessage(text);\n            // Add responses to the chat with slight delays for a more natural conversation\n            for (let i = 0; i < responses.length; i++) {\n                // Add a small delay between messages\n                if (i > 0) {\n                    yield new Promise(resolve => setTimeout(resolve, 800));\n                }\n                const response = responses[i];\n                // Add message to chat\n                addMessage(response);\n                // If it's a recommendation, store it\n                if (response.type === 'recommendation') {\n                    // Convert from Chat.RecommendationItem to Recommendation.RecommendationItem\n                    const convertedItems = response.items.map(item => ({\n                        id: item.id,\n                        retailerId: 'default',\n                        name: item.name,\n                        brand: item.brand,\n                        category: item.category,\n                        price: item.price,\n                        salePrice: item.salePrice,\n                        colors: [],\n                        sizes: [],\n                        imageUrls: [item.imageUrl || ''],\n                        url: item.url,\n                        matchScore: item.matchScore,\n                        matchReasons: item.matchReasons,\n                        inStock: true\n                    }));\n                    setRecommendedItems(convertedItems);\n                }\n                // If it's an outfit, store it\n                if (response.type === 'outfit') {\n                    // Convert from Chat.Outfit to Recommendation.Outfit\n                    const convertedOutfit = {\n                        id: response.outfit.id,\n                        name: response.outfit.name,\n                        occasion: response.outfit.occasion,\n                        matchScore: response.outfit.matchScore,\n                        matchReasons: response.outfit.matchReasons,\n                        // Convert all items in the outfit\n                        items: response.outfit.items.map(item => ({\n                            id: item.id,\n                            retailerId: 'default',\n                            name: item.name,\n                            brand: item.brand,\n                            category: item.category,\n                            price: item.price,\n                            salePrice: item.salePrice,\n                            colors: [],\n                            sizes: [],\n                            imageUrls: [item.imageUrl || ''],\n                            url: item.url,\n                            matchScore: item.matchScore,\n                            matchReasons: item.matchReasons,\n                            inStock: true\n                        }))\n                    };\n                    // Check if we already have this outfit\n                    const outfitExists = recommendedOutfits.some(outfit => outfit.id === convertedOutfit.id);\n                    if (!outfitExists) {\n                        setRecommendedOutfits([...recommendedOutfits, convertedOutfit]);\n                    }\n                }\n            }\n        }\n        catch (error) {\n            console.error('Error processing message:', error);\n            setError(error instanceof Error ? error.message : String(error));\n            addTextMessage('Sorry, I encountered an error while processing your request. Please try again.', 'system');\n        }\n        finally {\n            // End loading state\n            setLoading(false);\n        }\n    });\n    // Handle image upload for finding similar items\n    const handleImageUpload = (file) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user || !chatService)\n            return;\n        // Start loading state\n        setLoading(true);\n        try {\n            // Track image upload event\n            trackEvent(AnalyticsEventType.IMAGE_UPLOAD, user.userId);\n            // Process the image with chat service\n            const responses = yield chatService.processImageUpload(file);\n            // Add responses to the chat\n            for (let i = 0; i < responses.length; i++) {\n                // Add a small delay between messages\n                if (i > 0) {\n                    yield new Promise(resolve => setTimeout(resolve, 800));\n                }\n                const response = responses[i];\n                // Add message to chat\n                addMessage(response);\n                // If it's a recommendation, store it\n                if (response.type === 'recommendation') {\n                    // Convert and store recommendations\n                    const convertedItems = response.items.map(item => ({\n                        id: item.id,\n                        retailerId: 'default',\n                        name: item.name,\n                        brand: item.brand,\n                        category: item.category,\n                        price: item.price,\n                        salePrice: item.salePrice,\n                        colors: [],\n                        sizes: [],\n                        imageUrls: [item.imageUrl || ''],\n                        url: item.url,\n                        matchScore: item.matchScore,\n                        matchReasons: item.matchReasons,\n                        inStock: true\n                    }));\n                    setRecommendedItems(convertedItems);\n                }\n            }\n        }\n        catch (error) {\n            console.error('Error processing image:', error);\n            setError(error instanceof Error ? error.message : String(error));\n            addTextMessage('Sorry, I encountered an error while processing your image. Please try again.', 'system');\n        }\n        finally {\n            // End loading state\n            setLoading(false);\n        }\n    });\n    // Handle URL input for specific product lookup\n    const handleURLSubmit = (url) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user || !chatService)\n            return;\n        // Start loading state\n        setLoading(true);\n        try {\n            // Track URL input event\n            trackEvent(AnalyticsEventType.URL_INPUT, user.userId, { url });\n            // Process the URL with chat service\n            const responses = yield chatService.processURLInput(url);\n            // Add responses to the chat\n            for (let i = 0; i < responses.length; i++) {\n                // Add a small delay between messages\n                if (i > 0) {\n                    yield new Promise(resolve => setTimeout(resolve, 800));\n                }\n                const response = responses[i];\n                // Add message to chat\n                addMessage(response);\n                // If it's a recommendation, store it\n                if (response.type === 'recommendation') {\n                    // Convert and store recommendations\n                    const convertedItems = response.items.map(item => ({\n                        id: item.id,\n                        retailerId: 'default',\n                        name: item.name,\n                        brand: item.brand,\n                        category: item.category,\n                        price: item.price,\n                        salePrice: item.salePrice,\n                        colors: [],\n                        sizes: [],\n                        imageUrls: [item.imageUrl || ''],\n                        url: item.url,\n                        matchScore: item.matchScore,\n                        matchReasons: item.matchReasons,\n                        inStock: true\n                    }));\n                    setRecommendedItems(convertedItems);\n                }\n            }\n        }\n        catch (error) {\n            console.error('Error processing URL:', error);\n            setError(error instanceof Error ? error.message : String(error));\n            addTextMessage('Sorry, I encountered an error while processing your URL. Please try again.', 'system');\n        }\n        finally {\n            // End loading state\n            setLoading(false);\n        }\n    });\n    // Handle voice input (currently just tracks event)\n    const handleVoiceInput = () => {\n        if (user) {\n            trackEvent(AnalyticsEventType.VOICE_INPUT, user.userId);\n            // Voice input is handled by the ChatInput component itself,\n            // this function is just for tracking and potential future enhancement\n        }\n    };\n    // Handle item feedback\n    const handleItemFeedback = (itemId, liked) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user)\n            return;\n        try {\n            if (liked) {\n                addLikedItem(itemId);\n                trackEvent(AnalyticsEventType.ITEM_LIKE, user.userId, { itemId });\n            }\n            else {\n                addDislikedItem(itemId);\n                trackEvent(AnalyticsEventType.ITEM_DISLIKE, user.userId, { itemId });\n            }\n            // Submit feedback to API\n            yield api.recommendation.addItemFeedback({\n                userId: user.userId,\n                itemId,\n                liked,\n                timestamp: new Date()\n            });\n            // Add feedback confirmation message if in chat view\n            if (currentView === 'chat' && liked) {\n                addTextMessage('Great! I\\'ve noted that you like this item. I\\'ll keep this in mind for future recommendations.', MessageSender.ASSISTANT);\n            }\n        }\n        catch (error) {\n            console.error('Error submitting item feedback:', error);\n            setError('Failed to save your feedback. Please try again.');\n        }\n    });\n    // Handle outfit feedback\n    const handleOutfitFeedback = (outfitId, liked) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user)\n            return;\n        try {\n            trackEvent(liked ? AnalyticsEventType.OUTFIT_LIKE : AnalyticsEventType.OUTFIT_DISLIKE, user.userId, { outfitId });\n            // Submit feedback to API\n            yield api.recommendation.addOutfitFeedback({\n                userId: user.userId,\n                outfitId,\n                liked,\n                timestamp: new Date()\n            });\n            // Provide feedback confirmation if in chat view\n            if (currentView === 'chat' && liked) {\n                addTextMessage('Great! I\\'m glad you like this outfit. I\\'ll remember your preference for future recommendations.', 'assistant');\n            }\n        }\n        catch (error) {\n            console.error('Error submitting outfit feedback:', error);\n            setError('Failed to save your feedback. Please try again.');\n        }\n    });\n    // Handle assistant message feedback (thumbs up)\n    const handleMessageFeedback = (messageId, helpful) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user || !helpful)\n            return; // We only handle \"helpful\" feedback for now\n        try {\n            // Add to feedback store\n            addMessageThumbsUp(messageId);\n            // Track the event\n            trackEvent(AnalyticsEventType.MESSAGE_THUMBS_UP, user.userId, { messageId });\n            // You could also send this feedback to the backend if needed\n            // await api.recommendation.addMessageFeedback({\n            //   userId: user.userId,\n            //   messageId,\n            //   helpful,\n            //   timestamp: new Date()\n            // });\n            // No response needed as the thumbs up component will show its own feedback\n        }\n        catch (error) {\n            console.error('Error saving message feedback:', error);\n            // Silently fail - local storage will still have the feedback\n        }\n    });\n    // Handle adding item to wishlist\n    const handleAddToWishlist = (item) => {\n        if (!user)\n            return;\n        try {\n            addToWishlist({\n                itemId: item.id,\n                retailerId,\n                addedAt: new Date()\n            });\n            if (currentView === 'chat') {\n                addTextMessage(`I've added ${item.name} to your wishlist!`, 'assistant');\n            }\n            trackEvent(AnalyticsEventType.ADD_TO_WISHLIST, user.userId, { itemId: item.id });\n        }\n        catch (error) {\n            console.error('Error adding to wishlist:', error);\n            setError('Failed to add item to wishlist. Please try again.');\n        }\n    };\n    // Handle adding item to cart\n    const handleAddToCart = (item, quantity = 1, size, color) => {\n        if (!user)\n            return;\n        try {\n            // Add to cart in state\n            addToCart({\n                itemId: item.id,\n                retailerId,\n                quantity,\n                size,\n                color,\n                addedAt: new Date()\n            });\n            // Track purchase for bot-driven sales analytics\n            import('@/services/purchaseTrackingService').then(({ purchaseTrackingService }) => {\n                purchaseTrackingService.trackPurchase({\n                    productId: item.id,\n                    source: 'StylistBot',\n                    timestamp: new Date(),\n                    userId: user.userId,\n                    retailerId\n                });\n            });\n            if (currentView === 'chat') {\n                addTextMessage(`I've added ${item.name} to your shopping cart!`, 'assistant');\n            }\n            trackEvent(AnalyticsEventType.ADD_TO_CART, user.userId, {\n                itemId: item.id,\n                quantity,\n                size,\n                color\n            });\n        }\n        catch (error) {\n            console.error('Error adding to cart:', error);\n            setError('Failed to add item to cart. Please try again.');\n        }\n    };\n    // Handle saving an outfit\n    const handleSaveOutfit = (outfit) => {\n        if (!user)\n            return;\n        try {\n            saveOutfit({\n                outfitId: outfit.id,\n                userId: user.userId,\n                name: outfit.name || `Outfit for ${outfit.occasion}`,\n                items: outfit.items.map(item => item.id),\n                savedAt: new Date(),\n            });\n            if (currentView === 'chat') {\n                addTextMessage(`I've saved this outfit to your lookbook!`, 'assistant');\n            }\n            trackEvent(AnalyticsEventType.OUTFIT_SAVE, user.userId, { outfitId: outfit.id });\n        }\n        catch (error) {\n            console.error('Error saving outfit:', error);\n            setError('Failed to save outfit. Please try again.');\n        }\n    };\n    // Handle style quiz submission\n    const handleQuizSubmit = (answers) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user)\n            return;\n        try {\n            setLoading(true);\n            // Check if all questions have been answered\n            const TOTAL_QUESTIONS = 25; // We have 25 questions in our quiz\n            if (answers.length < TOTAL_QUESTIONS) {\n                // There are unanswered questions\n                const answeredQuestionIds = answers.map(a => a.questionId);\n                const unansweredQuestions = Array.from({ length: TOTAL_QUESTIONS }, (_, i) => `q${i + 1}`)\n                    .filter(qId => !answeredQuestionIds.includes(qId));\n                // Show warning but allow submission\n                console.warn(`Some questions are unanswered: ${unansweredQuestions.join(', ')}`);\n                // We'll proceed anyway, but log the warning\n                trackEvent(AnalyticsEventType.STYLE_QUIZ_PARTIAL, user.userId, {\n                    unansweredCount: unansweredQuestions.length\n                });\n            }\n            // Clear any saved progress from local storage\n            try {\n                localStorage.removeItem('stylist_quiz_progress_style-quiz-1');\n            }\n            catch (e) {\n                console.error('Error clearing quiz progress:', e);\n            }\n            // Submit quiz answers to API\n            try {\n                yield api.user.submitStyleQuiz(user.userId, answers);\n            }\n            catch (error) {\n                console.error('Error submitting style quiz:', error);\n                // Show error but don't return yet - we have fallback behavior\n                setError('There was an issue saving your style preferences, but we can still provide recommendations.');\n            }\n            // Close quiz modal\n            setShowStyleQuiz(false);\n            // Add confirmation message\n            addTextMessage('Thanks for completing the style quiz! I now have a better understanding of your preferences. Let me show you some recommendations based on your style profile.', 'assistant');\n            // Get recommendations based on updated profile\n            let recommendations;\n            try {\n                recommendations = yield api.recommendation.getRecommendations({\n                    userId: user.userId,\n                    limit: 4,\n                    includeOutfits: true\n                });\n            }\n            catch (error) {\n                console.error('Error fetching recommendations:', error);\n                setError('Sorry, there was an issue getting your personalized recommendations.');\n                setLoading(false);\n                return;\n            }\n            // Add recommendation message\n            yield new Promise(resolve => setTimeout(resolve, 1000));\n            // Cast to appropriate message type to fix type error\n            addMessage({\n                type: MessageType.RECOMMENDATION,\n                sender: MessageSender.ASSISTANT,\n                items: recommendations.items\n            });\n            // Convert items from Chat to Recommendation format\n            // Using type assertion to avoid type errors during build\n            const convertedItems = recommendations.items.map(item => ({\n                id: item.id,\n                retailerId: 'default',\n                name: item.name,\n                brand: item.brand,\n                category: item.category,\n                price: item.price,\n                salePrice: item.salePrice,\n                colors: [],\n                sizes: [],\n                imageUrls: [item.imageUrl || ''],\n                url: item.url,\n                matchScore: item.matchScore,\n                matchReasons: item.matchReasons,\n                inStock: true\n            }));\n            // Store recommendations\n            setRecommendedItems(convertedItems);\n            // Add outfit if available\n            if (recommendations.outfits && recommendations.outfits.length > 0) {\n                yield new Promise(resolve => setTimeout(resolve, 1000));\n                addTextMessage('I\\'ve also created a complete outfit based on your style:', 'assistant');\n                yield new Promise(resolve => setTimeout(resolve, 500));\n                // Cast to appropriate message type to fix type error\n                addMessage({\n                    type: MessageType.OUTFIT,\n                    sender: MessageSender.ASSISTANT,\n                    outfit: recommendations.outfits[0]\n                });\n                // Convert outfit from Chat to Recommendation format\n                // Using type assertion to avoid type errors during build\n                const convertedOutfits = recommendations.outfits.map(outfit => ({\n                    id: outfit.id,\n                    name: outfit.name,\n                    occasion: outfit.occasion,\n                    matchScore: outfit.matchScore,\n                    matchReasons: outfit.matchReasons,\n                    // Convert all items in the outfit\n                    // Type is already asserted in the parent map function\n                    items: outfit.items.map(item => ({\n                        id: item.id,\n                        retailerId: 'default',\n                        name: item.name,\n                        brand: item.brand,\n                        category: item.category,\n                        price: item.price,\n                        salePrice: item.salePrice,\n                        colors: [],\n                        sizes: [],\n                        imageUrls: [item.imageUrl || ''],\n                        url: item.url,\n                        matchScore: item.matchScore,\n                        matchReasons: item.matchReasons,\n                        inStock: true\n                    }))\n                }));\n                // Store outfits\n                setRecommendedOutfits(convertedOutfits);\n            }\n            // Track quiz completion\n            trackEvent(AnalyticsEventType.STYLE_QUIZ_COMPLETE, user.userId);\n            // Suggest viewing the lookbook\n            yield new Promise(resolve => setTimeout(resolve, 1000));\n            addTextMessage('You can see all your recommendations in your lookbook. Would you like to view it now?', 'assistant');\n        }\n        catch (error) {\n            console.error('Unexpected error processing quiz:', error);\n            setError('Failed to process the style quiz. Please try again later.');\n            // Close quiz modal\n            setShowStyleQuiz(false);\n        }\n        finally {\n            setLoading(false);\n        }\n    });\n    // Handle try-on result save\n    const handleTryOnSave = (resultUrl) => {\n        if (!user)\n            return;\n        // Track event\n        trackEvent(AnalyticsEventType.TRY_ON_SAVED, user.userId, { resultUrl });\n        // Add a message with the try-on result\n        addTextMessage('Great! I\\'ve saved your virtual try-on. How does it look?', 'assistant');\n    };\n    // Handle switching views (legacy function, used for compatibility)\n    const handleSwitchView = (view) => {\n        // Use the store's setCurrentView instead of local state\n        setCurrentView(view);\n        // Update the active tab to match the view\n        setActiveTab(view);\n        if (view === 'lookbook') {\n            trackEvent(AnalyticsEventType.VIEW_LOOKBOOK, (user === null || user === void 0 ? void 0 : user.userId) || 'anonymous');\n        }\n    };\n    // Handle tab change in the new navigation system\n    const handleTabChange = (tabId) => {\n        setActiveTab(tabId);\n        // For backward compatibility - update currentView for chat and lookbook\n        if (tabId === 'chat' || tabId === 'lookbook') {\n            setCurrentView(tabId);\n        }\n        // Track analytics for tab changes\n        const analyticsMap = {\n            'lookbook': AnalyticsEventType.VIEW_LOOKBOOK,\n            'myCloset': AnalyticsEventType.VIEW_MY_CLOSET,\n            'tryOn': AnalyticsEventType.VIEW_VIRTUAL_TRY_ON,\n            'social': AnalyticsEventType.VIEW_SOCIAL_PROOF,\n            'trending': AnalyticsEventType.VIEW_TRENDING_ITEMS\n        };\n        if (analyticsMap[tabId] && user) {\n            trackEvent(analyticsMap[tabId], user.userId);\n        }\n    };\n    // Widget position classes\n    const positionClasses = {\n        'bottom-right': 'stylist-chat-widget--bottom-right',\n        'bottom-left': 'stylist-chat-widget--bottom-left',\n        'top-right': 'stylist-chat-widget--top-right',\n        'top-left': 'stylist-chat-widget--top-left'\n    };\n    // Get appropriate title for the current tab\n    const getTitleForTab = (tabId) => {\n        const titleMap = {\n            'chat': 'The Stylist',\n            'lookbook': 'Your Lookbook',\n            'myCloset': 'My Wardrobe',\n            'tryOn': 'Virtual Try-On',\n            'social': 'Celebrity Styles',\n            'trending': 'Trending Items'\n        };\n        return titleMap[tabId] || 'The Stylist';\n    };\n    if (!isOpen)\n        return null;\n    const widgetClasses = `stylist-chat-widget ${positionClasses[position]} ${isMinimized ? 'stylist-chat-widget--minimized' : ''}`;\n    // Determine if we should show the non-essential components based on init strategy\n    const shouldRenderNonEssentialComponents = () => {\n        // In parallel init mode (original), always render everything\n        if (USE_PARALLEL_INIT) {\n            return true;\n        }\n        // In optimized mode, only render after first paint is registered\n        return hasRegisteredFirstPaint || hasFiredFirstPaintRef.current;\n    };\n    // Use React.useEffect with an empty dependency array to trigger first paint\n    // This will run after the component has rendered once\n    useEffect(() => {\n        // If no first paint callback has been triggered yet, trigger it now\n        if (!USE_PARALLEL_INIT && !hasFiredFirstPaintRef.current) {\n            // Very short timeout to ensure we trigger after paint\n            setTimeout(triggerFirstPaint, 0);\n        }\n    }, []);\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", Object.assign({ className: widgetClasses, \"data-testid\": \"stylist-chat-widget\" }, { children: [_jsx(ChatHeader, { title: getTitleForTab(activeTab), primaryColor: primaryColor, onSwitchView: handleSwitchView, currentView: currentView, showDemoToggle: showDemoToggle, activeTab: activeTab }), _jsx(TabNavigation, { activeTab: activeTab, onTabChange: handleTabChange, primaryColor: primaryColor, enabledFeatures: {\n                            chat: true,\n                            lookbook: true,\n                            myCloset: true,\n                            tryOn: true,\n                            social: true,\n                            trending: true\n                        } }), _jsx(HomeButton, { onClick: () => handleTabChange('chat'), primaryColor: primaryColor }), _jsxs(\"div\", Object.assign({ className: \"stylist-chat-widget__content\" }, { children: [_jsxs(TransitionSmoother, Object.assign({ show: activeTab === 'chat', type: \"fade\", duration: 300, className: \"stylist-chat-widget__view\" }, { children: [_jsx(ErrorBoundary, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-error-container\" }, { children: [_jsx(\"h3\", { children: \"Chat Body Error\" }), _jsx(\"p\", { children: \"Failed to load chat messages.\" }), _jsx(\"button\", Object.assign({ onClick: () => window.location.reload(), className: \"stylist-error-retry-button\" }, { children: \"Reload\" }))] })) }, { children: _jsx(ChatBody, { messages: messages, onItemFeedback: handleItemFeedback, onOutfitFeedback: handleOutfitFeedback, onMessageFeedback: handleMessageFeedback, onAddToWishlist: handleAddToWishlist, onAddToCart: handleAddToCart, isLoading: isLoading, primaryColor: primaryColor }) })), _jsx(ErrorBoundary, Object.assign({ fallback: _jsx(\"div\", Object.assign({ className: \"stylist-chat-input-error\" }, { children: _jsx(\"p\", { children: \"Failed to load chat input.\" }) })) }, { children: _jsx(ChatInput, { onSendMessage: handleSendMessage, onImageUpload: handleImageUpload, onURLSubmit: handleURLSubmit, onVoiceInput: handleVoiceInput, placeholder: \"Type your question here...\", disabled: isLoading, primaryColor: primaryColor }) }))] })), _jsx(TransitionSmoother, Object.assign({ show: activeTab === 'lookbook', type: \"fade\", duration: 300, className: \"stylist-chat-widget__view\" }, { children: shouldRenderNonEssentialComponents() ? (_jsx(_Fragment, { children: _jsx(React.Suspense, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-loading-container\" }, { children: [_jsx(\"div\", { className: \"stylist-loading-spinner\" }), _jsx(\"p\", { children: \"Loading lookbook...\" })] })) }, { children: _jsx(ErrorBoundary, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-error-container\" }, { children: [_jsx(\"h3\", { children: \"Lookbook Error\" }), _jsx(\"p\", { children: \"Failed to load your lookbook.\" }), _jsx(\"button\", Object.assign({ onClick: () => handleTabChange('chat'), className: \"stylist-error-retry-button\" }, { children: \"Return to Chat\" }))] })) }, { children: USE_LAZY_LOADING ? (_jsx(LookbookLazy, { items: recommendedItems, outfits: recommendedOutfits, savedOutfits: savedOutfits, onItemFeedback: handleItemFeedback, onOutfitFeedback: handleOutfitFeedback, onAddToWishlist: handleAddToWishlist, onAddToCart: handleAddToCart, onSaveOutfit: handleSaveOutfit, primaryColor: primaryColor })) : (_jsx(LookbookRegular, { items: recommendedItems, outfits: recommendedOutfits, savedOutfits: savedOutfits, onItemFeedback: handleItemFeedback, onOutfitFeedback: handleOutfitFeedback, onAddToWishlist: handleAddToWishlist, onAddToCart: handleAddToCart, onSaveOutfit: handleSaveOutfit, primaryColor: primaryColor })) })) })) })) : (_jsx(\"div\", Object.assign({ className: \"stylist-chat-widget__loading\" }, { children: _jsx(\"p\", { children: \"Initializing lookbook...\" }) }))) })), _jsx(TransitionSmoother, Object.assign({ show: activeTab === 'myCloset', type: \"fade\", duration: 300, className: \"stylist-chat-widget__view\" }, { children: shouldRenderNonEssentialComponents() ? (_jsx(_Fragment, { children: _jsx(React.Suspense, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-loading-container\" }, { children: [_jsx(\"div\", { className: \"stylist-loading-spinner\" }), _jsx(\"p\", { children: \"Loading my closet...\" })] })) }, { children: _jsx(ErrorBoundary, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-error-container\" }, { children: [_jsx(\"h3\", { children: \"My Closet Error\" }), _jsx(\"p\", { children: \"Failed to load your closet.\" }), _jsx(\"button\", Object.assign({ onClick: () => handleTabChange('chat'), className: \"stylist-error-retry-button\" }, { children: \"Return to Chat\" }))] })) }, { children: USE_LAZY_LOADING ? (_jsx(MyClosetLazy, { onSelectItem: (item) => {\n                                                    // Handle item selection\n                                                    handleTabChange('chat');\n                                                    addTextMessage(`I'd like to know more about this ${item.category} in my closet.`, 'user');\n                                                } })) : (_jsx(MyClosetRegular, { onSelectItem: (item) => {\n                                                    // Handle item selection\n                                                    handleTabChange('chat');\n                                                    addTextMessage(`I'd like to know more about this ${item.category} in my closet.`, 'user');\n                                                } })) })) })) })) : (_jsx(\"div\", Object.assign({ className: \"stylist-chat-widget__loading\" }, { children: _jsx(\"p\", { children: \"Initializing my closet...\" }) }))) })), _jsx(TransitionSmoother, Object.assign({ show: activeTab === 'tryOn', type: \"fade\", duration: 300, className: \"stylist-chat-widget__view\" }, { children: shouldRenderNonEssentialComponents() ? (_jsx(_Fragment, { children: _jsx(React.Suspense, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-loading-container\" }, { children: [_jsx(\"div\", { className: \"stylist-loading-spinner\" }), _jsx(\"p\", { children: \"Loading virtual try-on...\" })] })) }, { children: _jsx(ErrorBoundary, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-error-container\" }, { children: [_jsx(\"h3\", { children: \"Virtual Try-On Error\" }), _jsx(\"p\", { children: \"Failed to load virtual try-on.\" }), _jsx(\"button\", Object.assign({ onClick: () => handleTabChange('chat'), className: \"stylist-error-retry-button\" }, { children: \"Return to Chat\" }))] })) }, { children: USE_LAZY_LOADING ? (_jsx(VirtualTryOnLazy, { onClose: () => handleTabChange('chat'), onSave: handleTryOnSave, primaryColor: primaryColor })) : (_jsx(VirtualTryOnRegular, { onClose: () => handleTabChange('chat'), onSave: handleTryOnSave, primaryColor: primaryColor })) })) })) })) : (_jsx(\"div\", Object.assign({ className: \"stylist-chat-widget__loading\" }, { children: _jsx(\"p\", { children: \"Initializing virtual try-on...\" }) }))) })), _jsx(TransitionSmoother, Object.assign({ show: activeTab === 'social', type: \"fade\", duration: 300, className: \"stylist-chat-widget__view\" }, { children: shouldRenderNonEssentialComponents() ? (_jsx(_Fragment, { children: _jsx(React.Suspense, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-loading-container\" }, { children: [_jsx(\"div\", { className: \"stylist-loading-spinner\" }), _jsx(\"p\", { children: \"Loading celebrity styles...\" })] })) }, { children: _jsx(ErrorBoundary, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-error-container\" }, { children: [_jsx(\"h3\", { children: \"Celebrity Styles Error\" }), _jsx(\"p\", { children: \"Failed to load celebrity styles.\" }), _jsx(\"button\", Object.assign({ onClick: () => handleTabChange('chat'), className: \"stylist-error-retry-button\" }, { children: \"Return to Chat\" }))] })) }, { children: USE_LAZY_LOADING ? (_jsx(SocialProofLazy, { items: [], onItemFeedback: handleItemFeedback, onAddToWishlist: handleAddToWishlist, onAddToCart: handleAddToCart, primaryColor: primaryColor, isExpanded: true })) : (_jsx(SocialProofRegular, { items: [], onItemFeedback: handleItemFeedback, onAddToWishlist: handleAddToWishlist, onAddToCart: handleAddToCart, primaryColor: primaryColor, isExpanded: true })) })) })) })) : (_jsx(\"div\", Object.assign({ className: \"stylist-chat-widget__loading\" }, { children: _jsx(\"p\", { children: \"Initializing celebrity styles...\" }) }))) })), _jsx(TransitionSmoother, Object.assign({ show: activeTab === 'trending', type: \"fade\", duration: 300, className: \"stylist-chat-widget__view\" }, { children: shouldRenderNonEssentialComponents() ? (_jsx(_Fragment, { children: _jsx(React.Suspense, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-loading-container\" }, { children: [_jsx(\"div\", { className: \"stylist-loading-spinner\" }), _jsx(\"p\", { children: \"Loading trending items...\" })] })) }, { children: _jsx(ErrorBoundary, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-error-container\" }, { children: [_jsx(\"h3\", { children: \"Trending Items Error\" }), _jsx(\"p\", { children: \"Failed to load trending items.\" }), _jsx(\"button\", Object.assign({ onClick: () => handleTabChange('chat'), className: \"stylist-error-retry-button\" }, { children: \"Return to Chat\" }))] })) }, { children: USE_LAZY_LOADING ? (_jsx(TrendingItemsLazy, { apiKey: apiKey, retailerId: retailerId, apiUrl: apiUrl, onItemFeedback: handleItemFeedback, onAddToWishlist: handleAddToWishlist, onAddToCart: handleAddToCart, primaryColor: primaryColor })) : (_jsx(TrendingItemsRegular, { apiKey: apiKey, retailerId: retailerId, apiUrl: apiUrl, onItemFeedback: handleItemFeedback, onAddToWishlist: handleAddToWishlist, onAddToCart: handleAddToCart, primaryColor: primaryColor })) })) })) })) : (_jsx(\"div\", Object.assign({ className: \"stylist-chat-widget__loading\" }, { children: _jsx(\"p\", { children: \"Initializing trending items...\" }) }))) }))] }))] })), console.log('[LIFECYCLE:ChatWidget] Checking if non-essential components should render:', shouldRenderNonEssentialComponents()), shouldRenderNonEssentialComponents() && (_jsxs(_Fragment, { children: [console.log('[LIFECYCLE:ChatWidget] Rendering TryOnModal with AsyncComponentLoader'), _jsx(React.Suspense, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-loading-container\" }, { children: [_jsx(\"div\", { className: \"stylist-loading-spinner\" }), _jsx(\"p\", { children: \"Loading virtual try-on...\" })] })) }, { children: _jsxs(AsyncComponentLoader, Object.assign({ loadingMessage: \"Loading virtual try-on...\", onLoadStart: () => console.log('[LIFECYCLE:ChatWidget] TryOnModal loader starting'), onLoadComplete: () => console.log('[LIFECYCLE:ChatWidget] TryOnModal loader completed'), onLoadError: (error) => console.error('[LIFECYCLE:ChatWidget] TryOnModal loading error:', error) }, { children: [(() => {\n                                    console.log('[LIFECYCLE:ChatWidget] Before TryOnModal render');\n                                    return null;\n                                })(), USE_LAZY_LOADING ? (_jsx(TryOnModalLazy, { onSave: handleTryOnSave })) : (_jsx(TryOnModalRegular, { onSave: handleTryOnSave })), (() => {\n                                    console.log('[LIFECYCLE:ChatWidget] After TryOnModal render');\n                                    return null;\n                                })()] })) })), (() => {\n                        console.log('[LIFECYCLE:ChatWidget] Checking if StyleQuizModal should render:', showStyleQuiz);\n                        return null;\n                    })(), showStyleQuiz && (_jsxs(_Fragment, { children: [(() => {\n                                console.log('[LIFECYCLE:ChatWidget] Rendering StyleQuizModal with AsyncComponentLoader');\n                                return null;\n                            })(), _jsx(React.Suspense, Object.assign({ fallback: _jsxs(\"div\", Object.assign({ className: \"stylist-loading-container\" }, { children: [_jsx(\"div\", { className: \"stylist-loading-spinner\" }), _jsx(\"p\", { children: \"Loading style quiz...\" })] })) }, { children: _jsxs(AsyncComponentLoader, Object.assign({ loadingMessage: \"Loading style quiz...\", onLoadStart: () => console.log('[LIFECYCLE:ChatWidget] StyleQuizModal loader starting'), onLoadComplete: () => console.log('[LIFECYCLE:ChatWidget] StyleQuizModal loader completed'), onLoadError: (error) => console.error('[LIFECYCLE:ChatWidget] StyleQuizModal loading error:', error) }, { children: [(() => {\n                                            console.log('[LIFECYCLE:ChatWidget] Before StyleQuizModal render');\n                                            return null;\n                                        })(), USE_LAZY_LOADING ? (_jsx(StyleQuizModalLazy, { onSubmit: handleQuizSubmit, onClose: () => setShowStyleQuiz(false), primaryColor: primaryColor })) : (_jsx(StyleQuizModalRegular, { onSubmit: handleQuizSubmit, onClose: () => setShowStyleQuiz(false), primaryColor: primaryColor })), (() => {\n                                            console.log('[LIFECYCLE:ChatWidget] After StyleQuizModal render');\n                                            return null;\n                                        })()] })) }))] }))] }))] }));\n};\nexport default ChatWidget;\n","import ChatWidget from './ChatWidget';\nexport default ChatWidget;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useState, useEffect } from 'react';\nimport './CircularSymbol.scss';\nconst CircularSymbol = ({ onClick, primaryColor, isOpen = false, logoUrl }) => {\n    const [animateState, setAnimateState] = useState('animate-in');\n    // Handle animation states when opening/closing\n    useEffect(() => {\n        if (isOpen) {\n            setAnimateState('animate-out');\n        }\n        else {\n            setAnimateState('animate-in');\n        }\n    }, [isOpen]);\n    // Don't render the button if the chat widget is open\n    if (isOpen)\n        return null;\n    // Custom style for primary color\n    const buttonStyle = primaryColor ? { backgroundColor: primaryColor } : undefined;\n    return (_jsx(\"div\", Object.assign({ className: `stylist-circular-symbol ${animateState}`, onClick: onClick, style: buttonStyle, \"data-testid\": \"stylist-circular-symbol\", \"aria-label\": \"Open fashion stylist\" }, { children: logoUrl ? (_jsx(\"img\", { src: logoUrl, alt: \"Stylist\", className: \"stylist-circular-symbol__logo\" })) : (_jsx(\"div\", Object.assign({ className: \"stylist-circular-symbol__default-icon\" }, { children: _jsx(\"svg\", Object.assign({ xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", width: \"24\", height: \"24\", fill: \"currentColor\" }, { children: _jsx(\"path\", { d: \"M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\" }) })) }))) })));\n};\nexport default CircularSymbol;\n","import CircularSymbol from './CircularSymbol';\nexport default CircularSymbol;\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\n// src/components/DemoGuide/DemoGuide.tsx\nimport { useState } from 'react';\nimport './DemoGuide.scss';\nimport { demoFlows } from '../../utils/demoFlows';\nimport { getDebugMode } from '../../utils/debugMode';\n/**\n * DemoGuide Component\n *\n * Provides an interactive walkthrough of demo scenarios for presenters.\n * Guides the user through each step of the selected demo flow with\n * instructions, expected outcomes, and helpful tips.\n */\nconst DemoGuide = ({ flowId = 'newUser', onClose, position = 'right', showControls = true }) => {\n    // State\n    const [selectedFlow, setSelectedFlow] = useState(demoFlows[flowId]);\n    const [currentStepIndex, setCurrentStepIndex] = useState(0);\n    const [isMinimized, setIsMinimized] = useState(false);\n    const [isVisible, setIsVisible] = useState(true);\n    // Current step\n    const currentStep = selectedFlow.steps[currentStepIndex];\n    // Navigate between steps\n    const goToNextStep = () => {\n        if (currentStepIndex < selectedFlow.steps.length - 1) {\n            setCurrentStepIndex(currentStepIndex + 1);\n        }\n    };\n    const goToPreviousStep = () => {\n        if (currentStepIndex > 0) {\n            setCurrentStepIndex(currentStepIndex - 1);\n        }\n    };\n    // Handle flow selection\n    const handleFlowChange = (e) => {\n        const newFlowId = e.target.value;\n        setSelectedFlow(demoFlows[newFlowId]);\n        setCurrentStepIndex(0);\n    };\n    // Toggle minimized state\n    const toggleMinimize = () => {\n        setIsMinimized(!isMinimized);\n    };\n    // Handle close\n    const handleClose = () => {\n        setIsVisible(false);\n        if (onClose) {\n            onClose();\n        }\n    };\n    // Only show in debug mode or when explicitly enabled\n    if (!getDebugMode() && !showControls) {\n        return null;\n    }\n    // Don't render if not visible\n    if (!isVisible) {\n        return null;\n    }\n    return (_jsxs(\"div\", Object.assign({ className: `stylist-demo-guide stylist-demo-guide--${position} ${isMinimized ? 'stylist-demo-guide--minimized' : ''}` }, { children: [_jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__header\" }, { children: [_jsx(\"div\", Object.assign({ className: \"stylist-demo-guide__header-title\" }, { children: isMinimized ? 'Demo Guide' : selectedFlow.name })), _jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__header-controls\" }, { children: [_jsx(\"button\", Object.assign({ className: \"stylist-demo-guide__control-btn\", onClick: toggleMinimize, title: isMinimized ? 'Expand' : 'Minimize' }, { children: isMinimized ? (_jsx(\"svg\", Object.assign({ viewBox: \"0 0 24 24\", width: \"18\", height: \"18\" }, { children: _jsx(\"path\", { fill: \"currentColor\", d: \"M19 13h-14v-2h14v2z\" }) }))) : (_jsx(\"svg\", Object.assign({ viewBox: \"0 0 24 24\", width: \"18\", height: \"18\" }, { children: _jsx(\"path\", { fill: \"currentColor\", d: \"M19 13H5v-2h14v2z\" }) }))) })), onClose && (_jsx(\"button\", Object.assign({ className: \"stylist-demo-guide__control-btn\", onClick: handleClose, title: \"Close\" }, { children: _jsx(\"svg\", Object.assign({ viewBox: \"0 0 24 24\", width: \"18\", height: \"18\" }, { children: _jsx(\"path\", { fill: \"currentColor\", d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z\" }) })) })))] }))] })), !isMinimized && (_jsxs(_Fragment, { children: [showControls && (_jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__flow-selector\" }, { children: [_jsx(\"label\", Object.assign({ htmlFor: \"demo-flow-select\" }, { children: \"Demo Flow:\" })), _jsx(\"select\", Object.assign({ id: \"demo-flow-select\", value: flowId, onChange: handleFlowChange }, { children: Object.entries(demoFlows).map(([id, flow]) => (_jsx(\"option\", Object.assign({ value: id }, { children: flow.name }), id))) }))] }))), _jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__content\" }, { children: [_jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__progress\" }, { children: [_jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__progress-text\" }, { children: [\"Step \", currentStepIndex + 1, \" of \", selectedFlow.steps.length] })), _jsx(\"div\", Object.assign({ className: \"stylist-demo-guide__progress-bar\" }, { children: _jsx(\"div\", { className: \"stylist-demo-guide__progress-indicator\", style: { width: `${((currentStepIndex + 1) / selectedFlow.steps.length) * 100}%` } }) }))] })), _jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__step\" }, { children: [_jsx(\"h3\", Object.assign({ className: \"stylist-demo-guide__step-title\" }, { children: currentStep.title })), _jsx(\"p\", Object.assign({ className: \"stylist-demo-guide__step-description\" }, { children: currentStep.description })), _jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__step-action\" }, { children: [_jsx(\"h4\", { children: \"Action:\" }), _jsx(\"p\", { children: currentStep.action })] })), _jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__step-outcome\" }, { children: [_jsx(\"h4\", { children: \"Expected Outcome:\" }), _jsx(\"p\", { children: currentStep.expectedOutcome })] })), currentStep.tips && (_jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__step-tips\" }, { children: [_jsx(\"h4\", { children: \"Tips:\" }), _jsx(\"p\", { children: currentStep.tips })] }))), currentStep.fallbackAction && (_jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__step-fallback\" }, { children: [_jsx(\"h4\", { children: \"If that doesn't work:\" }), _jsx(\"p\", { children: currentStep.fallbackAction })] })))] })), _jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__navigation\" }, { children: [_jsxs(\"button\", Object.assign({ className: \"stylist-demo-guide__nav-btn\", onClick: goToPreviousStep, disabled: currentStepIndex === 0 }, { children: [_jsx(\"svg\", Object.assign({ viewBox: \"0 0 24 24\", width: \"18\", height: \"18\" }, { children: _jsx(\"path\", { fill: \"currentColor\", d: \"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z\" }) })), \"Previous\"] })), _jsxs(\"button\", Object.assign({ className: \"stylist-demo-guide__nav-btn\", onClick: goToNextStep, disabled: currentStepIndex === selectedFlow.steps.length - 1 }, { children: [\"Next\", _jsx(\"svg\", Object.assign({ viewBox: \"0 0 24 24\", width: \"18\", height: \"18\" }, { children: _jsx(\"path\", { fill: \"currentColor\", d: \"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6-6-6z\" }) }))] }))] }))] })), _jsx(\"div\", Object.assign({ className: \"stylist-demo-guide__footer\" }, { children: _jsxs(\"div\", Object.assign({ className: \"stylist-demo-guide__duration\" }, { children: [_jsx(\"svg\", Object.assign({ viewBox: \"0 0 24 24\", width: \"16\", height: \"16\" }, { children: _jsx(\"path\", { fill: \"currentColor\", d: \"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67V7z\" }) })), _jsx(\"span\", { children: selectedFlow.duration })] })) }))] }))] })));\n};\nexport default DemoGuide;\n","import DemoGuide from './DemoGuide';\nexport default DemoGuide;\n"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","UserApi","constructor","apiClient","this","client","getUserProfile","userId","get","createUser","email","post","updatePreferences","preferences","put","getStyleQuiz","submitStyleQuiz","answers","addClosetItem","item","removeClosetItem","itemId","delete","updateClosetItem","updates","toggleFavoriteItem","favorite","SCORE_RANGES","min","max","label","isOpen","onClose","selectedItem","complementaryItems","onAddToCart","onAddAllToCart","primaryColor","selectedItems","setSelectedItems","useState","useEffect","enhancedComplementaryItems","useMemo","map","coordination","baseItem","matchItem","reasons","colorHarmony","item1","item2","colors","length","colors1","c","toLowerCase","colors2","neutralColors","warmColors","coolColors","complementaryPairs","filter","includes","hasNeutral1","some","hasNeutral2","color1","color2","c1","c2","isWarm1","wc","isWarm2","isCool1","cc","isCool2","calculateColorHarmony","push","categoryMatch","category","cat1","cat2","idealPairs","topGroup","bottomGroup","dressGroup","outerGroup","accessoryGroup","footwearGroup","bagGroup","getCategory","cat","category1","category2","calculateCategoryMatch","styleConsistency","_a","_b","_c","_d","styleSignals","casual","formal","athletic","evening","bohemian","minimalist","vintage","detectStyles","itemText","name","description","Object","entries","style","keywords","matches","keyword","score","sort","a","b","styles1","styles2","s1","s2","compatibleStylePairs","primaryStyle1","primaryStyle2","calculateStyleConsistency","overallScore","unshift","calculateStyleCoordination","assign","styleCoordination","className","children","onClick","xmlns","viewBox","width","height","fill","d","color","getCategoryHeading","ItemCard","matchBadgeColor","id","toggleItemSelection","prev","backgroundColor","Math","round","itemsToAdd","categories","selectedCategory","onChange","includeAll","focusStyle","undefined","target","title","logo","currentView","onSwitchView","showDemoToggle","activeTab","toggleMinimize","toggleOpen","isMinimized","src","alt","tab","getIconForTab","WishlistNotification","onClickNotification","messages","onItemFeedback","onOutfitFeedback","onMessageFeedback","onQuizSubmit","isLoading","messagesEndRef","useRef","scrollContainerRef","scrollToBottom","current","scrollIntoView","behavior","ref","message","type","MessageBubble","onFeedback","items","recommendationItem","retailerId","brand","price","salePrice","sizes","imageUrls","imageUrl","url","matchScore","matchReasons","inStock","OutfitDisplay","outfit","StyleQuiz","quizId","onSubmit","error","renderMessage","onImageUpload","disabled","isDragging","setIsDragging","preview","setPreview","fileInputRef","handleFiles","files","file","match","alert","reader","FileReader","onload","readAsDataURL","uploaderStyle","borderColor","buttonStyle","onDragEnter","preventDefault","stopPropagation","onDragLeave","onDragOver","onDrop","dataTransfer","click","accept","onURLSubmit","setUrl","isValid","setIsValid","errorMessage","setErrorMessage","submitButtonStyle","trimmedUrl","trim","URL","validateURL","placeholder","onSendMessage","onVoiceInput","setMessage","showImageUploader","setShowImageUploader","showURLInput","setShowURLInput","isListening","setIsListening","inputRef","speechRecognition","window","SpeechRecognitionAPI","SpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","onresult","event","transcript","Array","from","results","_","i","join","onend","onerror","abort","focus","scrollHeight","handleSendMessage","trimmedMessage","sendButtonStyle","activeButtonStyle","stop","start","onKeyDown","key","shiftKey","rows","TryOnModalLazy","lazy","module","catch","default","TryOnModal","StyleQuizModalLazy","StyleQuizModal","LookbookLazy","Lookbook","MyClosetLazy","MyCloset","VirtualTryOnLazy","VirtualTryOn","TrendingItemsLazy","TrendingItems","SocialProofLazy","apiKey","apiUrl","position","greeting","onFirstPaint","initialized","setInitialized","initializationAttemptedRef","chatService","setChatService","showStyleQuiz","setShowStyleQuiz","addTextMessage","addMessage","setLoading","setError","setCurrentView","setActiveTab","user","setUser","addLikedItem","addDislikedItem","recommendedItems","recommendedOutfits","savedOutfits","setRecommendedItems","setRecommendedOutfits","addToWishlist","addToCart","saveOutfit","addMessageThumbsUp","api","initializeUser","useCallback","userProfile","setTimeout","WIDGET_OPEN","USE_PARALLEL_INIT","fetchInitialRecommendations","__STYLIST_PENDING_INITIALIZATIONS","recommendations","recommendation","getRecommendations","limit","convertedItems","outfits","convertedOutfits","occasion","hasRegisteredFirstPaint","setHasRegisteredFirstPaint","firstPaintTimeoutRef","hasFiredFirstPaintRef","isGloballyInitialized","__STYLIST_CHAT_INITIALIZED","safetyTimeout","clearTimeout","triggerFirstPaint","handleStyleQuizOpen","handleVirtualTryOnOpen","__StylistShowStyleQuiz","__StylistShowVirtualTryOn","__StylistWidgetEvents","on","off","document","documentElement","setProperty","lightenColor","darkenColor","amount","replace","r","parseInt","substring","g","newR","floor","newG","newB","toString","padStart","handleItemFeedback","liked","ITEM_LIKE","ITEM_DISLIKE","addItemFeedback","timestamp","Date","ASSISTANT","handleOutfitFeedback","outfitId","OUTFIT_LIKE","OUTFIT_DISLIKE","addOutfitFeedback","handleAddToWishlist","addedAt","ADD_TO_WISHLIST","handleAddToCart","quantity","size","purchaseTrackingService","trackPurchase","productId","source","ADD_TO_CART","handleSaveOutfit","savedAt","OUTFIT_SAVE","handleQuizSubmit","TOTAL_QUESTIONS","answeredQuestionIds","questionId","unansweredQuestions","qId","STYLE_QUIZ_PARTIAL","unansweredCount","localStorage","removeItem","includeOutfits","RECOMMENDATION","sender","OUTFIT","STYLE_QUIZ_COMPLETE","handleTryOnSave","resultUrl","TRY_ON_SAVED","handleTabChange","tabId","analyticsMap","VIEW_LOOKBOOK","VIEW_MY_CLOSET","VIEW_VIRTUAL_TRY_ON","VIEW_SOCIAL_PROOF","VIEW_TRENDING_ITEMS","widgetClasses","shouldRenderNonEssentialComponents","view","TabNavigation","onTabChange","enabledFeatures","chat","lookbook","myCloset","tryOn","social","trending","HomeButton","TransitionSmoother","show","duration","ErrorBoundary","fallback","location","reload","messageId","helpful","MESSAGE_THUMBS_UP","onAddToWishlist","text","lowerText","STYLE_QUIZ_START","responses","processMessage","response","convertedOutfit","Error","String","IMAGE_UPLOAD","processImageUpload","URL_INPUT","processURLInput","VOICE_INPUT","USE_LAZY_LOADING","onSaveOutfit","onSelectItem","onSave","isExpanded","console","AsyncComponentLoader","A","loadingMessage","onLoadStart","onLoadComplete","onLoadError","logoUrl","animateState","setAnimateState","flowId","showControls","selectedFlow","setSelectedFlow","demoFlows","currentStepIndex","setCurrentStepIndex","setIsMinimized","isVisible","setIsVisible","currentStep","steps","htmlFor","newFlowId","flow","action","expectedOutcome","tips","fallbackAction"],"sourceRoot":""}