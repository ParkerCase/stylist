/*! For license information please see embed.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("embed",[],t):"object"==typeof exports?exports.embed=t():e.embed=t()}(this,(()=>(()=>{"use strict";var e={162:(e,t,n)=>{var s=n(540),r=n(888);var i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=r.useSyncExternalStore,a=s.useRef,u=s.useEffect,c=s.useMemo,d=s.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,s,r){var l=a(null);if(null===l.current){var f={hasValue:!1,value:null};l.current=f}else f=l.current;l=c((function(){function e(e){if(!u){if(u=!0,o=e,e=s(e),void 0!==r&&f.hasValue){var t=f.value;if(r(t,e))return a=t}return a=e}if(t=a,i(o,e))return t;var n=s(e);return void 0!==r&&r(t,n)?(o=e,t):(o=e,a=n)}var o,a,u=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,s,r]);var m=o(e,l[0],l[1]);return u((function(){f.hasValue=!0,f.value=m}),[m]),d(m),m}},242:(e,t,n)=>{e.exports=n(162)},287:(e,t)=>{var n=Symbol.for("react.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,p={};function O(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||g}function S(){}function b(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||g}O.prototype.isReactComponent={},O.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},O.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},S.prototype=O.prototype;var I=b.prototype=new S;I.constructor=b,y(I,O.prototype),I.isPureReactComponent=!0;var v=Array.isArray,h=Object.prototype.hasOwnProperty,k={current:null},w={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,s){var r,i={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)h.call(t,r)&&!w.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(1===u)i.children=s;else if(1<u){for(var c=Array(u),d=0;d<u;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:n,type:e,key:o,ref:a,props:i,_owner:k.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var j=/\/+/g;function R(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,r,i,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var u=!1;if(null===e)u=!0;else switch(a){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case s:u=!0}}if(u)return o=o(u=e),e=""===i?"."+R(u,0):i,v(o)?(r="",null!=e&&(r=e.replace(j,"$&/")+"/"),T(o,t,r,"",(function(e){return e}))):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(j,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",v(e))for(var c=0;c<e.length;c++){var d=i+R(a=e[c],c);u+=T(a,t,r,d,o)}else if(d=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"==typeof d)for(e=d.call(e),c=0;!(a=e.next()).done;)u+=T(a=a.value,t,r,d=i+R(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function U(e,t,n){if(null==e)return e;var s=[],r=0;return T(e,s,"","",(function(e){return t.call(n,e,r++)})),s}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M={current:null},C={transition:null},x={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:C,ReactCurrentOwner:k};function A(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:U,forEach:function(e,t,n){U(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return U(e,(function(){t++})),t},toArray:function(e){return U(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=O,t.Fragment=r,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x,t.act=A,t.cloneElement=function(e,t,s){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=y({},e.props),i=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=k.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)h.call(t,c)&&!w.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=s;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];r.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:l,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=C.transition;C.transition={};try{e()}finally{C.transition=t}},t.unstable_act=A,t.useCallback=function(e,t){return M.current.useCallback(e,t)},t.useContext=function(e){return M.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return M.current.useDeferredValue(e)},t.useEffect=function(e,t){return M.current.useEffect(e,t)},t.useId=function(){return M.current.useId()},t.useImperativeHandle=function(e,t,n){return M.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return M.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return M.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return M.current.useMemo(e,t)},t.useReducer=function(e,t,n){return M.current.useReducer(e,t,n)},t.useRef=function(e){return M.current.useRef(e)},t.useState=function(e){return M.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return M.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return M.current.useTransition()},t.version="18.3.1"},493:(e,t,n)=>{var s=n(540);var r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=s.useState,o=s.useEffect,a=s.useLayoutEffect,u=s.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),s=i({inst:{value:n,getSnapshot:t}}),r=s[0].inst,d=s[1];return a((function(){r.value=n,r.getSnapshot=t,c(r)&&d({inst:r})}),[e,n,t]),o((function(){return c(r)&&d({inst:r}),e((function(){c(r)&&d({inst:r})}))}),[e]),u(n),n};t.useSyncExternalStore=void 0!==s.useSyncExternalStore?s.useSyncExternalStore:d},540:(e,t,n)=>{e.exports=n(287)},888:(e,t,n)=>{e.exports=n(493)}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};n.r(s),n.d(s,{close:()=>V,init:()=>H,minimize:()=>F,open:()=>N,openStyleQuiz:()=>W,openVirtualTryOn:()=>G,switchView:()=>B});const r=e=>{let t;const n=new Set,s=(e,s)=>{const r="function"==typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=s?s:"object"!=typeof r||null===r)?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,i={setState:s,getState:r,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{n.clear()}},o=t=e(s,r,i);return i},i=e=>e?r(e):r;var o=n(540),a=n(242);const{useDebugValue:u}=o,{useSyncExternalStoreWithSelector:c}=a;let d=!1;const l=e=>e;const f=e=>{const t="function"==typeof e?i(e):e,n=(e,n)=>function(e,t=l,n){n&&!d&&(d=!0);const s=c(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return u(s),s}(t,e,n);return Object.assign(n,t),n},m=e=>e?f(e):f;const g={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let y;const p=new Uint8Array(16);const O=[];for(let e=0;e<256;++e)O.push((e+256).toString(16).slice(1));function S(e,t=0){return(O[e[t+0]]+O[e[t+1]]+O[e[t+2]]+O[e[t+3]]+"-"+O[e[t+4]]+O[e[t+5]]+"-"+O[e[t+6]]+O[e[t+7]]+"-"+O[e[t+8]]+O[e[t+9]]+"-"+O[e[t+10]]+O[e[t+11]]+O[e[t+12]]+O[e[t+13]]+O[e[t+14]]+O[e[t+15]]).toLowerCase()}const b=function(e,t,n){if(g.randomUUID&&!t&&!e)return g.randomUUID();const s=(e=e||{}).random??e.rng?.()??function(){if(!y){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");y=crypto.getRandomValues.bind(crypto)}return y(p)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=s[e];return t}return S(s)};var I,v;!function(e){e.TEXT="text",e.RECOMMENDATION="recommendation",e.OUTFIT="outfit",e.QUIZ="quiz",e.LOADING="loading",e.ERROR="error"}(I||(I={})),function(e){e.USER="user",e.ASSISTANT="assistant",e.SYSTEM="system"}(v||(v={}));const h=m(((e,t)=>({messages:[],isOpen:!0,isMinimized:!1,isLoading:!1,error:null,currentView:"chat",addMessage:t=>{const n=b(),s=new Date,r=Object.assign(Object.assign({},t),{id:n,timestamp:s});return e((e=>({messages:[...e.messages,r]}))),n},addTextMessage:(e,n)=>{const s=n,r={type:I.TEXT,sender:s,text:e};return t().addMessage(r)},updateMessage:(t,n)=>{e((e=>({messages:e.messages.map((e=>e.id===t?Object.assign(Object.assign({},e),n):e))})))},removeMessage:t=>{e((e=>({messages:e.messages.filter((e=>e.id!==t))})))},clearMessages:()=>{e({messages:[]})},toggleOpen:()=>{const n=t().isOpen;e({isOpen:!n,isMinimized:!1})},toggleMinimize:()=>{const n=t().isMinimized;e({isMinimized:!n})},setLoading:t=>{e({isLoading:t})},setError:t=>{e({error:t})},setCurrentView:t=>{e({currentView:t})}}))),k=new Map,w=e=>{const t=k.get(e);return t?Object.fromEntries(Object.entries(t.stores).map((([e,t])=>[e,t.getState()]))):{}},_=(e,t={})=>(n,s,r)=>{const{enabled:i,anonymousActionType:o,store:a,...u}=t;let c;try{c=(null==i||i)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(e){}if(!c)return e(n,s,r);const{connection:d,...l}=((e,t,n)=>{if(void 0===e)return{type:"untracked",connection:t.connect(n)};const s=k.get(n.name);if(s)return{type:"tracked",store:e,...s};const r={connection:t.connect(n),stores:{}};return k.set(n.name,r),{type:"tracked",store:e,...r}})(a,c,u);let f=!0;r.setState=(e,t,i)=>{const c=n(e,t);if(!f)return c;const l=void 0===i?{type:o||"anonymous"}:"string"==typeof i?{type:i}:i;return void 0===a?(null==d||d.send(l,s()),c):(null==d||d.send({...l,type:`${a}/${l.type}`},{...w(u.name),[a]:r.getState()}),c)};const m=(...e)=>{const t=f;f=!1,n(...e),f=t},g=e(r.setState,s,r);if("untracked"===l.type?null==d||d.init(g):(l.stores[l.store]=r,null==d||d.init(Object.fromEntries(Object.entries(l.stores).map((([e,t])=>[e,e===l.store?g:t.getState()]))))),r.dispatchFromDevtools&&"function"==typeof r.dispatch){let e=!1;const t=r.dispatch;r.dispatch=(...n)=>{"__setState"!==n[0].type||e||(e=!0),t(...n)}}return d.subscribe((e=>{var t;switch(e.type){case"ACTION":if("string"!=typeof e.payload)return;return E(e.payload,(e=>{if("__setState"!==e.type)r.dispatchFromDevtools&&"function"==typeof r.dispatch&&r.dispatch(e);else{if(void 0===a)return void m(e.state);Object.keys(e.state).length;const t=e.state[a];if(null==t)return;JSON.stringify(r.getState())!==JSON.stringify(t)&&m(t)}}));case"DISPATCH":switch(e.payload.type){case"RESET":return m(g),void 0===a?null==d?void 0:d.init(r.getState()):null==d?void 0:d.init(w(u.name));case"COMMIT":return void 0===a?void(null==d||d.init(r.getState())):null==d?void 0:d.init(w(u.name));case"ROLLBACK":return E(e.state,(e=>{if(void 0===a)return m(e),void(null==d||d.init(r.getState()));m(e[a]),null==d||d.init(w(u.name))}));case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return E(e.state,(e=>{void 0!==a?JSON.stringify(r.getState())!==JSON.stringify(e[a])&&m(e[a]):m(e)}));case"IMPORT_STATE":{const{nextLiftedState:n}=e.payload,s=null==(t=n.computedStates.slice(-1)[0])?void 0:t.state;if(!s)return;return m(void 0===a?s:s[a]),void(null==d||d.send(null,n))}case"PAUSE_RECORDING":return f=!f}return}})),g},E=(e,t)=>{let n;try{n=JSON.parse(e)}catch(e){}void 0!==n&&t(n)};function j(e,t){let n;try{n=e()}catch(e){return}return{getItem:e=>{var s;const r=e=>null===e?null:JSON.parse(e,null==t?void 0:t.reviver),i=null!=(s=n.getItem(e))?s:null;return i instanceof Promise?i.then(r):r(i)},setItem:(e,s)=>n.setItem(e,JSON.stringify(s,null==t?void 0:t.replacer)),removeItem:e=>n.removeItem(e)}}const R=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then:e=>R(e)(n),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>R(t)(e)}}},T=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((e,t)=>(n,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},o=!1;const a=new Set,u=new Set;let c;try{c=i.getStorage()}catch(e){}if(!c)return e(((...e)=>{n(...e)}),s,r);const d=R(i.serialize),l=()=>{const e=i.partialize({...s()});let t;const n=d({state:e,version:i.version}).then((e=>c.setItem(i.name,e))).catch((e=>{t=e}));if(t)throw t;return n},f=r.setState;r.setState=(e,t)=>{f(e,t),l()};const m=e(((...e)=>{n(...e),l()}),s,r);let g;const y=()=>{var e;if(!c)return;o=!1,a.forEach((e=>e(s())));const t=(null==(e=i.onRehydrateStorage)?void 0:e.call(i,s()))||void 0;return R(c.getItem.bind(c))(i.name).then((e=>{if(e)return i.deserialize(e)})).then((e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return e.state;if(i.migrate)return i.migrate(e.state,e.version)}})).then((e=>{var t;return g=i.merge(e,null!=(t=s())?t:m),n(g,!0),l()})).then((()=>{null==t||t(g,void 0),o=!0,u.forEach((e=>e(g)))})).catch((e=>{null==t||t(void 0,e)}))};return r.persist={setOptions:e=>{i={...i,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:e=>(a.add(e),()=>{a.delete(e)}),onFinishHydration:e=>(u.add(e),()=>{u.delete(e)})},y(),g||m})(e,t):((e,t)=>(n,s,r)=>{let i={storage:j((()=>localStorage)),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},o=!1;const a=new Set,u=new Set;let c=i.storage;if(!c)return e(((...e)=>{n(...e)}),s,r);const d=()=>{const e=i.partialize({...s()});return c.setItem(i.name,{state:e,version:i.version})},l=r.setState;r.setState=(e,t)=>{l(e,t),d()};const f=e(((...e)=>{n(...e),d()}),s,r);let m;r.getInitialState=()=>f;const g=()=>{var e,t;if(!c)return;o=!1,a.forEach((e=>{var t;return e(null!=(t=s())?t:f)}));const r=(null==(t=i.onRehydrateStorage)?void 0:t.call(i,null!=(e=s())?e:f))||void 0;return R(c.getItem.bind(c))(i.name).then((e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];if(i.migrate)return[!0,i.migrate(e.state,e.version)]}return[!1,void 0]})).then((e=>{var t;const[r,o]=e;if(m=i.merge(o,null!=(t=s())?t:f),n(m,!0),r)return d()})).then((()=>{null==r||r(m,void 0),m=s(),o=!0,u.forEach((e=>e(m)))})).catch((e=>{null==r||r(void 0,e)}))};return r.persist={setOptions:e=>{i={...i,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>o,onHydrate:e=>(a.add(e),()=>{a.delete(e)}),onFinishHydration:e=>(u.add(e),()=>{u.delete(e)})},i.skipHydration||g(),m||f})(e,t);m()(T(((e,t)=>({user:null,styleQuizResult:null,isLoading:!1,error:null,setUser:t=>{e({user:t})},updateUser:n=>{const s=t().user;s&&e({user:Object.assign(Object.assign({},s),n)})},setStyleQuizResult:t=>{e({styleQuizResult:t})},addToCloset:n=>{const s=t().user;s&&e({user:Object.assign(Object.assign({},s),{closet:[...s.closet,n]})})},removeFromCloset:n=>{const s=t().user;s&&e({user:Object.assign(Object.assign({},s),{closet:s.closet.filter((e=>e.id!==n))})})},toggleItemFavorite:(n,s)=>{const r=t().user;r&&e({user:Object.assign(Object.assign({},r),{closet:r.closet.map((e=>e.id===n?Object.assign(Object.assign({},e),{favorite:s}):e))})})},addLikedItem:n=>{const s=t().user;s&&(s.feedback.likedItems.includes(n)||e({user:Object.assign(Object.assign({},s),{feedback:Object.assign(Object.assign({},s.feedback),{likedItems:[...s.feedback.likedItems,n],dislikedItems:s.feedback.dislikedItems.filter((e=>e!==n)),lastInteraction:new Date})})}))},addDislikedItem:n=>{const s=t().user;s&&(s.feedback.dislikedItems.includes(n)||e({user:Object.assign(Object.assign({},s),{feedback:Object.assign(Object.assign({},s.feedback),{dislikedItems:[...s.feedback.dislikedItems,n],likedItems:s.feedback.likedItems.filter((e=>e!==n)),lastInteraction:new Date})})}))},removeLikedItem:n=>{const s=t().user;s&&e({user:Object.assign(Object.assign({},s),{feedback:Object.assign(Object.assign({},s.feedback),{likedItems:s.feedback.likedItems.filter((e=>e!==n)),lastInteraction:new Date})})})},removeDislikedItem:n=>{const s=t().user;s&&e({user:Object.assign(Object.assign({},s),{feedback:Object.assign(Object.assign({},s.feedback),{dislikedItems:s.feedback.dislikedItems.filter((e=>e!==n)),lastInteraction:new Date})})})},addViewedItem:n=>{const s=t().user;s&&(s.feedback.viewedItems.includes(n)||e({user:Object.assign(Object.assign({},s),{feedback:Object.assign(Object.assign({},s.feedback),{viewedItems:[...s.feedback.viewedItems,n],lastInteraction:new Date})})}))},setLoading:t=>{e({isLoading:t})},setError:t=>{e({error:t})},logout:()=>{e({user:null,styleQuizResult:null})}})),{name:"stylist-user-storage",partialize:e=>({user:e.user,styleQuizResult:e.styleQuizResult})}));var U,D,M,C;!function(e){e.TOP="top",e.BOTTOM="bottom",e.DRESS="dress",e.OUTERWEAR="outerwear",e.SHOES="shoes",e.ACCESSORY="accessory"}(U||(U={})),function(e){e.UPPER_BODY="upper_body",e.LOWER_BODY="lower_body",e.FULL_BODY="full_body",e.HEAD="head",e.FEET="feet",e.HANDS="hands",e.NECK="neck",e.WAIST="waist"}(D||(D={})),function(e){e.IDLE="idle",e.UPLOADING="uploading",e.PROCESSING="processing",e.REMOVING_BACKGROUND="removing_background",e.COMPLETED="completed",e.FAILED="failed"}(M||(M={})),function(e){e.REMOVE_BG_API="remove_bg_api",e.TENSORFLOW="tensorflow",e.MANUAL="manual"}(C||(C={}));const x=e=>{switch(e){case U.TOP:return D.UPPER_BODY;case U.BOTTOM:return D.LOWER_BODY;case U.DRESS:return D.FULL_BODY;case U.OUTERWEAR:return D.UPPER_BODY;case U.SHOES:return D.FEET;case U.ACCESSORY:return D.HEAD;default:return D.FULL_BODY}},A={preferredBackgroundRemovalMethod:C.TENSORFLOW,removeBackgroundAutomatically:!0,showGuidelines:!0,highQualityRendering:!0,defaultGarmentScale:{[U.TOP]:.8,[U.BOTTOM]:.7,[U.DRESS]:.9,[U.OUTERWEAR]:.85,[U.SHOES]:.5,[U.ACCESSORY]:.4},defaultGarmentOffset:{[U.TOP]:{x:0,y:-50},[U.BOTTOM]:{x:0,y:100},[U.DRESS]:{x:0,y:0},[U.OUTERWEAR]:{x:0,y:-30},[U.SHOES]:{x:0,y:200},[U.ACCESSORY]:{x:0,y:-150}}},L=(m()(_(T(((e,t)=>({currentOutfit:null,userImage:null,isLoading:!1,error:null,settings:A,savedResults:[],canvasWidth:600,canvasHeight:800,isTryOnModalOpen:!1,isUploadModalOpen:!1,setCurrentOutfit:t=>{e({currentOutfit:t})},addGarmentToOutfit:n=>{const{currentOutfit:s}=t();if(s){const t=s.garments.filter((e=>!(e.type===n.type&&e.bodyPosition===n.bodyPosition)));e({currentOutfit:Object.assign(Object.assign({},s),{garments:[...t,n]})})}else{const t={id:`outfit_${Date.now()}`,garments:[n],createdAt:new Date};e({currentOutfit:t})}},removeGarmentFromOutfit:n=>{const{currentOutfit:s}=t();if(s){const t=s.garments.filter((e=>e.id!==n));e({currentOutfit:Object.assign(Object.assign({},s),{garments:t})})}},updateGarment:(n,s)=>{const{currentOutfit:r}=t();if(r){const t=r.garments.map((e=>e.id===n?Object.assign(Object.assign({},e),s):e));e({currentOutfit:Object.assign(Object.assign({},r),{garments:t})})}},setUserImage:n=>{e({userImage:n});const{currentOutfit:s}=t();if(s){const t=n;e({currentOutfit:Object.assign(Object.assign({},s),{userImage:t})})}},updateUserImage:n=>{const{userImage:s}=t();if(s){const r=Object.assign(Object.assign({},s),n);e({userImage:r});const{currentOutfit:i}=t();i&&e({currentOutfit:Object.assign(Object.assign({},i),{userImage:r})})}},clearUserImage:()=>{e({userImage:null});const{currentOutfit:n}=t();if(n){const t=Object.assign(Object.assign({},n),{userImage:void 0});e({currentOutfit:t})}},updateOutfit:n=>{const{currentOutfit:s}=t();s&&e({currentOutfit:Object.assign(Object.assign({},s),n)})},setSettings:n=>{e({settings:Object.assign(Object.assign({},t().settings),n)})},setLoading:t=>{e({isLoading:t})},setError:t=>{e({error:t})},saveResult:n=>{const s=[...t().savedResults],r=s.findIndex((e=>e.id===n.id));r>=0?s[r]=n:s.push(n),e({savedResults:s})},deleteSavedResult:n=>{const s=t().savedResults.filter((e=>e.id!==n));e({savedResults:s})},setCanvasDimensions:(t,n)=>{e({canvasWidth:t,canvasHeight:n})},openTryOnModal:()=>{e({isTryOnModalOpen:!0})},closeTryOnModal:()=>{e({isTryOnModalOpen:!1})},openUploadModal:()=>{e({isUploadModalOpen:!0})},closeUploadModal:()=>{e({isUploadModalOpen:!1})},reset:()=>{e({currentOutfit:null,userImage:null,isLoading:!1,error:null})},startNewTryOn:(n,s)=>{const{settings:r}=t(),i=t().currentOutfit||{id:crypto.randomUUID(),garments:[],createdAt:new Date},o={id:crypto.randomUUID(),type:s,url:"string"==typeof n?n:URL.createObjectURL(n),bodyPosition:x(s),zIndex:i.garments.length+1,layerIndex:i.garments.length,scale:r.defaultGarmentScale[s]||1,offset:r.defaultGarmentOffset[s]||{x:0,y:0},rotation:0,withoutBackground:!0},a=[...i.garments||[],o];e({currentOutfit:Object.assign(Object.assign({},i),{garments:a})})},tryOnOutfit:t=>{e({currentOutfit:t})}})),{name:"stylist-try-on-storage",partialize:e=>({settings:e.settings,savedResults:e.savedResults})}),{name:"try-on-store"})),m(((e,t)=>({recommendedItems:[],recommendedOutfits:[],savedOutfits:[],wishlistItems:[],cartItems:[],viewedItems:[],context:null,loading:!1,error:null,setRecommendedItems:t=>{e({recommendedItems:t})},setRecommendedOutfits:t=>{e({recommendedOutfits:t})},setSavedOutfits:t=>{e({savedOutfits:t})},addRecommendedItem:t=>{e((e=>({recommendedItems:[...e.recommendedItems,t]})))},addRecommendedOutfit:t=>{e((e=>({recommendedOutfits:[...e.recommendedOutfits,t]})))},addToWishlist:n=>{t().wishlistItems.some((e=>e.itemId===n.itemId))||e((e=>({wishlistItems:[...e.wishlistItems,n]})))},removeFromWishlist:t=>{e((e=>({wishlistItems:e.wishlistItems.filter((e=>e.itemId!==t))})))},addToCart:n=>{const s=t().cartItems.findIndex((e=>e.itemId===n.itemId));e(s>=0?e=>{const t=[...e.cartItems];return t[s].quantity+=n.quantity,{cartItems:t}}:e=>({cartItems:[...e.cartItems,n]}))},removeFromCart:t=>{e((e=>({cartItems:e.cartItems.filter((e=>e.itemId!==t))})))},updateCartItemQuantity:(t,n)=>{e((e=>({cartItems:e.cartItems.map((e=>e.itemId===t?Object.assign(Object.assign({},e),{quantity:n}):e))})))},addViewedItem:n=>{t().viewedItems.includes(n)||e((e=>({viewedItems:[...e.viewedItems,n]})))},saveOutfit:n=>{t().savedOutfits.some((e=>e.outfitId===n.outfitId))||e((e=>({savedOutfits:[...e.savedOutfits,n]})))},removeSavedOutfit:t=>{e((e=>({savedOutfits:e.savedOutfits.filter((e=>e.outfitId!==t))})))},setContext:t=>{e({context:t})},clearRecommendations:()=>{e({recommendedItems:[],recommendedOutfits:[],context:null})},setLoading:t=>{e({loading:t})},setError:t=>{e({error:t})},getItemsByCategory:e=>t().recommendedItems.filter((t=>t.category===e)),getItemsSortedByMatchScore:()=>[...t().recommendedItems].sort(((e,t)=>t.matchScore-e.matchScore)),getOutfitById:e=>t().recommendedOutfits.find((t=>t.id===e)),getItemById:e=>t().recommendedItems.find((t=>t.id===e)),updateItem:(t,n)=>{e((e=>({recommendedItems:e.recommendedItems.map((e=>e.id===t?Object.assign(Object.assign({},e),n):e))})))}}))),()=>{const e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}),P=()=>{if(!L())return`anonymous_${Date.now()}`;let e=localStorage.getItem("stylist_user_id");return e||(e=`user_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,localStorage.setItem("stylist_user_id",e)),e},$=e=>Array.from(e),z=e=>new Set(e);m()(T(((e,t)=>({likedItems:new Set,dislikedItems:new Set,likedOutfits:new Set,dislikedOutfits:new Set,thumbsUpMessages:new Set,feedbackHistory:[],pendingSync:[],isSyncing:!1,lastSyncedAt:null,addItemFeedback:(t,n)=>{const s=P(),r=new Date,i={id:`item_${n}_${t}_${r.getTime()}`,type:n,timestamp:r,entityType:"item",metadata:{itemId:t,userId:s}};e("like"===n?e=>({likedItems:new Set(e.likedItems).add(t),dislikedItems:new Set(e.dislikedItems).delete(t)?new Set(e.dislikedItems):e.dislikedItems,feedbackHistory:[...e.feedbackHistory,i],pendingSync:[...e.pendingSync,i]}):e=>({dislikedItems:new Set(e.dislikedItems).add(t),likedItems:new Set(e.likedItems).delete(t)?new Set(e.likedItems):e.likedItems,feedbackHistory:[...e.feedbackHistory,i],pendingSync:[...e.pendingSync,i]}))},addOutfitFeedback:(t,n)=>{const s=P(),r=new Date,i={id:`outfit_${n}_${t}_${r.getTime()}`,type:n,timestamp:r,entityType:"outfit",metadata:{outfitId:t,userId:s}};e("like"===n?e=>({likedOutfits:new Set(e.likedOutfits).add(t),dislikedOutfits:new Set(e.dislikedOutfits).delete(t)?new Set(e.dislikedOutfits):e.dislikedOutfits,feedbackHistory:[...e.feedbackHistory,i],pendingSync:[...e.pendingSync,i]}):e=>({dislikedOutfits:new Set(e.dislikedOutfits).add(t),likedOutfits:new Set(e.likedOutfits).delete(t)?new Set(e.likedOutfits):e.likedOutfits,feedbackHistory:[...e.feedbackHistory,i],pendingSync:[...e.pendingSync,i]}))},addMessageThumbsUp:t=>{const n=P(),s=new Date,r={id:`message_thumbsUp_${t}_${s.getTime()}`,type:"thumbsUp",timestamp:s,entityType:"recommendation",metadata:{messageId:t,userId:n}};e((e=>({thumbsUpMessages:new Set(e.thumbsUpMessages).add(t),feedbackHistory:[...e.feedbackHistory,r],pendingSync:[...e.pendingSync,r]})))},removeItemFeedback:t=>{e((e=>({likedItems:new Set(e.likedItems).delete(t)?new Set(e.likedItems):e.likedItems,dislikedItems:new Set(e.dislikedItems).delete(t)?new Set(e.dislikedItems):e.dislikedItems})))},removeOutfitFeedback:t=>{e((e=>({likedOutfits:new Set(e.likedOutfits).delete(t)?new Set(e.likedOutfits):e.likedOutfits,dislikedOutfits:new Set(e.dislikedOutfits).delete(t)?new Set(e.dislikedOutfits):e.dislikedOutfits})))},removeMessageThumbsUp:t=>{e((e=>({thumbsUpMessages:new Set(e.thumbsUpMessages).delete(t)?new Set(e.thumbsUpMessages):e.thumbsUpMessages})))},markAsSynced:t=>{e((e=>({pendingSync:e.pendingSync.filter((e=>!t.includes(e.id))),lastSyncedAt:new Date})))},setIsSyncing:t=>{e({isSyncing:t})},getItemFeedbackStatus:e=>{const n=t();return{liked:n.likedItems.has(e),disliked:n.dislikedItems.has(e)}},getOutfitFeedbackStatus:e=>{const n=t();return{liked:n.likedOutfits.has(e),disliked:n.dislikedOutfits.has(e)}},isMessageThumbedUp:e=>t().thumbsUpMessages.has(e),getPendingSyncItems:()=>t().pendingSync,clearSyncedItems:()=>{e({pendingSync:[],lastSyncedAt:new Date})}})),{name:"stylist-feedback-storage",partialize:e=>({likedItems:$(e.likedItems),dislikedItems:$(e.dislikedItems),likedOutfits:$(e.likedOutfits),dislikedOutfits:$(e.dislikedOutfits),thumbsUpMessages:$(e.thumbsUpMessages),feedbackHistory:e.feedbackHistory,pendingSync:e.pendingSync,lastSyncedAt:e.lastSyncedAt}),onRehydrateStorage:()=>e=>{e&&(e.likedItems=z(e.likedItems),e.dislikedItems=z(e.dislikedItems),e.likedOutfits=z(e.likedOutfits),e.dislikedOutfits=z(e.dislikedOutfits),e.thumbsUpMessages=z(e.thumbsUpMessages))}}));function H(e){window.__StylistWidgetConfig=e;h.getState().setCurrentView("chat")}function N(){h.getState().toggleOpen()}function V(){const{isOpen:e}=h.getState();e&&h.getState().toggleOpen()}function F(){h.getState().toggleMinimize()}function B(e){h.getState().setCurrentView(e)}function W(){window.__StylistShowStyleQuiz=!0,setTimeout((()=>{window.__StylistShowStyleQuiz=!1}),100)}function G(){window.__StylistShowVirtualTryOn=!0,setTimeout((()=>{window.__StylistShowVirtualTryOn=!1}),100)}const Y={init:H,open:N,close:V,minimize:F,switchView:B,openStyleQuiz:W,openVirtualTryOn:G};return"undefined"==typeof window||window.StylistWidget||(window.StylistWidget=Y),s})()));